<?php
/**
 * @wordpress-plugin
 * Plugin Name:       Habit Planner
 * Description:       Add Habit Planner section.
 * Version:           1.0
 * Author:
 * Author URI:
 */


add_action('init', 'create_habit_post_type');
function create_habit_post_type()
{
    /*
    register_post_type('habit_planner',
        array(
            'labels' => array(
                'name' => __('habit_planner'),
                'singular_name' => __('habit_planner')
            ),
            'public' => true,
            'exclude_from_search' => true,
            'show_in_admin_bar' => false,
            'show_in_nav_menus' => false,
            'publicly_queryable' => false,
            'query_var' => false
        )
    );
    */
}

add_action('admin_menu', 'remove_habit_planner_menu_items');
function remove_habit_planner_menu_items()
{
    remove_menu_page('edit.php?post_type=habit_planner');
}

require_once dirname(__FILE__) . '/wp_ajax_habit_planner.php';


add_shortcode('habit-planner', 'habit_planner_function');
function habit_planner_function($args)
{
    ob_start();
    ?>
    <style>
        .habit-preloader-wrapper {
            display: none;
            text-align: center;
            position: fixed;
            width: 100vw;
            height: 100vh;
            z-index: 100099;
            left: 0;
            top: 0;
            background: rgba(255, 255, 255, 0.7);
        }

        .habit-preloader-wrapper.show {
            display: block;
        }

        .habit-preloader {
            transform: translate(-50%, -50%) scale(-1, 1);
            width: 370px;
            height: auto;
            position: absolute;
            left: 50%;
            top: 47%;
        }
    </style>
    <div class="habit-preloader-wrapper">
        <img alt="preloader" class="habit-preloader" src="/wp-content/plugins/habit-planner/assets/img/preloader.gif"/>
    </div>
    <style>
        .site-main {
            padding-top: 25px;
        }

        #site-content{
            padding: 0;
        }

        h1,
        h1.title{
           margin: 0;
        }

        .habit-plugin-wrapper {
            background-color: #fff;
            border-radius: 15px;
            padding-bottom: 20px;
        }

        .habit-plugin-tabs {
            padding: 10px 22px 20px 22px;
            display: flex;
        }

        .habit-plugin-tabs a {
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 20px;
            display: inline-block;
            line-height: 24px;
            text-decoration: none;
            border-bottom: 2px solid transparent;
            color: rgba(0,0,0,0.4);
            outline: none !important;
            box-shadow: none !important;
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        .habit-plugin-tabs a.active {
            font-weight: 700;
            border-bottom: 3px solid #000;
            color: #000;
        }

        .habit-tab-wrapper{
            text-align: left;
            min-width: 20%;
        }

        .habit-tab-wrapper a{
            margin-right: 60px;
        }

        .is-habit-tab {
            display: none;
            padding: 0 12px;
        }

        .is-habit-tab.show {
            display: block;
        }

        @media (max-width: 1023px) {
            .habit-plugin-tabs {
                display: block;
                white-space: nowrap;
                overflow-x: auto;
                overflow-y: hidden;
            }

            .habit-plugin-tabs .habit-tab-wrapper{
                display: inline-block;
                min-width: 20%;
            }
        }





        /*
        ////////////////////////////////
        ///////////////////////////////
         */




        h2{
            text-align: center;
            line-height: 1;
            margin: 0;
            padding: 0 10px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 21px;
            font-weight: 500;
            color: #000;
            display: inline-block;
            position: relative;
        }

        .month-headers{
            margin: 0 0 7px 0;
        }

        .month-headers h6{
            line-height: 1;
            margin: 0;
            padding: 0 10px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 12.5px;
            font-weight: 500;
            text-align: center;
            width: calc(100% / 7);
            float: left;
            color: #000;
        }

        .month-headers:after,
        .month-days:after,
        .bottom-info-wrapper:after,
        .this-month-goals:after,
        .notes-wrapper:after{
            content: '';
            display: block;
            clear: both;
        }

        .month-days {
            display: none;
        }

        .month-days.is-month-current{
            display: block;
        }

        .month-day{
            background: #F9F9F9;
            border-radius: 5px;
            padding-top: 20px;
            width: 116px;
            min-height: 97px;
            padding-bottom: 12px;
            float: left;
            margin-right: 6px;
            margin-bottom: 6px;
            position: relative;
            cursor: pointer;
            transition: 0.4s all;
        }

        .month-day.day-with-focus:before{
            display: block;
            content: '';
            background: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 11px;
            height: 14px;
            right: 28px;
            top: 5px;
            position: absolute;
        }

        .month-day.day-with-perfect:before{
            display: block;
            content: '';
            background: url(/wp-content/plugins/habit-planner/assets/img2/perfect-day.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 11px;
            height: 14px;
            right: 28px;
            top: 5px;
            position: absolute;
            border-radius: 0;
        }

        .month-day.day-with-best:before{
            display: none !important;
        }

        .month-day.day-best-focus:before{
            display: block !important;
            content: '';
            background: url(/wp-content/plugins/habit-planner/assets/img2/focus-weeek.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 22px;
            height: 22px;
            right: auto;
            left: 5px;
            top: 5px;
            position: absolute;
            border-radius: 0;
        }

        .month-day.day-best-all:before{
            display: block !important;
            content: '';
            background: url(/wp-content/plugins/habit-planner/assets/img2/perfect-week.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 22px;
            height: 20px;
            right: auto;
            left: 5px;
            top: 5px;
            position: absolute;
            border-radius: 0;
        }

        .month-day.is-empty-day{
            background: rgba(249, 249, 249, 0.4) !important;
        }

        .month-day p{

        }

        .month-day.selected{
            background: #F5F7FF !important;
            box-shadow: inset 0 0 2px 0.3px #274AFF !important;
        }

        .month-day:nth-of-type(7n + 7){
            margin-right: 0;
            background: #E9E9E9;
        }

        .month-day:nth-of-type(7n + 1){
            clear: both;
        }

        .day-number{
            line-height: 1;
            margin: 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 12px;
            font-weight: 500;
            text-align: right;
            position: absolute;
            right: 9px;
            top: 6px;
            color: #000;
        }

        .day-number.is-today{
            color: #fff;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            text-align: center;
            line-height: 18px;
            background: #274AFF;
            right: 6px;
            top: 2px;
            z-index: 2;
        }

        .month-day.is-previous-day{
            cursor: default;
            background: #F9F9F9 !important;
        }

        .month-day.day-with-best{
            cursor: default;
            background: #F8F6FE !important;
        }

        .month-day.is-previous-day:after{
            content: '';
            display: block;
            position: absolute;
            width: 10px;
            right: -10px;
            height: 100%;
            top: 0;
            background: #F9F9F9;
        }

        .month-day.day-with-best:after{
            background: #F8F6FE !important;
        }

        .month-day.is-yesterday:after,
        .month-day:nth-of-type(7n + 7).is-previous-day:after{
            display: none;
        }

        .month-day:not(.is-previous-day):not(.is-empty-day):hover,
        .month-day:not(.is-previous-day):not(.is-empty-day):focus{
            box-shadow: inset 0 0 1px 0.2px #274aff;
        }

        .month-day input{
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 18px;
            line-height: 16px;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
            width: 90%;
            margin: 0 5% 4px 5%;
            cursor: pointer;
        }

        .month-day .is-hover input,
        .month-day .is-hover input{
            border: 1px solid #97a8ff;
        }

        .month-day .remove-input{
            right: 9px;
            top: 7px;
            display: none;
        }

        .month-day-inner.is-hover .remove-input{
            display: block;
        }

        .is-previous-day .month-day-inner.is-hover .remove-input{
            display: none;
        }

        .planner-calendar-wrapper{
            background: #FFF;
            box-shadow: 2px 1px 7px rgba(0, 0, 0, 0.08);
            border-radius: 10px;
            padding: 12px 10px 3px;
            position: relative;
            margin-bottom: 28px;
            text-align: center;
        }

        .month-actions{
            text-align: right;
            margin-top: -7px;
            margin-bottom: 19px;
        }

        .month-action-text{
            display: inline-block;
            height: 26px;
            width: 145px;
            box-shadow: 1px 1px 2px 1px rgba(0, 0, 0, 0.17);
            line-height: 26px;
            padding: 0 8px;
            color: #000;
            transition: 0.4s all;
            border-radius: 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 12px;
            border: 1px solid transparent;
        }

        .month-action-text:focus{
            border: 1px solid #777;
        }

        .month-action-add{
            display: inline-block;
            margin: 0 0 0 4px;
            padding: 0 13px;
            border: none;
            height: 28px;
            line-height: 28px;
            text-align: center;
            transition: 0.4s all;
            border-radius: 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 12px;
            color: #fff;
            font-weight: 500;
            background: linear-gradient(187.02deg, rgba(173, 211, 255, 0.5) -174.74%, rgba(94, 139, 255, 0.495) -60.77%, rgba(39, 74, 255, 0.5) 123.01%);
            box-shadow: 1px 1px 2px 0.5px rgb(0 0 0 / 17%);
            cursor: default;
        }

        .month-action-add.active{
            background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%);
            box-shadow: 1px 1px 2px 0.5px rgba(0, 0, 0, 0.07);
            font-weight: 600;
            cursor: pointer;
        }

        .month-action-add.active:hover,
        .month-action-add.active:focus{
            opacity: 0.8;
        }

        .edit-settings-button{
            position: absolute;
        }

        .edit-settings-button{
            padding: 0;
            border: none;
            color: rgba(0,0,0,0.5);
            transition: 0.4s all;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            position: absolute;
            right: 9px;
            top: 4px;
            font-size: 24px;
            line-height: 0;
            background: transparent;
        }


        .edit-settings-button:hover,
        .edit-settings-button:focus{
            color: #000;
            transform: scale(1.15) translate(0, -1px);
        }

        .bottom-info-wrapper{
            margin-bottom: 10px !important;
            padding: 0 9px;
        }

        .this-month-goals{
            width: 46.5%;
            float: left;
            margin-right: 8px;
        }

        .notes-wrapper{
            width: calc(53.5% - 8px);
            float: left;
        }

        .this-month-goals{
            background: linear-gradient(124.99deg,
                rgba(202, 204, 255, 0.23) 9.27%,
                rgba(101, 107, 255, 0.13) 35.35%,
                rgba(208, 210, 255, 0.11) 121.69%);
            box-shadow: 1px 1px 2px rgba(15, 10, 255, 0.12);
            border-radius: 7px;
            padding: 10px 12px 7px 14px;
        }

        .notes-wrapper{
            background: rgba(245, 246, 248, 0.6);
            box-shadow: 1px 0.5px 2px rgba(0, 0, 0, 0.1);
            padding: 8px 11px;
            border-radius: 7px;
        }

        .this-month-goals h4,
        .notes-wrapper h4{
            display: block;
            margin: 0 0 6px 0;
            padding: 0;
            line-height: 1;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 13.5px;
            cursor: pointer;
            transition: 0.4s all;
        }

        .notes-wrapper h4{
            font-size: 11px;
            position: relative;
            margin: 0;
        }


        .notes-wrapper h4:hover,
        .notes-wrapper h4:focus{
            color: #274AFF;
        }

        .notes-wrapper h4:hover:before,
        .notes-wrapper h4:focus:before{
            color: #274AFF;
        }

        .notes-wrapper h4:before{
            content: '>';
            transform: rotate(90deg) scaleY(1.5);
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 8px;
            position: absolute;
            transition: 0.4s all;
            right: -5px;
            top: 2px;
            line-height: 1;
        }

        .notes-wrapper.opened h4:before,
        .week-notes-wrapper.opened h4:before,
        .day-notes-wrapper.opened h4:before,
        .popup-notes-wrapper.opened h4:after{
            transform: rotate(90deg) scaleX(-1) scaleY(1.5);
        }

        .this-month-goals textarea{
            width: 100%;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 20px;
            line-height: 18px;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
        }

        .this-month-goals textarea:focus{
            border: 1px solid #777;
            height: 38px;
        }

        .remove-input{
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #fff !important;
            display: block;
            position: absolute;
            right: 4px;
            top: 5px;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/remove.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            opacity: 0.2;
            width: 9px;
            height: 9px;
            border-radius: 50%;
            line-height: 8px;
            letter-spacing: 1px;
            text-align: center;
            font-size: 0 !important;
            transition: 0.4s all;
            margin: 0 !important;
        }

        .remove-input:hover,
        .remove-input:focus{
            opacity: 1;
        }

        .edit-input{
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #fff !important;
            display: block;
            position: absolute;
            right: 20px;
            top: 5px;
            width: 9px;
            height: 9px;
            border-radius: 50%;
            line-height: 8px;
            letter-spacing: 1px;
            text-align: center;
            font-size: 10px;
            margin: 0 !important;
        }

        .edit-input:after{
            content: '';
            display: block;
            width: 10px;
            position: absolute;
            left: 0;
            top: 0;
            height: 10px;
            transition: 0.4s all;
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/edit.png);
            opacity: 0.2;
        }

        .edit-input:hover:after,
        .edit-input:hover:focus{
            opacity: 1;
        }

        .this-month-goals-textarea-wrapper{
            position: relative;
            margin-bottom: 7px;
            line-height: 1;
        }

        .add-month-goal,
        .add-month-note,
        .add-week-note,
        .add-day-note,
        .add-popup-note,
        .add-week-task,
        .add-week-appointment{
            color: rgba(0,0,0,0.3);
            position: relative;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            letter-spacing: 0;
            line-height: 1;
            font-size: 10px;
            transition: 0.4s all;
            padding-left: 17px;
            vertical-align: top;
        }

        .add-month-note,
        .add-week-note,
        .add-day-note,
        .add-popup-note,
        .add-week-task,
        .add-week-appointment{
            display: none;
        }

        .add-month-goal span,
        .add-month-note span,
        .add-week-note span,
        .add-day-note span,
        .add-popup-note span,
        .add-week-task span,
        .add-week-appointment span{
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            display: block;
            position: absolute;
            color: #fff !important;
            left: 5px;
            top: 1px;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/add.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            opacity: 0.3;
            width: 9px;
            height: 9px;
            border-radius: 50%;
            line-height: 9px;
            letter-spacing: 1px;
            text-align: center;
            font-size: 0;
            transition: 0.4s all;
        }

        .add-month-goal:hover,
        .add-month-goal:focus,
        .add-month-note:hover,
        .add-month-note:focus,
        .add-week-note:hover,
        .add-week-note:focus,
        .add-day-note:hover,
        .add-day-note:focus,
        .add-popup-note:hover,
        .add-popup-note:focus,
        .add-week-task:hover,
        .add-week-appointment:hover,
        .add-week-task:focus,
        .add-week-appointment:focus{
            color: #000;
        }

        .add-month-goal:hover span,
        .add-month-goal:focus span,
        .add-month-note:hover span,
        .add-month-note:focus span,
        .add-week-note:hover span,
        .add-week-note:focus span,
        .add-day-note:hover span,
        .add-day-note:focus span,
        .add-popup-note:hover span,
        .add-popup-note:focus span,
        .add-week-task:hover span,
        .add-week-appointment:hover span,
        .add-week-task:focus span,
        .add-week-appointment:focus span{
            opacity: 1;
        }

        .add-week-appointment span,
        .add-week-task span{
            letter-spacing: 0;
        }


        .week-day:hover .add-week-appointment,
        .week-day:focus .add-week-appointment,
        .week-day:hover .add-week-task,
        .week-day:focus .add-week-task {
            display: inline !important;
        }


        .is-calendar-clicker,
        .is-week-clicker
        {
            position: absolute;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            display: block;
            color: #ccc;
            left: -10px;
            top: 4px;
            background-color: transparent;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/arr-left.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            line-height: 9px;
            text-align: center;
            font-size: 0;
            transition: 0.4s all;
            opacity: 0.5;
        }

        .is-calendar-clicker.is-calendar-click-right,
        .is-week-clicker.is-week-click-right{
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/arr-right.png);
            left: auto;
            right: -10px;
        }

        .is-calendar-clicker:hover,
        .is-calendar-clicker:focus,
        .is-week-clicker:hover,
        .is-week-clicker:focus{
            opacity: 1;
        }


        /*
        ////////////////////////////////
        ///////////////////////////////
         */

        .is-habit-wrapper{
            text-align: center;
            position: fixed;
            width: 100vw;
            height: 100vh;
            z-index: 100002;
            left: 0;
            top: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
        }

        .is-habit-wrapper.show{
            display: block;
        }

        .is-habit-popup {
            height: auto;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: 90vh;
            width: 90vw;
            max-width: 360px;
            padding: 25px 20px 35px 20px;
            background: #fff;
            border-radius: 15px;
            position: absolute;
            z-index: 1;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .popup-sett-wrapper h2 {
            margin-bottom: 50px;
        }

        .is-habit-wrapper h2 {
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 27px;
            color: #000;
            font-weight: 600;
            line-height: 1;
            margin: 0 0 22px 0 !important;
            text-align: center;
            display: block;
        }

        .popup-settings-wrapper a {
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            line-height: 1;
            font-size: 14px;
            text-align: center;
            color: #3F3F3F;
            float: right;
            transition: 0.4s all;
            margin-top: 5px;
        }

        .is-habit-wrapper .popup-close {
            text-decoration: none;
            font-size: 17px;
            position: absolute;
            right: 15px;
            top: 10px;
            z-index: 1;
        }

        .is-habit-wrapper .popup-close:hover,
        .is-habit-wrapper .popup-close:focus {
            color: #005de9;
        }

        .is-habit-wrapper p {
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            line-height: 1.5;
            font-size: 17px;
            color: #000;
            font-weight: 400;
            margin: 0 0 28px 0;
            text-align: left;
        }

        .is-habit-wrapper select {
            padding: 0 15px 0 10px;
            font-size: 15px;
            width: 210px;
            height: 28px;
            line-height: 26px;
            border-radius: 5px;
            border: 1px solid #777;
        }

        .is-habit-wrapper p span {
            width: 105px;
        }

        .popup-settings p span,
        .popup-settings p select {
            display: inline-block;
            vertical-align: top;
            height: 28px;
            line-height: 26px;
        }

        .is-habit-wrapper button {
            border: none;
            background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%);
            box-shadow: 2px 2px 6px rgb(0 0 0 / 12%);
            display: block;
            margin: 0;
            width: 100%;
            line-height: 1;
            padding: 11px;
            transition: 0.4s all !important;
            border-radius: 10px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 19px;
            color: #fff;
        }

        .is-habit-wrapper button.save-settings-popup,
        .is-habit-wrapper button.confirm-week-popup{
            width: 190px;
            display: inline-block;
        }

        .is-habit-wrapper button.save-settings-popup:hover,
        .is-habit-wrapper button.save-settings-popup:focus,
        .is-habit-wrapper button.confirm-week-popup:hover,
        .is-habit-wrapper button.confirm-week-popup:focus{
            opacity: 0.8;
        }

        .is-habit-wrapper button.cancel-settings-popup,
        .is-habit-wrapper button.cancel-week-popup{
            display: inline-block;
            background: linear-gradient(187.02deg,
                rgba(255, 255, 255, 0.6) -174.74%,
                rgba(248, 250, 255, 0.594) -60.77%,
                rgba(230, 234, 255, 0.6) 123.01%);
            box-shadow: 2px 2px 6px rgb(0 0 0 / 12%);
            width: 117px;
            margin-right: 9px;
            color: rgba(58, 96, 255, 0.5);
        }

        .is-habit-wrapper button.cancel-settings-popup:hover,
        .is-habit-wrapper button.cancel-settings-popup:focus,
        .is-habit-wrapper button.cancel-week-popup:hover,
        .is-habit-wrapper button.cancel-week-popup:focus{
            background: #274AFF;
            color: #fff;
        }

        .popup-settings-wrapper input[type="checkbox"]{
            display: none;
        }

        .is-habit-popup label {
            width: 40px;
            height: 14px;
            border-radius: 15px;
            background-color: #aaa;
            transition: 0.4s all;
            margin-left: 15px;
            margin-right: 33px;
            position: relative;
            z-index: 1;
            cursor: pointer;
            float: right;
            display: inline-block;
        }

        .is-habit-popup label:before {
            content: '';
            display: block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #838482;
            position: absolute;
            left: 0;
            top: -3px;
            transition: 0.4s all;
        }

        .is-habit-popup input:checked ~ label {
            background-color: #99EB58;
        }

        .is-habit-popup input:checked ~ label:before {
            background-color: #6BDE11;
            left: 20px;
        }

        .is-habit-tab.planner-week > h3{
            line-height: 1;
            margin: 0 0 12px 0;
            padding: 0 10px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 16px;
            font-weight: 600;
            color: #000;
            position: relative;
            display: none;
        }

        .is-habit-tab.planner-week > h3.is-week-current{
            display: block;
        }


        /*
        ////////////////////////////////
        ///////////////////////////////
         */


        .popup-plan-week{
            max-width: 470px;
            padding: 20px;
        }

        .popup-plan-week h2{
            font-size: 20px;
        }

        .popup-plan-week h3{
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 17px;
            color: #000;
            font-weight: 600;
            line-height: 1;
            margin: 0 0 22px 0;
            text-align: center;
            display: block;
        }

        .is-habit-wrapper button.cancel-week-popup{
            width: calc(40% - 9px);
        }

        .is-habit-wrapper button.confirm-week-popup{
            width: calc(60% - 4px);
        }

        .week-days{
            display: none;
        }

        .week-days.is-week-current{
            display: block;
        }

        .week-dates-wrapper{
            position: absolute;
            right: 0;
            top: -20px;
            text-align: right;
            padding: 0 10px;
        }

        .week-dates-wrapper h4{
            line-height: 1;
            margin: 0;
            padding: 0 20px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 14px;
            font-weight: 600;
            color: #000;
            display: block;
            position: relative;
        }

        .is-week-clicker{
            top: 0;
            left: 0;
        }

        .is-week-clicker.is-week-click-right {
             left: auto;
             right: 0;
        }

        .week-sidebar{
            display: inline-block;
            vertical-align: top;
            width: 33%;
            max-width: 248px;
            position: relative;
        }

        .this-week-goal-wrapper,
        .week-daily-focus-wrapper{
            background: linear-gradient(125.77deg, #F1EDFE 94.33%, #F5F2FE 168.81%);
            box-shadow: 1px 1px 2px rgba(64, 0, 255, 0.12);
            border-radius: 10px;
            margin-bottom: 15px !important;
            min-height: 135px;
            padding: 9px 11px;
            display: none;
        }

        .this-week-goal-wrapper.is-week-current,
        .week-daily-focus-wrapper.is-week-current{
            display: block;
        }

        .this-week-goal-wrapper{
            background: linear-gradient(124.99deg, rgba(202, 204, 255, 0.23) 9.27%, rgba(101, 107, 255, 0.13) 35.35%, rgba(208, 210, 255, 0.11) 121.69%);
        }

        .this-week-goal-wrapper,
        .week-daily-focus-wrapper{
            opacity: 0.4;
        }


        .is-completed-1 .this-week-goal-wrapper.is-week-1,
        .is-completed-1 .week-daily-focus-wrapper.is-week-1,
        .is-completed-2 .this-week-goal-wrapper.is-week-2,
        .is-completed-2 .week-daily-focus-wrapper.is-week-2,
        .this-week-goal-wrapper.is-week-previous,
        .week-daily-focus-wrapper.is-week-previous{
            opacity: 1;
        }

        .this-week-goal-wrapper h4,
        .week-daily-focus-headlines h4{
            line-height: 1;
            margin: 0 0 12px 0;
            padding: 0 10px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 13.5px;
            font-weight: 600;
            color: #000;
            display: block;
            position: relative;
            text-align: center;
        }

        .this-week-goal-wrapper textarea,
        .week-daily-focus-wrapper input{
            width: 100%;
            box-shadow: 1px 2px 4px 2px rgba(0, 0, 0, 0.05);
            border-radius: 3px;
            height: 24px;
            margin: 0 0 7px 0 !important;
            line-height: 18px;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
        }

        .this-week-goal-wrapper textarea{
            padding-top: 2px;
        }

        .week-daily-focus-headlines{
            text-align: center;
            margin-bottom: 12px;
            line-height: 1;
        }

        .week-daily-focus-headlines h4{
            display: inline-block;
        }

        .week-daily-focus-headlines h4:after{
            content: '';
            display: block;
            position: absolute;
            width: 14px;
            height: 18px;
            background-color: transparent;
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
            border-radius: 50%;
            right: -12px;
            top: -3px;
        }

        .week-notes-wrapper{
            background: rgba(252, 253, 254, 0.6);
            box-shadow: 1px 2px 3px rgb(0 0 0 / 9%);
            border-radius: 5px;
            padding: 6px 9px;
        }

        .week-notes-wrapper{
            opacity: 0.4;
        }

        .week-notes-wrapper.is-prev{
            display: none !important;
        }

        .is-completed-1 .week-notes-wrapper.is-1,
        .is-completed-2 .week-notes-wrapper.is-2,
        .week-notes-wrapper.is-prev{
            opacity: 1;
        }

        .week-notes-wrapper h4{
            line-height: 1;
            margin: 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 16px;
            font-weight: 600;
            color: #000;
            display: block;
            position: relative;
            transition: 0.4s all;
            cursor: pointer;
        }

        .week-notes-wrapper h4:hover,
        .week-notes-wrapper h4:focus{
            color: #274AFF;
        }

        .week-notes-wrapper h4:before {
            content: '>';
            transform: rotate(90deg) scaleY(1.5);
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 8px;
            position: absolute;
            transition: 0.4s all;
            right: 3px;
            top: 5px;
            line-height: 1;
        }

        .week-notes-wrapper h4:hover:before ,
        .week-notes-wrapper h4:focus:before {
            color: #274AFF;
        }

        .week-days:after{
            display: block;
            clear: both;
            content: '';
        }

        .week-day{
            background: #F9FAFB;
            border-radius: 6px;
            margin-bottom: 10px;
            width: 100%;
            padding: 0 12px 7px;
            min-height: 99px;
            float: left;
            position: relative;
            cursor: pointer;
            transition: 0.4s all;
            border: 1px solid transparent;
        }

        .week-day.have-focus{
            background: #F5F2FE;
            box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
        }

        .week-day:hover,
        .week-day:focus{
            border: 1px solid #c4bfd5;
        }

        .is-week-previous .week-day,
        .week-day.prev-day{
            border: 1px solid transparent;
            cursor: default;
        }

        .week-day:after {
            content: '';
            display: block;
            position: absolute;
            width: 14px;
            height: 14px;
            background: rgba(217, 217, 217);
            border-radius: 50%;
            right: 4px;
            top: 6px;
        }

        .week-day.have-focus:after {
            width: 14px;
            height: 18px;
            background-color: transparent;
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
            border-radius: 50%;
            right: 4px;
            top: 3px;
        }

        .week-day{
            opacity: 0.4;
        }

        .is-completed-1 .is-week-1 .week-day,
        .is-completed-2 .is-week-2 .week-day,
        .is-week-previous .week-day{
            opacity: 1;
        }

        .week-day.week-day-saturday,
        .week-day.week-day-sunday{
            width: calc(50% - 5px);
        }

        .week-day.week-day-saturday{
            margin-right: 10px;
        }

        .week-day h4{
            line-height: 1;
            margin: 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 13.5px;
            font-weight: 600;
            color: #000;
            display: inline-block;
            position: relative;
        }


        /*
        ////////////////////////////////
        ///////////////////////////////
         */


        .is-habit-tab.planner-day h3 {
            line-height: 1;
            margin: 0 0 6px 0;
            padding: 0 10px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 16px;
            font-weight: 600;
            color: #000;
            display: block;
        }

        .is-habit-tab.planner-day h6{
            line-height: 1;
            margin: 0 0 8px 0;
            padding: 0 10px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 13.5px;
            font-weight: 500;
            color: #000;
            font-style: italic;
            display: none;
        }

        .is-habit-tab.planner-day > h3 span{
            display: none;
        }

        .is-day-finished.is-habit-tab.planner-day h6{
            display: block;
        }

        .is-day-finished.is-habit-tab.planner-day > h3 span{
            display: inline;
        }

        .day-wrapper{
            padding: 0 10px;
            display: inline-block;
            vertical-align: top;
            width: calc(67% - 24px);
            margin-right: 20px;
        }

        .day-sidebar{
            display: inline-block;
            vertical-align: top;
            width: 33%;
            max-width: 210px;
        }

        .day-daily-actions,
        .day-daily-focus,
        .day-secondary-tasks,
        .day-notes-wrapper{
            background: #FBFBFB;
            box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);
            border-radius: 6px;
            padding: 9px 6px;
            overflow: hidden;
        }

        .day-daily-actions{
            min-height: 94px;
            margin-bottom: 14px;
        }

        .day-daily-focus{
            background: #F5F2FE;
            min-height: 145px;
            margin-bottom: 14px;
            position: relative;
        }

        .day-daily-focus:after{
            display: block;
            content: '';
            background: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 14px;
            height: 18px;
            right: 8px;
            top: 4px;
            position: absolute;
        }

        .day-secondary-tasks{
            min-height: 95px;
            margin-bottom: 14px;
        }

        .day-notes-wrapper{
            background: #FCFDFE;
            box-shadow: 1px 2px 3px rgb(0 0 0 / 9%);
            padding: 9px;
        }

        .day-notes-wrapper h4:hover,
        .day-notes-wrapper h4:focus{
            color: #274AFF;
        }

        .day-notes-wrapper h4:hover:before ,
        .day-notes-wrapper h4:focus:before {
            color: #274AFF;
        }

        .day-notes-wrapper h4:before {
             content: '>';
             transform: rotate(90deg) scaleY(1.5);
             font-family: 'avenir-next-lt-pro-r', sans-serif !important;
             color: #000;
             font-size: 8px;
             transition: 0.4s all;
             position: absolute;
             right: 10px;
             top: 4px;
             line-height: 1;
        }

        .day-daily-actions h4,
        .day-daily-focus h4,
        .day-secondary-tasks h4,
        .day-notes-wrapper h4{
            line-height: 1;
            margin: 0 0 16px 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 16px;
            font-weight: 600;
            color: #000;
            display: block;
        }

        .action-input-wrapper span,
        .action-input-wrapper a,
        .task-input-wrapper span,
        .is-focus-input-wrapper span{
            line-height: 1;
            font-size: 14px;
            margin: 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-weight: 400;
            text-align: left;
            color: #000;
            transition: 0.4s all;
        }

        .action-input-wrapper a:hover,
        .action-input-wrapper a:focus{
            color: #274AFF;
        }

        .time-span{
            position: absolute;
            left: 7px;
            top: -6px;
            line-height: 1;
            font-size: 10px !important;
            margin: 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-weight: 400;
            display: block;
            text-align: left;
            color: rgb(0,0,0,0.3) !important;
        }

        .time-span span{
            font-size: 10px !important;
            color: rgb(0,0,0,0.3) !important;
            text-decoration: none !important;
        }

        .day-notes-wrapper h4{
            margin: 0;
            position: relative;
            cursor: pointer;
            transition: 0.4s all;
        }

        .day-appointments{
            background: #FFFEF9;
            box-shadow: 2px 4px 6px rgba(0, 0, 0, 0.08);
            padding: 12px;
            min-height: 137px;
            margin-bottom: 15px;
            display: none;
        }

        .day-appointments.show{
            display: block;
        }

        .day-appointments h4{
            display: block;
            line-height: 1;
            margin: 0 0 6px 0;
            text-align: center;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 14px;
            font-weight: 400;
            color: #000;
        }

        .end-of-day-review{
            background: linear-gradient(305.94deg, rgba(78, 84, 255, 0.13) 11.58%, rgba(208, 210, 255, 0.11) 131.25%);
            box-shadow: 1px 1px 4px 1px rgba(10, 19, 255, 0.15);
            border-radius: 4px;
            padding: 9px;
            min-height: 96px;
            margin-bottom: 22px;
            display: none;
        }

        .end-of-day-review.show{
            display: block;
        }


        .end-of-day-review h4{
            display: block;
            line-height: 1;
            margin: 0 0 6px 0;
            text-align: center;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 12.5px;
            font-weight: 600;
            color: #434242;
        }

        .day-progress{
            text-align: center;
            background: linear-gradient(305.94deg, rgba(78, 84, 255, 0.13) 11.58%, rgba(208, 210, 255, 0.11) 131.25%);
            box-shadow: 1px 1px 4px 1px rgb(10 19 255 / 20%);
            border-radius: 6px;
            padding: 6px 0;
        }

        .day-progress h4{
            display: block;
            line-height: 1;
            margin: 0 0 6px 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 10px;
            font-weight: 400;
            color: #000;
        }

        .day-progress h5{
            display: block;
            line-height: 1;
            margin: 0 0 6px 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 9.5px;
            font-weight: 400;
            color: #000;
        }

        .progress-daily-focus,
        .progress-today-tasks,
        .progress-daily-planning{
            display: inline-block;
            vertical-align: top;
            width: calc(33.33% - 3px);
        }

        .day-progress-circle{
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: transparent;
            margin: 0 auto 5px;
            --ratio: 0;
            position: relative;
            box-shadow: 0 2.72665px 2.72665px rgb(0 0 0 / 4%);
        }

        .daily-focus-circle{
            background: radial-gradient(60% 60% at 50% 50%, rgba(72, 123, 255, 0.99) 14.58%, #531DEB 59.9%, #A21AE2 94.79%);
        }

        .today-tasks-circle{
            background: radial-gradient(60% 60% at 50% 50%, #ADD3FF 34.9%, rgba(94, 139, 255, 0.99) 61.74%, #4D69FF 100%);
        }

        .daily-planning-circle{
            background: radial-gradient(60% 60% at 50% 50%, #ECD664 34.9%, rgba(255, 229, 94, 0.99) 61.74%, #DF8114 100%)
        }

        .day-progress-circle:before{
            content: '';
            display: block;
            clear: both;
            position: absolute;
            width: calc(100% - 8px);
            height: calc(100% - 8px);
            top: 4px;
            left: 4px;
            background-color: #f0f0ff;
            border-radius: 50%;
            z-index: 2;
        }

        .day-progress-circle:after{
            content: '';
            display: block;
            clear: both;
            position: absolute;
            width: calc(100%);
            height: calc(100%);
            top: 0;
            left: 0;
            background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
            border-radius: 50%;
            z-index: 1;
        }

        .plan-your-week{
            display: none;
            width: 100%;
            background: linear-gradient(188.12deg, #FFF7CF -72.15%, rgba(255, 229, 94, 0.99) -44.33%, #FDA804 160.79%);
            box-shadow: 2px 2px 6px rgb(0 0 0 / 10%);
            border-radius: 6px;
            transition: 0.4s all;
            margin: 0 0 10px 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 13px;
            height: 38px;
            border: none;
            line-height: 34px;
            font-weight: 400;
            color: #fff;
        }

        .plan-your-week.is-week-current{
            display: block;
        }

        .plan-your-week.previous{
            display: none;
        }

        .plan-your-week.hidden,
        .is-completed-1 .plan-your-week.is-week-1,
        .is-completed-2 .plan-your-week.is-week-2{
            display: none !important;
        }

        .plan-your-week:hover,
        .plan-your-week:focus{
            opacity: 0.7;
        }

        .appointment-items-wrapper{
            text-align: center;
        }

        .appointment-item{
            line-height: 1;
            margin: 0 0 6px 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 12.5px;
            font-weight: 400;
            color: #000;
            display: inline-block;
            position: relative;
        }

        .appointment-item .icon{
            width: 14px;
            position: absolute;
            left: -19px;
            top: -2px;
            height: 13px;
            background-size: contain;
            background-position: center center;
            background-repeat: no-repeat;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/appointment.png);
        }

        .p-badge-0,
        .p-badge-1,
        .p-badge-2,
        .day-badge-1,
        .day-badge-2{
            display: none !important;
        }

        .is-badge-0 .end-day-circle-progress-wrapper,
        .is-badge-0 .p-badge-0,
        .is-badge-1 .p-badge-1,
        .is-badge-2 .p-badge-2,
        .is-badge-1 .day-badge-1,
        .is-badge-2 .day-badge-2{
            display: block !important;
        }

        .end-of-day-review h5{
            display: block;
            line-height: 1;
            margin: 0 0 6px 0;
            text-align: center;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 10.5px;
            font-weight: 600;
            color: #1D1A1A;
        }

        .end-of-day-review p{
            display: block;
            line-height: 1;
            margin: 0 0 6px 0;
            text-align: center;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 10.5px;
            font-weight: 400;
            color: #000;
        }

        .day-badge{
            display: inline-block;
            width: calc(50% - 4px);
            min-height: 61.5px;
            position: relative;
        }

        .day-badge span{
            font-size: 40px;
            font-weight: 300;
            color: #000;
            position: absolute;
            line-height: 1;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
        }

        .badge-icon{
            width: 46px;
            height: 46px;
            background-size: contain;
            background-position: center center;
            background-repeat: no-repeat;
            margin: 0 auto 5px;
        }

        .badge-icon-daily-focus{
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
        }

        .badge-icon-perfect-day{
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/perfect-day.png);
        }

        .month-notes-textarea,
        .week-notes-textarea,
        .day-notes-textarea,
        .popup-notes-textarea{
            width: 100%;
            resize: none;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 11px;
            line-height: 18px;
            transition: 0.4s all;
            border: 1px solid transparent;
            border-radius: 3px;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            color: #000;
        }

        .month-notes-textarea[readonly],
        .week-notes-textarea[readonly],
        .day-notes-textarea[readonly],
        .popup-notes-textarea[readonly]{
            height: 20px;
            line-height: 18px;
            border: 1px solid transparent !important;
        }

        .month-notes-textarea:focus,
        .week-notes-textarea:focus,
        .day-notes-textarea:focus,
        .popup-notes-textarea:focus{
            border: 1px solid #777;
        }

        .month-notes-textarea-wrapper,
        .week-notes-textarea-wrapper,
        .day-notes-textarea-wrapper,
        .popup-notes-textarea-wrapper{
            display: none;
            margin-top: 6px;
            position: relative;
        }

        .notes-wrapper.opened .month-notes-textarea-wrapper,
        .week-notes-wrapper.opened .week-notes-textarea-wrapper,
        .day-notes-wrapper.opened .day-notes-textarea-wrapper,
        .popup-notes-wrapper.opened .popup-notes-textarea-wrapper{
            display: block;
        }

        .notes-wrapper.opened .add-month-note,
        .week-notes-wrapper.opened .add-week-note,
        .day-notes-wrapper.opened .add-day-note,
        .popup-notes-wrapper.opened .add-popup-note{
            display: inline;
        }

        .month-notes-textarea-wrapper.is-filled,
        .week-notes-textarea-wrapper.is-filled,
        .day-notes-textarea-wrapper.is-filled,
        .popup-notes-textarea-wrapper.is-filled
        {
            /*display: block !important;*/
        }

        .this-month-goals-textarea-wrapper .edit-input,
        .this-month-goals-textarea-wrapper .remove-input{
            display: none !important;
        }

        .this-month-goals-textarea-wrapper.is-filled.is-hover .edit-input,
        .this-month-goals-textarea-wrapper.is-filled.is-hover .remove-input{
            display: block !important;
        }



        .notes-wrapper .edit-input,
        .notes-wrapper .remove-input,
        .week-notes-wrapper .edit-input,
        .week-notes-wrapper .remove-input,
        .day-notes-wrapper .edit-input,
        .day-notes-wrapper .remove-input,
        .popup-notes-wrapper .edit-input,
        .popup-notes-wrapper .remove-input,
        .popup-goals-textarea-wrapper .edit-input,
        .popup-goals-textarea-wrapper .remove-input{
            display: none !important;
        }

        .notes-wrapper .is-filled .edit-input,
        .notes-wrapper .is-filled .remove-input,
        .week-notes-wrapper .is-filled .edit-input,
        .week-notes-wrapper .is-filled .remove-input,
        .day-notes-wrapper .is-filled .edit-input,
        .day-notes-wrapper .is-filled .remove-input,
        .popup-notes-wrapper .is-filled .edit-input,
        .popup-notes-wrapper .is-filled .remove-input,
        .popup-goals-textarea-wrapper.is-filled .edit-input,
        .popup-goals-textarea-wrapper.is-filled .remove-input{
            display: block !important;
        }

        .this-month-goals-textarea[readonly] {
            height: 20px !important;
            line-height: 18px;
            border: 1px solid transparent !important;
            overflow: hidden;
        }

        .month-day-inner{
            position: relative;
        }

        .month-day-inner{

        }

        .imitate-day-wrapper{
            position: absolute;
            right: 30px;
            top: 10px;
        }

        .imitate-day-wrapper select{
            height: 30px;
            padding: 0 15px 0 5px;
        }
    </style>
    <?php
        $user_date_display = get_user_meta(get_current_user_id(), 'user_date_display', true);
        $user_routines = get_user_meta(get_current_user_id(), 'user_routines', true);
        $user_timezone = get_user_meta(get_current_user_id(), 'user_timezone', true);
        if (!$user_routines) {
            $user_routines = '';
        }
        if (!$user_date_display) {
            $user_date_display = 'd/m/Y';
        }
        if (!$user_timezone){
            $user_timezone = 'Australia/Sydney';
        }
        date_default_timezone_set($user_timezone);
    ?>
    <div class="habit-plugin-wrapper">
        <!--<Div class="imitate-day-wrapper">
            <span>Imitate day:</span>
            <select class="imitate-day">
                <?php
/*
                $imitate_day = get_post_meta(16238,'imitate_day',true);

                for ($i = -60; $i<= 60; $i++){
                    */?>
                    <option value="<?php /*echo $i; */?>" <?php /*if ($i == $imitate_day) echo ' selected '; */?>>
                        <?php /*echo date('d-m-Y',strtotime('+'.$i . ' days',time())); */?>
                    </option>
                    <?php
/*                }
                */?>
                <option></option>
            </select>
            <button class="imitate-reset">Reset</button>
        </Div>-->
        <?php
        $tab_day = '0';
        if (isset($_GET['tab'])){
            $tab_day = $_GET['tab'];
        }
        ?>
        <div class="habit-plugin-tabs">
            <div class="habit-tab-wrapper">
                <a href="#" class="<?php if ($tab_day !== 'day') echo 'active'; ?>" data-link="planner-month">Month</a>
                <a href="#" class="" data-link="planner-week">Week</a>
                <a href="#" class="<?php if ($tab_day == 'day') echo 'active'; ?>" data-link="planner-day">Day</a>
            </div>
        </div>
        <style>
            .calendar-h2-wrapper h2{
                display: none;
            }

            .calendar-h2-wrapper h2.is-h2-current{
                display: inline-block;
            }
        </style>
        <div class="is-habit-tab <?php if ($tab_day !== 'day') echo 'show'; ?> planner-month">
            <div class="planner-calendar-wrapper">
                <div class="calendar-h2-wrapper">
                    <?php
                    for ($ii = -10; $ii <= 6; $ii++){
                        $m = date('m',time() + $imitate_day * 86400);
                        $m_new = $m + $ii ;

                        $m_year = date('Y',time() + $imitate_day * 86400);

                        if ($m_new > 12){
                            $m_new = $m_new - 12;
                            $m_year++;
                        }
                        elseif($m_new < 1){
                            $m_new = 12 + $m_new;
                            $m_year--;
                        }

                        $monthName = date('F', mktime(0, 0, 0, $m_new, 10));
                        ?>
                        <h2 class="<?php if ($ii == 0) echo 'is-h2-current'; ?>">
                            <?php
                            if ($ii > -10){
                                ?>
                                <a href="#" class="is-calendar-clicker is-calendar-click-left"><</a>
                                <?php
                            }
                            ?>
                            <?php echo $monthName.' '.$m_year; ?>
                            <?php
                            if ($ii < 6){
                                ?>
                                <a href="#" class="is-calendar-clicker is-calendar-click-right">></a>
                                <?php
                            }
                            ?>
                        </h2>
                        <?php
                    }
                    ?>
                </div>


                <button class="edit-settings-button">...</button>
                <div class="month-actions">
                    <input type="text" class="month-action-text">
                    <button class="month-action-add">Add Action</button>
                </div>
                <div class="month-headers">
                    <h6>Monday</h6>
                    <h6>Tuesday</h6>
                    <h6>Wednesday</h6>
                    <h6>Thursday</h6>
                    <h6>Friday</h6>
                    <h6>Saturday</h6>
                    <h6>Sunday</h6>
                </div>
                <div class="month-days-wrapper">
                    <?php
                    global $wpdb;
                    $rows_tasks = $wpdb->get_results("
                                        SELECT * FROM ".$wpdb->prefix."habit_data 
                                        WHERE user_id=".get_current_user_id()." 
                                        AND type='task' 
                                        ORDER BY number ASC
                                    ");
                    $rows_tasks1 = $rows_tasks;
                    $number_tasks = $rows_tasks[count($rows_tasks) - 1]->number;

                    if (!$number_tasks){
                        $number_tasks = 0;
                    }

                    for ($ii = -10; $ii <= 6; $ii++){
                        ?>
                        <div class="month-days <?php if ($ii == 0) echo 'is-month-current'; ?>">
                            <?php

                            $curr_year = date('Y',time() + $imitate_day * 86400 );
                            $curr_month = date('m',time() + $imitate_day * 86400);
                            $curr_day = date('d',time() + $imitate_day * 86400);

                            $next_year = $curr_year;
                            $prev_year = $curr_year;

                            $next_month = $curr_month + 1;
                            $prev_month = $curr_month - 1;

                            if ($next_month > 12){
                                $next_month = 1;
                                $next_year++;
                            }

                            if ($prev_month < 1){
                                $prev_month = 12;
                                $prev_year--;
                            }


                            $next_month = $next_month + $ii;
                            $prev_month = $prev_month + $ii;
                            if ($next_month > 12){
                                $next_month = $next_month - 12;
                                $next_year++;
                            }
                            elseif($next_month < 1){
                                $next_month = 12 + $next_month;
                                $next_year--;
                            }

                            if ($prev_month < 1){
                                $prev_month = 12 + $prev_month;
                                $prev_year--;
                            }
                            elseif($prev_month > 12){
                                $prev_month = $prev_month - 12;
                                $prev_year++;
                            }


                            $prev_t = date('t',strtotime($prev_year.'-'.$prev_month));

                            $last_month = Date("N", strtotime(date($prev_year.'-'.$prev_month.'-'.$prev_t,time() + $imitate_day * 86400)));
                            $next_month = Date("N", strtotime(date($next_year.'-'.$next_month.'-01',time() + $imitate_day * 86400)));

                            if ($last_month < 7){
                                for ($i=1; $i<=$last_month; $i++){
                                    ?>
                                    <div class="month-day is-empty-day"></div>
                                    <?php
                                }
                            }

                            $curr_month = $curr_month + $ii;

                            if ($curr_month < 1){
                                $curr_month = 12 + $curr_month;
                                $curr_year--;
                            }
                            else if($curr_month > 12)
                            {
                                $curr_month = $curr_month - 12;
                                $curr_year++;
                            }

                            $var_days = date('t',strtotime($curr_year.'-'.$curr_month.'-01'));

                            for ($i=1; $i<=$var_days; $i++){

                                $today_day = date('d',time() + $imitate_day * 86400);

                                ?>
                                <div class="month-day
                                    <?php if ( (($i < $today_day) && ($ii == 0)) || ($ii < 0) ){ echo 'is-previous-day';} ?>
                                    <?php if ((($i + 1) == $today_day) && ($ii == 0)){ echo 'is-yesterday';} ?>
                                    " data-date="<?php
                                        echo date('Y-m-d',strtotime($curr_year.'-'.$curr_month.'-'.$i));
                                        ?>">
                                    <p class="day-number
                                        <?php if (($today_day == $i) && ($ii == 0)){echo 'is-today';} ?>
                                        "><?php echo $i; ?>
                                    </p>
                                    <?php
                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime($curr_year.'-'.$curr_month.'-'.$i))){
                                                ?>
                                                <div class="month-day-inner" data-number="<?php echo $row->number; ?>">
                                                    <input type="text" readonly value="<?php echo $row->text; ?>">
                                                    <a href="#" class="remove-input">x</a>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                                <?php
                            }

                            if ($next_month > 1){
                                for ($i=1; $i<=(7 - $next_month + 1); $i++){
                                    ?>
                                    <div class="month-day is-empty-day"></div>
                                    <?php
                                }
                            }
                            ?>
                        </div>
                        <?php
                    }
                    ?>
                </div>
            </div>
            <div class="is-hidden-counter counter-tasks"><?php echo $number_tasks; ?></div>
            <div class="bottom-info-wrapper">
                <div class="this-month-goals">
                    <h4>This Months Goal</h4>
                    <?php
                    $number_last_month_goal = 0;
                    $rows_goals = $wpdb->get_results("
                        SELECT * FROM ".$wpdb->prefix."habit_data WHERE user_id=".get_current_user_id()." AND type='month_goal' ORDER BY number ASC
                        ");
                    if ($rows_goals){
                        foreach ($rows_goals as $row){
                            $number_last_month_goal = $row->number;
                            ?>
                            <div class="this-month-goals-textarea-wrapper is-filled" data-number="<?php echo $row->number; ?>">
                                <textarea class="this-month-goals-textarea" readonly><?php echo $row->text; ?></textarea>
                                <a href="#" class="edit-input"></a>
                                <a href="#" class="remove-input">x</a>
                            </div>
                            <?php
                        }
                    }
                    else{
                        ?>
                        <div class="this-month-goals-textarea-wrapper">
                            <textarea class="this-month-goals-textarea"></textarea>
                            <a href="#" class="edit-input"></a>
                            <a href="#" class="remove-input">x</a>
                        </div>
                        <?php
                    }
                    ?>
                    <a href="#" class="add-month-goal"><span>+</span> Add month goal</a>
                </div>
                <style>
                    .is-hidden-counter{
                        display: none;
                    }
                </style>
                <div class="is-hidden-counter counter-month-goal"><?php echo $number_last_month_goal; ?></div>
                <div class="notes-wrapper">
                    <h4>Notes</h4>
                    <?php
                    $number_notes = 0;
                    $rows_goals = $wpdb->get_results("
                        SELECT * FROM ".$wpdb->prefix."habit_data WHERE user_id=".get_current_user_id()." AND type='note' ORDER BY number ASC
                        ");
                    if ($rows_goals){
                        foreach ($rows_goals as $row){
                            $number_notes = $row->number;
                            ?>
                            <div class="month-notes-textarea-wrapper is-filled" data-number="<?php echo $row->number; ?>">
                                <textarea class="month-notes-textarea" readonly><?php echo $row->text; ?></textarea>
                                <a href="#" class="edit-input"></a>
                                <a href="#" class="remove-input">x</a>
                            </div>
                            <?php
                        }
                    }
                    else{
                        ?>
                        <div class="month-notes-textarea-wrapper">
                            <textarea class="month-notes-textarea"></textarea>
                            <a href="#" class="edit-input"></a>
                            <a href="#" class="remove-input">x</a>
                        </div>
                        <?php
                    }
                    ?>
                    <a href="#" class="add-month-note"><span>+</span> Add Note</a>
                </div>
                <div class="is-hidden-counter counter-notes"><?php echo $number_notes; ?></div>
            </div>
        </div>
        <style>

            .title-your-week span{
                display: inline;
            }

            .is-completed-1 .is-week-header-1,
            .is-completed-2 .is-week-header-2{
                display: none !important;
            }

            .week-day-inside-wrapper{
                position: relative;
            }

            .week-day-inside-wrapper:after{
                content: '';
                display: block;
                clear: both;
            }

            .week-action-wrapper{
                float: left;
                width: calc(65% - 7px);
                margin-right: 7px;
                min-height: 1px;
            }

            .week-appointment-wrapper{
                width: 35%;
                min-height: 1px;
                float: left;
            }

            .week-day.week-day-saturday .week-action-wrapper,
            .week-day.week-day-sunday .week-action-wrapper,
            .week-day.week-day-saturday .week-appointment-wrapper,
            .week-day.week-day-sunday .week-appointment-wrapper{
                width: 100%;
                float: none;
            }

            .week-day-inside-wrapper input,
            .week-day-inside-wrapper textarea{
                width: 100%;
                box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
                border-radius: 3px;
                height: 20px;
                line-height: 18px;
                padding: 0 5px;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                color: #000;
                font-size: 12px;
                transition: 0.4s all;
                border: 1px solid transparent;
                resize: none;
            }

            .week-day-inside-wrapper textarea[readonly] {
                height: 20px !important;
                line-height: 18px;
                border: 1px solid transparent !important;
                overflow: hidden;
            }

            .week-action-inside.is-hover textarea{
                border: 1px solid #97a8ff !important;
            }

            .week-day-inside-wrapper textarea:focus {
                border: 1px solid #777 !important;
                height: 38px;
            }


            .week-action-inside .remove-input{
                display: none;
            }

            .week-action-inside.is-hover textarea ~ .remove-input{
                display: block;
            }

            .week-action-inside,
            .week-appointment-inside{
                position: relative;
                margin: 0 0 4px 0;
            }

            .week-appointment-inside .time-input-wrapper{
                right: 20px;
            }

            .week-appointment-inside .remove-input{
                top: 7px;
                display: none;
            }

            .week-day-inside .remove-input{
                display: none;
            }

            .week-appointment-inside.is-hover .remove-input,
            .week-day-inside.is-hover .remove-input{
                display: block;
            }

            .week-day-inside-wrapper .is-hover input{
                border: 1px solid #97a8ff;
            }

            .week-days-wrapper{
                padding: 0 10px;
                vertical-align: top;
                width: calc(67% - 24px);
                margin-right: 20px;
                position: relative;
                display: inline-block;
            }

            .is-week-previous .week-day{
                background: rgb(243 243 243 / 60%);
            }

            .week-past-item{
                position: relative;
                overflow: hidden;
            }


            .week-past-item span{
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 11px;
                font-weight: 400;
                color: #000;
            }

            .week-past-item.completed span{
                text-decoration: line-through;
            }

            .is-week-previous .week-action-wrapper,
            .prev-day .week-action-wrapper
            {
                float: left;
                width: 100%;
            }

            .week-past-item button{
                line-height: 1;
                margin: 0 0 10px 0;
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 16px;
                font-weight: 600;
                color: #000;
                display: block;
                transition: 0s all;
                cursor: default;
                position: absolute;
                right: 17px;
                top: 7px;
                width: 11px;
                height: 11px;
                border: none;
                outline: none;
                box-shadow: none;
                background: #D9D9D9;
                border-radius: 50%;
            }

            .week-past-item.completed button{
                background-size: contain;
                background-position: 50% 50%;
                background-repeat: no-repeat;
                background-image: url(/wp-content/plugins/habit-planner/assets/img2/completed.png);
            }

            .week-past-item.past-item-focus button{
                opacity: 0.6;
                background-size: contain;
                background-position: 50% 50%;
                background-repeat: no-repeat;
                background-image: url(/wp-content/plugins/habit-planner/assets/img2/remove.png);
            }

            .week-past-item.past-item-focus.completed  button{
                opacity: 1;
                background-size: contain;
                background-position: 50% 50%;
                background-repeat: no-repeat;
                background-image: url(/wp-content/plugins/habit-planner/assets/img2/completed.png);
            }

            .week-day.not-all-focus{
                background: #FFF2F2;
            }


            .week-day.not-all-focus:after{
                filter: brightness(0.4);
                display: block;
                content: '';
                background: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
                background-size: contain;
                background-position: 50% 50%;
                background-repeat: no-repeat;
                width: 14px;
                height: 18px;
                right: 8px;
                top: 4px;
                position: absolute;
            }

            .week-day.good-day{
                background: #F5F2FE;
                box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            }

            .week-day.good-day:after{
                display: block;
                content: '';
                background: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
                background-size: contain;
                background-position: 50% 50%;
                background-repeat: no-repeat;
                width: 14px;
                height: 18px;
                right: 8px;
                top: 4px;
                position: absolute;
            }

            .week-day.perfect-day{
                background: linear-gradient(73.51deg, #F5F2FE 72.33%, rgba(245, 242, 254, 0) 132.91%);
                box-shadow: 1px 1px 4px 1px rgba(10, 19, 255, 0.25);
            }

             .week-day.perfect-day:after{
                display: block;
                content: '';
                background: url(/wp-content/plugins/habit-planner/assets/img2/perfect-day.png);
                background-size: contain;
                background-position: 50% 50%;
                background-repeat: no-repeat;
                width: 14px;
                height: 18px;
                right: 8px;
                top: 4px;
                position: absolute;
                border-radius: 0;
            }

            html body .is-week-previous .week-goal-textarea-wrapper.is-filled .edit-input,
            html body .is-week-previous .week-goal-textarea-wrapper.is-filled .remove-input{
                display: none !important;
            }
        </style>
        <?php
        $is_tomorrow = date('N',time() + $imitate_day * 86400) + 1;

        $is_today_N = date('N',time() + $imitate_day * 86400);

        if ($imitate_day <= 0){
            $imitate_day_week = intdiv(($imitate_day - $is_today_N + 1), 7);
        }
        else{
            $imitate_day_week = intdiv(($imitate_day +7 - $is_today_N + 1), 7);
        }

        $rows_week_planned_1 = $wpdb->get_results("
            SELECT * FROM ".$wpdb->prefix."habit_data 
            WHERE user_id=".get_current_user_id()." 
            AND type='week_planned' 
            AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400)."'
            ORDER BY number ASC
        ");
        $rows_week_planned_2 = $wpdb->get_results("
            SELECT * FROM ".$wpdb->prefix."habit_data 
            WHERE user_id=".get_current_user_id()." 
            AND type='week_planned' 
            AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + 1*7*86400)."'
            ORDER BY number ASC
        ");
        $add_planned_class = '';
        if ($rows_week_planned_1){
            $add_planned_class = $add_planned_class . ' is-completed-1 ';
        }
        if ($rows_week_planned_2){
            $add_planned_class = $add_planned_class . ' is-completed-2 ';
        }
        ?>
        <div class="is-habit-tab planner-week <?php echo $add_planned_class; ?>">
            <?php
            $rows_appointments = $wpdb->get_results("
                                        SELECT * FROM ".$wpdb->prefix."habit_data 
                                        WHERE user_id=".get_current_user_id()." 
                                        AND type='appointment' 
                                        ORDER BY number ASC
                                    ");
            $number_appointments = $rows_appointments[count($rows_appointments) - 1]->number;
            if (!$number_appointments){
                $number_appointments = 0;
            }

            $rows_tasks1 = $rows_tasks;
            for($i = -44; $i <=1; $i++){
                ?>
                <h3 class="title-your-week <?php if ($i == 0) echo 'is-week-current'; ?>">Your Week
                    <?php if ($i >= 0){echo '<span class="is-week-header-'.($i+1).'">: Pending</span>';} ?>
                </h3>
                <?php
            }
            ?>
            <div class="week-days-wrapper">
            <?php

            $c_counter = array();
            $s_stats = array();
            $f_have_focus = array();
            for($i = -44; $i <=1; $i++){
                $c_counter[$i]['good'] = 0;
                $c_counter[$i]['perfect'] = 0;
                $c_counter[$i]['not_finished'] = 0;
                $f_have_focus[$i][1] = '';
                $f_have_focus[$i][2] = '';
                $f_have_focus[$i][3] = '';
                $f_have_focus[$i][4] = '';
                $f_have_focus[$i][5] = '';
                $f_have_focus[$i][6] = '';
                $f_have_focus[$i][7] = '';
                ?>
                <div class="week-days
                <?php if ($i < 0) echo 'is-week-previous'; ?>
                <?php if ($i == 0) echo 'is-week-current'; ?>
                <?php if ($i == 0) echo 'is-week-1'; ?>
                <?php if ($i == 1) echo 'is-week-2'; ?>">
                    <div class="week-dates-wrapper">
                        <h4>
                            <?php
                            if ($i > -44){
                                ?>
                                <a href="#" class="is-week-clicker is-week-click-left">&lt;</a>
                                <?php
                            }
                            ?>
                            <?php echo date('F d',strtotime('Monday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?> -
                            <?php echo date('F d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400  + $i*7*86400 ); ?>
                            <?php
                            if ($i < 1){
                                ?>
                                <a href="#" class="is-week-clicker is-week-click-right">&gt;</a>
                                <?php
                            }
                            ?>
                        </h4>
                    </div>
                    <?php
                    if ($i >= 0){

                        //////////////////////////////////////////////////////////////////////////////////////
                        //////////////////////////////////////////////////////////////////////////////////////
                        //////////////////////////////////////////////////////////////////////////////////////
                        //////////////////////////////////////////////////////////////////////////////////////
                        ///
                        ///
                        ///
                        ///
                        $is_today_planned = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='day_planned' 
                            AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ((($is_today_N > 1) && ($i == 0)) || $is_today_planned){
                                                    $s_stats[$i]['task_all'] = 0;
                                                    $s_stats[$i]['task_completed'] = 0;
                                                    $s_stats[$i]['focus_all'] = 0;
                                                    $s_stats[$i]['focus_completed'] = 0;

                                                    $tasks_counter = 0;
                                                    $tasks_counter_curr = 0;
                                                    $rows_daily_focus_day = $wpdb->get_results("
                                                        SELECT * FROM ".$wpdb->prefix."habit_data 
                                                        WHERE user_id=".get_current_user_id()." 
                                                        AND type='daily_focus' 
                                                        AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                                                        ORDER BY number ASC
                                                    ");
                                                    if ($rows_daily_focus_day){
                                                        $f_have_focus[$i][1] = date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                                                        foreach ($rows_daily_focus_day as $key=> $row){
                                                            $date_created = $row->date_created;
                                                            if ($date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                                $tasks_counter++;
                                                                $s_stats[$i]['focus_all']++;
                                                                if ($row->completed == 1){
                                                                    $tasks_counter_curr++;
                                                                    $s_stats[$i]['focus_completed']++;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    $together_counter = 0;
                                                    $together_counter_curr = 0;
                                                    $day_actions = $wpdb->get_results("
                                                        SELECT * FROM ".$wpdb->prefix."habit_data 
                                                        WHERE user_id=".get_current_user_id()." 
                                                        AND type='daily_action' 
                                                        AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                                                        ORDER BY number ASC
                                                    ");

                                                    if ($day_actions){
                                                        foreach ($day_actions as $key=> $row){
                                                            $date_created = $row->date_created;
                                                            if ($date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                                $together_counter++;
                                                                $s_stats[$i]['task_all']++;
                                                                if ($row->completed == 1){
                                                                    $together_counter_curr++;
                                                                    $s_stats[$i]['task_completed']++;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    foreach ($rows_tasks1 as $key=> $row){
                                                        $task_date_created = $row->date_created;
                                                        if ($task_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                            $together_counter++;
                                                            $s_stats[$i]['task_all']++;
                                                            if ($row->completed == 1){
                                                                $together_counter_curr++;
                                                                $s_stats[$i]['task_completed']++;
                                                            }
                                                        }
                                                    }
                                                    ?>
                                                    <div class="week-day week-day-monday prev-day
                                                    <?php
                                                    if ($tasks_counter_curr !== $tasks_counter)
                                                    {
                                                        echo ' not-all-focus ';
                                                        $c_counter[$i]['not_finished']++;
                                                    }
                                                    else{
                                                        if ($tasks_counter > 0){
                                                            if ($together_counter == 0){
                                                                echo ' perfect-day ';
                                                                $c_counter[$i]['perfect']++;
                                                            }
                                                            elseif ($together_counter_curr !== $together_counter){
                                                                echo ' good-day ';
                                                                $c_counter[$i]['good']++;
                                                            }
                                                            elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                                                echo ' perfect-day ';
                                                                $c_counter[$i]['perfect']++;
                                                            }
                                                        }
                                                    }
                                                    ?>"
                                                         data-date="<?php echo date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400); ?>">
                                                        <h4>Monday <?php echo date('d',strtotime('Monday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                                        <div class="week-day-inside-wrapper">
                                                            <div class="week-action-wrapper">
                                                                <?php
                                                                if ($rows_daily_focus_day){
                                                                    foreach ($rows_daily_focus_day as $key=> $row){
                                                                        $focus_date_created = $row->date_created;
                                                                        if ($focus_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                                            ?>
                                                                            <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                                                <span><?php echo $row->text; ?></span>
                                                                                <button></button>
                                                                            </div>
                                                                            <?php
                                                                        }
                                                                    }
                                                                }

                                                                if ($rows_tasks1){
                                                                    foreach ($rows_tasks1 as $key=> $row){
                                                                        $task_date_created = $row->date_created;
                                                                        if ($task_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                                            ?>
                                                                            <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                                                <span><?php echo $row->text; ?></span>
                                                                                <button></button>
                                                                            </div>
                                                                            <?php
                                                                            unset($rows_tasks1[$key]);
                                                                        }
                                                                    }
                                                                }
                                                                if ($day_actions){
                                                                    foreach ($day_actions as $key=> $row){
                                                                        $date_created = $row->date_created;
                                                                        if ($date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                                            ?>
                                                                            <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                                                <span><?php echo $row->text; ?></span>
                                                                                <button></button>
                                                                            </div>
                                                                            <?php
                                                                        }
                                                                    }
                                                                }
                                                                ?>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <?php
                        }
                        else {
                                                $rows_daily_focus_day = $wpdb->get_results("
                                                    SELECT * FROM ".$wpdb->prefix."habit_data 
                                                    WHERE user_id=".get_current_user_id()." 
                                                    AND type='daily_focus' 
                                                    AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                                                    ORDER BY number ASC
                                                ");

                                                $have_focus_class = '';
                                                if ($rows_daily_focus_day){
                                                    $have_focus_class = ' have-focus ';
                                                }

                                                ?>
                                                <div class="week-day week-day-monday
                                                <?php echo $have_focus_class; ?> <?php if ((($is_tomorrow == 1) && ($i == 0)) || (($is_tomorrow == 8) && ($i == 1))) echo 'is-tomorrow'; ?>"
                                                     data-date="<?php echo date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400); ?>">
                                                    <h4>Monday <?php echo date('d',strtotime('Monday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                                    <div class="week-day-inside-wrapper">
                                                        <div class="week-action-wrapper">
                                                            <?php
                                                            if ($rows_tasks1){
                                                                foreach ($rows_tasks1 as $key=> $row){
                                                                    $task_date_created = $row->date_created;
                                                                    if ($task_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                                        ?>
                                                                        <div class="week-action-inside is-filled" data-number="<?php echo $row->number; ?>">
                                                                            <textarea class="week-action-textarea" readonly><?php echo $row->text; ?></textarea>
                                                                            <a href="#" class="remove-input">x</a>
                                                                        </div>
                                                                        <?php
                                                                        unset($rows_tasks1[$key]);
                                                                    }
                                                                }
                                                            }
                                                            ?>
                                                            <a href="#" class="add-week-task"><span>+</span> Add Task</a>
                                                        </div>
                                                        <div class="week-appointment-wrapper">
                                                            <?php
                                                            if ($rows_appointments){
                                                                foreach ($rows_appointments as $key=> $row){
                                                                    $appointment_date_created = $row->date_created;
                                                                    if ($appointment_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                                        $appointment_action_time = $row->action_time;
                                                                        $time_type = '';
                                                                        if (strpos($appointment_action_time, 'am') !== false) {
                                                                            $time_type = 'am';
                                                                        }
                                                                        elseif(strpos($appointment_action_time, 'pm') !== false){
                                                                            $time_type = 'pm';
                                                                        }
                                                                        $appointment_action_time = str_replace(array('am','pm'),'',$appointment_action_time);
                                                                        $time_arr = explode(':',$appointment_action_time);
                                                                        ?>
                                                                        <div class="week-appointment-inside" data-number="<?php echo $row->number; ?>">
                                                                            <input readonly type="text" value="<?php echo $row->text; ?>">
                                                                            <span class="time-input-wrapper">
                                                                        <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                                    </span>
                                                                            <a href="#" class="remove-input">x</a>
                                                                        </div>
                                                                        <?php
                                                                        unset($rows_appointments[$key]);
                                                                    }
                                                                }
                                                            }
                                                            ?>
                                                            <a href="#" class="add-week-appointment"><span>+</span> Add Appointment</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <?php
                        }

                        $is_today_planned = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='day_planned' 
                            AND date_created='".date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ((($is_today_N > 2) && ($i == 0)) || $is_today_planned){
                            $tasks_counter = 0;
                            $tasks_counter_curr = 0;
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            if ($rows_daily_focus_day){
                                $f_have_focus[$i][2] = date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                                foreach ($rows_daily_focus_day as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $tasks_counter++;
                                        $s_stats[$i]['focus_all']++;
                                        if ($row->completed == 1){
                                            $tasks_counter_curr++;
                                            $s_stats[$i]['focus_completed']++;
                                        }
                                    }
                                }
                            }
                            $together_counter = 0;
                            $together_counter_curr = 0;
                            $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                            if ($day_actions){
                                foreach ($day_actions as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $together_counter++;
                                        $s_stats[$i]['task_all']++;
                                        if ($row->completed == 1){
                                            $together_counter_curr++;
                                            $s_stats[$i]['task_completed']++;
                                        }
                                    }
                                }
                            }
                            foreach ($rows_tasks1 as $key=> $row){
                                $task_date_created = $row->date_created;
                                if ($task_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                            ?>
                            <div class="week-day week-day-tuesday  prev-day
                        <?php
                            if ($tasks_counter_curr !== $tasks_counter)
                            {
                                echo ' not-all-focus ';
                                $c_counter[$i]['not_finished']++;
                            }
                            else{
                                if ($tasks_counter > 0){
                                    if ($together_counter == 0){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                    elseif ($together_counter_curr !== $together_counter){
                                        echo ' good-day ';
                                        $c_counter[$i]['good']++;
                                    }
                                    elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                }
                            }
                            ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Tuesday <?php echo date('d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_daily_focus_day){
                                            foreach ($rows_daily_focus_day as $key=> $row){
                                                $focus_date_created = $row->date_created;
                                                if ($focus_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }

                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        if ($day_actions){
                                            foreach ($day_actions as $key=> $row){
                                                $date_created = $row->date_created;
                                                if ($date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }
                                        ?>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }
                        else{
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            $have_focus_class = '';
                            if ($rows_daily_focus_day){
                                $have_focus_class = ' have-focus ';
                            }
                            ?>
                            <div class="week-day week-day-tuesday <?php echo $have_focus_class; ?>  <?php if ($is_tomorrow == 2 && ($i == 0)) echo 'is-tomorrow'; ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Tuesday <?php echo date('d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-action-inside is-filled" data-number="<?php echo $row->number; ?>">
                                                        <textarea class="week-action-textarea" readonly><?php echo $row->text; ?></textarea>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-task"><span>+</span> Add Task</a>
                                    </div>
                                    <div class="week-appointment-wrapper">
                                        <?php
                                        if ($rows_appointments){
                                            foreach ($rows_appointments as $key=> $row){
                                                $appointment_date_created = $row->date_created;
                                                if ($appointment_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    $appointment_action_time = $row->action_time;
                                                    $time_type = '';
                                                    if (strpos($appointment_action_time, 'am') !== false) {
                                                        $time_type = 'am';
                                                    }
                                                    elseif(strpos($appointment_action_time, 'pm') !== false){
                                                        $time_type = 'pm';
                                                    }
                                                    $appointment_action_time = str_replace(array('am','pm'),'',$appointment_action_time);
                                                    $time_arr = explode(':',$appointment_action_time);
                                                    ?>
                                                    <div class="week-appointment-inside" data-number="<?php echo $row->number; ?>">
                                                        <input readonly type="text" value="<?php echo $row->text; ?>">
                                                        <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                </span>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_appointments[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-appointment"><span>+</span> Add Appointment</a>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }

                        $is_today_planned = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='day_planned' 
                            AND date_created='".date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ((($is_today_N > 3) && ($i == 0)) || $is_today_planned){
                            $tasks_counter = 0;
                            $tasks_counter_curr = 0;
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            if ($rows_daily_focus_day){
                                $f_have_focus[$i][3] = date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                                foreach ($rows_daily_focus_day as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $tasks_counter++;
                                        $s_stats[$i]['focus_all']++;
                                        if ($row->completed == 1){
                                            $tasks_counter_curr++;
                                            $s_stats[$i]['focus_completed']++;
                                        }
                                    }
                                }
                            }
                            $together_counter = 0;
                            $together_counter_curr = 0;
                            $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                            if ($day_actions){
                                foreach ($day_actions as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $together_counter++;
                                        $s_stats[$i]['task_all']++;
                                        if ($row->completed == 1){
                                            $together_counter_curr++;
                                            $s_stats[$i]['task_completed']++;
                                        }
                                    }
                                }
                            }
                            foreach ($rows_tasks1 as $key=> $row){
                                $task_date_created = $row->date_created;
                                if ($task_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                            ?>
                            <div class="week-day week-day-wednesday  prev-day
                        <?php
                            if ($tasks_counter_curr !== $tasks_counter)
                            {
                                echo ' not-all-focus ';
                                $c_counter[$i]['not_finished']++;
                            }
                            else{
                                if ($tasks_counter > 0){
                                    if ($together_counter == 0){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                    elseif ($together_counter_curr !== $together_counter){
                                        echo ' good-day ';
                                        $c_counter[$i]['good']++;
                                    }
                                    elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                }
                            }
                            ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Wednesday <?php echo date('d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_daily_focus_day){
                                            foreach ($rows_daily_focus_day as $key=> $row){
                                                $focus_date_created = $row->date_created;
                                                if ($focus_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }

                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        if ($day_actions){
                                            foreach ($day_actions as $key=> $row){
                                                $date_created = $row->date_created;
                                                if ($date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }
                                        ?>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }
                        else{
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            $have_focus_class = '';
                            if ($rows_daily_focus_day){
                                $have_focus_class = ' have-focus ';
                            }
                            ?>
                            <div class="week-day week-day-wednesday <?php echo $have_focus_class; ?>  <?php if ($is_tomorrow == 3 && ($i == 0)) echo 'is-tomorrow'; ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Wednesday <?php echo date('d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-action-inside is-filled" data-number="<?php echo $row->number; ?>">
                                                        <textarea class="week-action-textarea" readonly><?php echo $row->text; ?></textarea>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-task"><span>+</span> Add Task</a>
                                    </div>
                                    <div class="week-appointment-wrapper">
                                        <?php
                                        if ($rows_appointments){
                                            foreach ($rows_appointments as $key=> $row){
                                                $appointment_date_created = $row->date_created;
                                                if ($appointment_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    $appointment_action_time = $row->action_time;
                                                    $time_type = '';
                                                    if (strpos($appointment_action_time, 'am') !== false) {
                                                        $time_type = 'am';
                                                    }
                                                    elseif(strpos($appointment_action_time, 'pm') !== false){
                                                        $time_type = 'pm';
                                                    }
                                                    $appointment_action_time = str_replace(array('am','pm'),'',$appointment_action_time);
                                                    $time_arr = explode(':',$appointment_action_time);
                                                    ?>
                                                    <div class="week-appointment-inside" data-number="<?php echo $row->number; ?>">
                                                        <input readonly type="text" value="<?php echo $row->text; ?>">
                                                        <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                </span>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_appointments[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-appointment"><span>+</span> Add Appointment</a>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }

                        $is_today_planned = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='day_planned' 
                            AND date_created='".date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ((($is_today_N > 4) && ($i == 0)) || $is_today_planned){
                            $tasks_counter = 0;
                            $tasks_counter_curr = 0;
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            if ($rows_daily_focus_day){
                                $f_have_focus[$i][4] = date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                                foreach ($rows_daily_focus_day as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $tasks_counter++;
                                        $s_stats[$i]['focus_all']++;
                                        if ($row->completed == 1){
                                            $tasks_counter_curr++;
                                            $s_stats[$i]['focus_completed']++;
                                        }
                                    }
                                }
                            }
                            $together_counter = 0;
                            $together_counter_curr = 0;
                            $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                            if ($day_actions){
                                foreach ($day_actions as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $together_counter++;
                                        $s_stats[$i]['task_all']++;
                                        if ($row->completed == 1){
                                            $together_counter_curr++;
                                            $s_stats[$i]['task_completed']++;
                                        }
                                    }
                                }
                            }
                            foreach ($rows_tasks1 as $key=> $row){
                                $task_date_created = $row->date_created;
                                if ($task_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                            ?>
                            <div class="week-day week-day-thursday  prev-day
                        <?php
                            if ($tasks_counter_curr !== $tasks_counter)
                            {
                                echo ' not-all-focus ';
                                $c_counter[$i]['not_finished']++;
                            }
                            else{
                                if ($tasks_counter > 0){
                                    if ($together_counter == 0){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                    elseif ($together_counter_curr !== $together_counter){
                                        echo ' good-day ';
                                        $c_counter[$i]['good']++;
                                    }
                                    elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                }
                            }
                            ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Thursday <?php echo date('d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_daily_focus_day){
                                            foreach ($rows_daily_focus_day as $key=> $row){
                                                $focus_date_created = $row->date_created;
                                                if ($focus_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }

                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        if ($day_actions){
                                            foreach ($day_actions as $key=> $row){
                                                $date_created = $row->date_created;
                                                if ($date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }
                                        ?>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }
                        else{
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            $have_focus_class = '';
                            if ($rows_daily_focus_day){
                                $have_focus_class = ' have-focus ';
                            }
                            ?>
                            <div class="week-day week-day-thursday <?php echo $have_focus_class; ?>  <?php if ($is_tomorrow == 4 && ($i == 0)) echo 'is-tomorrow'; ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Thursday <?php echo date('d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-action-inside is-filled" data-number="<?php echo $row->number; ?>">
                                                        <textarea class="week-action-textarea" readonly><?php echo $row->text; ?></textarea>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-task"><span>+</span> Add Task</a>
                                    </div>
                                    <div class="week-appointment-wrapper">
                                        <?php
                                        if ($rows_appointments){
                                            foreach ($rows_appointments as $key=> $row){
                                                $appointment_date_created = $row->date_created;
                                                if ($appointment_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    $appointment_action_time = $row->action_time;
                                                    $time_type = '';
                                                    if (strpos($appointment_action_time, 'am') !== false) {
                                                        $time_type = 'am';
                                                    }
                                                    elseif(strpos($appointment_action_time, 'pm') !== false){
                                                        $time_type = 'pm';
                                                    }
                                                    $appointment_action_time = str_replace(array('am','pm'),'',$appointment_action_time);
                                                    $time_arr = explode(':',$appointment_action_time);
                                                    ?>
                                                    <div class="week-appointment-inside" data-number="<?php echo $row->number; ?>">
                                                        <input readonly type="text" value="<?php echo $row->text; ?>">
                                                        <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                </span>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_appointments[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-appointment"><span>+</span> Add Appointment</a>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }

                        $is_today_planned = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='day_planned' 
                            AND date_created='".date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ((($is_today_N > 5) && ($i == 0)) || $is_today_planned){
                            $tasks_counter = 0;
                            $tasks_counter_curr = 0;
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            if ($rows_daily_focus_day){
                                $f_have_focus[$i][5] = date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                                foreach ($rows_daily_focus_day as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $tasks_counter++;
                                        $s_stats[$i]['focus_all']++;
                                        if ($row->completed == 1){
                                            $tasks_counter_curr++;
                                            $s_stats[$i]['focus_completed']++;
                                        }
                                    }
                                }
                            }
                            $together_counter = 0;
                            $together_counter_curr = 0;
                            $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                            if ($day_actions){
                                foreach ($day_actions as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $together_counter++;
                                        $s_stats[$i]['task_all']++;
                                        if ($row->completed == 1){
                                            $together_counter_curr++;
                                            $s_stats[$i]['task_completed']++;
                                        }
                                    }
                                }
                            }
                            foreach ($rows_tasks1 as $key=> $row){
                                $task_date_created = $row->date_created;
                                if ($task_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                            ?>
                            <div class="week-day week-day-friday  prev-day
                        <?php
                            if ($tasks_counter_curr !== $tasks_counter)
                            {
                                echo ' not-all-focus ';
                                $c_counter[$i]['not_finished']++;
                            }
                            else{
                                if ($tasks_counter > 0){
                                    if ($together_counter == 0){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                    elseif ($together_counter_curr !== $together_counter){
                                        echo ' good-day ';
                                        $c_counter[$i]['good']++;
                                    }
                                    elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                }
                            }
                            ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Friday <?php echo date('d',strtotime('Friday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_daily_focus_day){
                                            foreach ($rows_daily_focus_day as $key=> $row){
                                                $focus_date_created = $row->date_created;
                                                if ($focus_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }

                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        if ($day_actions){
                                            foreach ($day_actions as $key=> $row){
                                                $date_created = $row->date_created;
                                                if ($date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }
                                        ?>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }
                        else{
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            $have_focus_class = '';
                            if ($rows_daily_focus_day){
                                $have_focus_class = ' have-focus ';
                            }
                            ?>
                            <div class="week-day week-day-friday <?php echo $have_focus_class; ?>  <?php if ($is_tomorrow == 5 && ($i == 0)) echo 'is-tomorrow'; ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Friday <?php echo date('d',strtotime('Friday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-action-inside is-filled" data-number="<?php echo $row->number; ?>">
                                                        <textarea class="week-action-textarea" readonly><?php echo $row->text; ?></textarea>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-task"><span>+</span> Add Task</a>
                                    </div>
                                    <div class="week-appointment-wrapper">
                                        <?php
                                        if ($rows_appointments){
                                            foreach ($rows_appointments as $key=> $row){
                                                $appointment_date_created = $row->date_created;
                                                if ($appointment_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    $appointment_action_time = $row->action_time;
                                                    $time_type = '';
                                                    if (strpos($appointment_action_time, 'am') !== false) {
                                                        $time_type = 'am';
                                                    }
                                                    elseif(strpos($appointment_action_time, 'pm') !== false){
                                                        $time_type = 'pm';
                                                    }
                                                    $appointment_action_time = str_replace(array('am','pm'),'',$appointment_action_time);
                                                    $time_arr = explode(':',$appointment_action_time);
                                                    ?>
                                                    <div class="week-appointment-inside" data-number="<?php echo $row->number; ?>">
                                                        <input readonly type="text" value="<?php echo $row->text; ?>">
                                                        <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                </span>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_appointments[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-appointment"><span>+</span> Add Appointment</a>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }

                        $is_today_planned = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='day_planned' 
                            AND date_created='".date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ((($is_today_N > 6) && ($i == 0)) || $is_today_planned){
                            $tasks_counter = 0;
                            $tasks_counter_curr = 0;
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            if ($rows_daily_focus_day){
                                $f_have_focus[$i][6] = date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                                foreach ($rows_daily_focus_day as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $tasks_counter++;
                                        $s_stats[$i]['focus_all']++;
                                        if ($row->completed == 1){
                                            $tasks_counter_curr++;
                                            $s_stats[$i]['focus_completed']++;
                                        }
                                    }
                                }
                            }
                            $together_counter = 0;
                            $together_counter_curr = 0;
                            $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                            if ($day_actions){
                                foreach ($day_actions as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $together_counter++;
                                        $s_stats[$i]['task_all']++;
                                        if ($row->completed == 1){
                                            $together_counter_curr++;
                                            $s_stats[$i]['task_completed']++;
                                        }
                                    }
                                }
                            }
                            foreach ($rows_tasks1 as $key=> $row){
                                $task_date_created = $row->date_created;
                                if ($task_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                            ?>
                            <div class="week-day week-day-saturday  prev-day
                        <?php
                            if ($tasks_counter_curr !== $tasks_counter)
                            {
                                echo ' not-all-focus ';
                                $c_counter[$i]['not_finished']++;
                            }
                            else{
                                if ($tasks_counter > 0){
                                    if ($together_counter == 0){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                    elseif ($together_counter_curr !== $together_counter){
                                        echo ' good-day ';
                                        $c_counter[$i]['good']++;
                                    }
                                    elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                }
                            }
                            ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Saturday <?php echo date('d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_daily_focus_day){
                                            foreach ($rows_daily_focus_day as $key=> $row){
                                                $focus_date_created = $row->date_created;
                                                if ($focus_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }

                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        if ($day_actions){
                                            foreach ($day_actions as $key=> $row){
                                                $date_created = $row->date_created;
                                                if ($date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }
                                        ?>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }
                        else{
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            $have_focus_class = '';
                            if ($rows_daily_focus_day){
                                $have_focus_class = ' have-focus ';
                            }
                            ?>
                            <div class="week-day week-day-saturday <?php echo $have_focus_class; ?>  <?php if ($is_tomorrow == 6 && ($i == 0)) echo 'is-tomorrow'; ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Saturday <?php echo date('d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-action-inside is-filled" data-number="<?php echo $row->number; ?>">
                                                        <textarea class="week-action-textarea" readonly><?php echo $row->text; ?></textarea>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-task"><span>+</span> Add Task</a>
                                    </div>
                                    <div class="week-appointment-wrapper">
                                        <?php
                                        if ($rows_appointments){
                                            foreach ($rows_appointments as $key=> $row){
                                                $appointment_date_created = $row->date_created;
                                                if ($appointment_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    $appointment_action_time = $row->action_time;
                                                    $time_type = '';
                                                    if (strpos($appointment_action_time, 'am') !== false) {
                                                        $time_type = 'am';
                                                    }
                                                    elseif(strpos($appointment_action_time, 'pm') !== false){
                                                        $time_type = 'pm';
                                                    }
                                                    $appointment_action_time = str_replace(array('am','pm'),'',$appointment_action_time);
                                                    $time_arr = explode(':',$appointment_action_time);
                                                    ?>
                                                    <div class="week-appointment-inside" data-number="<?php echo $row->number; ?>">
                                                        <input readonly type="text" value="<?php echo $row->text; ?>">
                                                        <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                </span>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_appointments[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-appointment"><span>+</span> Add Appointment</a>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }



                        $is_today_planned = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='day_planned' 
                            AND date_created='".date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($is_today_planned){
                            $tasks_counter = 0;
                            $tasks_counter_curr = 0;
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            if ($rows_daily_focus_day){
                                $f_have_focus[$i][6] = date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                                foreach ($rows_daily_focus_day as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $tasks_counter++;
                                        $s_stats[$i]['focus_all']++;
                                        if ($row->completed == 1){
                                            $tasks_counter_curr++;
                                            $s_stats[$i]['focus_completed']++;
                                        }
                                    }
                                }
                            }
                            $together_counter = 0;
                            $together_counter_curr = 0;
                            $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                            if ($day_actions){
                                foreach ($day_actions as $key=> $row){
                                    $date_created = $row->date_created;
                                    if ($date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                        $together_counter++;
                                        $s_stats[$i]['task_all']++;
                                        if ($row->completed == 1){
                                            $together_counter_curr++;
                                            $s_stats[$i]['task_completed']++;
                                        }
                                    }
                                }
                            }
                            foreach ($rows_tasks1 as $key=> $row){
                                $task_date_created = $row->date_created;
                                if ($task_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                            ?>
                            <div class="week-day week-day-sunday  prev-day
                        <?php
                            if ($tasks_counter_curr !== $tasks_counter)
                            {
                                echo ' not-all-focus ';
                                $c_counter[$i]['not_finished']++;
                            }
                            else{
                                if ($tasks_counter > 0){
                                    if ($together_counter == 0){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                    elseif ($together_counter_curr !== $together_counter){
                                        echo ' good-day ';
                                        $c_counter[$i]['good']++;
                                    }
                                    elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                        echo ' perfect-day ';
                                        $c_counter[$i]['perfect']++;
                                    }
                                }
                            }
                            ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Saturday <?php echo date('d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_daily_focus_day){
                                            foreach ($rows_daily_focus_day as $key=> $row){
                                                $focus_date_created = $row->date_created;
                                                if ($focus_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }

                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        if ($day_actions){
                                            foreach ($day_actions as $key=> $row){
                                                $date_created = $row->date_created;
                                                if ($date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                        <span><?php echo $row->text; ?></span>
                                                        <button></button>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                        }
                                        ?>
                                    </div>
                                </div>
                            </div>
                            <?php
                        }
                        else{
                            $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                            $have_focus_class = '';
                            if ($rows_daily_focus_day){
                                $have_focus_class = ' have-focus ';
                            }
                            ?>
                            <div class="week-day week-day-sunday <?php echo $have_focus_class; ?>  <?php if ($is_tomorrow == 7 && ($i == 0)) echo 'is-tomorrow'; ?>"
                                 data-date="<?php echo date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                                <h4>Sunday <?php echo date('d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                                <div class="week-day-inside-wrapper">
                                    <div class="week-action-wrapper">
                                        <?php
                                        if ($rows_tasks1){
                                            foreach ($rows_tasks1 as $key=> $row){
                                                $task_date_created = $row->date_created;
                                                if ($task_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    ?>
                                                    <div class="week-action-inside is-filled" data-number="<?php echo $row->number; ?>">
                                                        <textarea class="week-action-textarea" readonly><?php echo $row->text; ?></textarea>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_tasks1[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-task"><span>+</span> Add Task</a>
                                    </div>
                                    <div class="week-appointment-wrapper">
                                        <?php
                                        if ($rows_appointments){
                                            foreach ($rows_appointments as $key=> $row){
                                                $appointment_date_created = $row->date_created;
                                                if ($appointment_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                    $appointment_action_time = $row->action_time;
                                                    $time_type = '';
                                                    if (strpos($appointment_action_time, 'am') !== false) {
                                                        $time_type = 'am';
                                                    }
                                                    elseif(strpos($appointment_action_time, 'pm') !== false){
                                                        $time_type = 'pm';
                                                    }
                                                    $appointment_action_time = str_replace(array('am','pm'),'',$appointment_action_time);
                                                    $time_arr = explode(':',$appointment_action_time);
                                                    ?>
                                                    <div class="week-appointment-inside" data-number="<?php echo $row->number; ?>">
                                                        <input readonly type="text" value="<?php echo $row->text; ?>">
                                                        <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                </span>
                                                        <a href="#" class="remove-input">x</a>
                                                    </div>
                                                    <?php
                                                    unset($rows_appointments[$key]);
                                                }
                                            }
                                        }
                                        ?>
                                        <a href="#" class="add-week-appointment"><span>+</span> Add Appointment</a>
                                    </div>
                                </div>
                            </div>

                            <?php
                        }

                        //////////////////////////////////////////////////////////////////////////////////////
                        //////////////////////////////////////////////////////////////////////////////////////
                        //////////////////////////////////////////////////////////////////////////////////////
                        //////////////////////////////////////////////////////////////////////////////////////



                    }
                    else{

                        $s_stats[$i]['task_all'] = 0;
                        $s_stats[$i]['task_completed'] = 0;
                        $s_stats[$i]['focus_all'] = 0;
                        $s_stats[$i]['focus_completed'] = 0;

                        $tasks_counter = 0;
                        $tasks_counter_curr = 0;
                        $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($rows_daily_focus_day){
                            $f_have_focus[$i][1] = date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                            foreach ($rows_daily_focus_day as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $tasks_counter++;
                                    $s_stats[$i]['focus_all']++;
                                    if ($row->completed == 1){
                                        $tasks_counter_curr++;
                                        $s_stats[$i]['focus_completed']++;
                                    }
                                }
                            }
                        }
                        $together_counter = 0;
                        $together_counter_curr = 0;
                        $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                        if ($day_actions){
                            foreach ($day_actions as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                        }
                        foreach ($rows_tasks1 as $key=> $row){
                            $task_date_created = $row->date_created;
                            if ($task_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                $together_counter++;
                                $s_stats[$i]['task_all']++;
                                if ($row->completed == 1){
                                    $together_counter_curr++;
                                    $s_stats[$i]['task_completed']++;
                                }
                            }
                        }
                        ?>
                        <div class="week-day week-day-monday
                        <?php
                        if ($tasks_counter_curr !== $tasks_counter)
                        {
                            echo ' not-all-focus ';
                            $c_counter[$i]['not_finished']++;
                        }
                        else{
                            if ($tasks_counter > 0){
                                if ($together_counter == 0){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                                elseif ($together_counter_curr !== $together_counter){
                                    echo ' good-day ';
                                    $c_counter[$i]['good']++;
                                }
                                elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                            }
                        }
                        ?>"
                             data-date="<?php echo date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400); ?>">
                            <h4>Monday <?php echo date('d',strtotime('Monday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                            <div class="week-day-inside-wrapper">
                                <div class="week-action-wrapper">
                                    <?php
                                    if ($rows_daily_focus_day){
                                        foreach ($rows_daily_focus_day as $key=> $row){
                                            $focus_date_created = $row->date_created;
                                            if ($focus_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }

                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    if ($day_actions){
                                        foreach ($day_actions as $key=> $row){
                                            $date_created = $row->date_created;
                                            if ($date_created == date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>
                        <?php
                        $tasks_counter = 0;
                        $tasks_counter_curr = 0;
                        $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($rows_daily_focus_day){
                            $f_have_focus[$i][2] = date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                            foreach ($rows_daily_focus_day as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $tasks_counter++;
                                    $s_stats[$i]['focus_all']++;
                                    if ($row->completed == 1){
                                        $tasks_counter_curr++;
                                        $s_stats[$i]['focus_completed']++;
                                    }
                                }
                            }
                        }
                        $together_counter = 0;
                        $together_counter_curr = 0;
                        $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                        if ($day_actions){
                            foreach ($day_actions as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                        }
                        foreach ($rows_tasks1 as $key=> $row){
                            $task_date_created = $row->date_created;
                            if ($task_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                $together_counter++;
                                $s_stats[$i]['task_all']++;
                                if ($row->completed == 1){
                                    $together_counter_curr++;
                                    $s_stats[$i]['task_completed']++;
                                }
                            }
                        }
                        ?>
                        <div class="week-day week-day-tuesday
                        <?php
                        if ($tasks_counter_curr !== $tasks_counter)
                        {
                            echo ' not-all-focus ';
                            $c_counter[$i]['not_finished']++;
                        }
                        else{
                            if ($tasks_counter > 0){
                                if ($together_counter == 0){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                                elseif ($together_counter_curr !== $together_counter){
                                    echo ' good-day ';
                                    $c_counter[$i]['good']++;
                                }
                                elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                            }
                        }
                        ?>"
                             data-date="<?php echo date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                            <h4>Tuesday <?php echo date('d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                            <div class="week-day-inside-wrapper">
                                <div class="week-action-wrapper">
                                    <?php
                                    if ($rows_daily_focus_day){
                                        foreach ($rows_daily_focus_day as $key=> $row){
                                            $focus_date_created = $row->date_created;
                                            if ($focus_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }

                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    if ($day_actions){
                                        foreach ($day_actions as $key=> $row){
                                            $date_created = $row->date_created;
                                            if ($date_created == date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>
                        <?php
                        $tasks_counter = 0;
                        $tasks_counter_curr = 0;
                        $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($rows_daily_focus_day){
                            $f_have_focus[$i][3] = date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                            foreach ($rows_daily_focus_day as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $tasks_counter++;
                                    $s_stats[$i]['focus_all']++;
                                    if ($row->completed == 1){
                                        $tasks_counter_curr++;
                                        $s_stats[$i]['focus_completed']++;
                                    }
                                }
                            }
                        }
                        $together_counter = 0;
                        $together_counter_curr = 0;
                        $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                        if ($day_actions){
                            foreach ($day_actions as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                        }
                        foreach ($rows_tasks1 as $key=> $row){
                            $task_date_created = $row->date_created;
                            if ($task_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                $together_counter++;
                                $s_stats[$i]['task_all']++;
                                if ($row->completed == 1){
                                    $together_counter_curr++;
                                    $s_stats[$i]['task_completed']++;
                                }
                            }
                        }
                        ?>
                        <div class="week-day week-day-wednesday
                        <?php
                        if ($tasks_counter_curr !== $tasks_counter)
                        {
                            echo ' not-all-focus ';
                            $c_counter[$i]['not_finished']++;
                        }
                        else{
                            if ($tasks_counter > 0){
                                if ($together_counter == 0){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                                elseif ($together_counter_curr !== $together_counter){
                                    echo ' good-day ';
                                    $c_counter[$i]['good']++;
                                }
                                elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                            }
                        }
                        ?>"
                             data-date="<?php echo date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                            <h4>Wednesday <?php echo date('d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                            <div class="week-day-inside-wrapper">
                                <div class="week-action-wrapper">
                                    <?php
                                    if ($rows_daily_focus_day){
                                        foreach ($rows_daily_focus_day as $key=> $row){
                                            $focus_date_created = $row->date_created;
                                            if ($focus_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }

                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    if ($day_actions){
                                        foreach ($day_actions as $key=> $row){
                                            $date_created = $row->date_created;
                                            if ($date_created == date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>
                        <?php
                        $tasks_counter = 0;
                        $tasks_counter_curr = 0;
                        $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($rows_daily_focus_day){
                            $f_have_focus[$i][4] = date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                            foreach ($rows_daily_focus_day as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $tasks_counter++;
                                    $s_stats[$i]['focus_all']++;
                                    if ($row->completed == 1){
                                        $tasks_counter_curr++;
                                        $s_stats[$i]['focus_completed']++;
                                    }
                                }
                            }
                        }
                        $together_counter = 0;
                        $together_counter_curr = 0;
                        $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                        if ($day_actions){
                            foreach ($day_actions as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                        }
                        foreach ($rows_tasks1 as $key=> $row){
                            $task_date_created = $row->date_created;
                            if ($task_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                $together_counter++;
                                $s_stats[$i]['task_all']++;
                                if ($row->completed == 1){
                                    $together_counter_curr++;
                                    $s_stats[$i]['task_completed']++;
                                }
                            }
                        }
                        ?>
                        <div class="week-day week-day-thursday
                        <?php
                        if ($tasks_counter_curr !== $tasks_counter)
                        {
                            echo ' not-all-focus ';
                            $c_counter[$i]['not_finished']++;
                        }
                        else{
                            if ($tasks_counter > 0){
                                if ($together_counter == 0){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                                elseif ($together_counter_curr !== $together_counter){
                                    echo ' good-day ';
                                    $c_counter[$i]['good']++;
                                }
                                elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                            }
                        }
                        ?>"
                             data-date="<?php echo date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                            <h4>Thursday <?php echo date('d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                            <div class="week-day-inside-wrapper">
                                <div class="week-action-wrapper">
                                    <?php
                                    if ($rows_daily_focus_day){
                                        foreach ($rows_daily_focus_day as $key=> $row){
                                            $focus_date_created = $row->date_created;
                                            if ($focus_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }

                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    if ($day_actions){
                                        foreach ($day_actions as $key=> $row){
                                            $date_created = $row->date_created;
                                            if ($date_created == date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>
                        <?php
                        $tasks_counter = 0;
                        $tasks_counter_curr = 0;
                        $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($rows_daily_focus_day){
                            $f_have_focus[$i][5] = date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                            foreach ($rows_daily_focus_day as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $tasks_counter++;
                                    $s_stats[$i]['focus_all']++;
                                    if ($row->completed == 1){
                                        $tasks_counter_curr++;
                                        $s_stats[$i]['focus_completed']++;
                                    }
                                }
                            }
                        }
                        $together_counter = 0;
                        $together_counter_curr = 0;
                        $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                        if ($day_actions){
                            foreach ($day_actions as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                        }
                        foreach ($rows_tasks1 as $key=> $row){
                            $task_date_created = $row->date_created;
                            if ($task_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                $together_counter++;
                                $s_stats[$i]['task_all']++;
                                if ($row->completed == 1){
                                    $together_counter_curr++;
                                    $s_stats[$i]['task_completed']++;
                                }
                            }
                        }
                        ?>
                        <div class="week-day week-day-friday
                        <?php
                        if ($tasks_counter_curr !== $tasks_counter)
                        {
                            echo ' not-all-focus ';
                            $c_counter[$i]['not_finished']++;
                        }
                        else{
                            if ($tasks_counter > 0){
                                if ($together_counter == 0){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                                elseif ($together_counter_curr !== $together_counter){
                                    echo ' good-day ';
                                    $c_counter[$i]['good']++;
                                }
                                elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                            }
                        }
                        ?>"
                             data-date="<?php echo date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                            <h4>Friday <?php echo date('d',strtotime('Friday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                            <div class="week-day-inside-wrapper">
                                <div class="week-action-wrapper">
                                    <?php
                                    if ($rows_daily_focus_day){
                                        foreach ($rows_daily_focus_day as $key=> $row){
                                            $focus_date_created = $row->date_created;
                                            if ($focus_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }

                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    if ($day_actions){
                                        foreach ($day_actions as $key=> $row){
                                            $date_created = $row->date_created;
                                            if ($date_created == date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>
                        <?php
                        $tasks_counter = 0;
                        $tasks_counter_curr = 0;
                        $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($rows_daily_focus_day){
                            $f_have_focus[$i][6] = date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                            foreach ($rows_daily_focus_day as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $tasks_counter++;
                                    $s_stats[$i]['focus_all']++;
                                    if ($row->completed == 1){
                                        $tasks_counter_curr++;
                                        $s_stats[$i]['focus_completed']++;
                                    }
                                }
                            }
                        }
                        $together_counter = 0;
                        $together_counter_curr = 0;
                        $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                        if ($day_actions){
                            foreach ($day_actions as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                        }
                        foreach ($rows_tasks1 as $key=> $row){
                            $task_date_created = $row->date_created;
                            if ($task_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                $together_counter++;
                                $s_stats[$i]['task_all']++;
                                if ($row->completed == 1){
                                    $together_counter_curr++;
                                    $s_stats[$i]['task_completed']++;
                                }
                            }
                        }
                        ?>
                        <div class="week-day week-day-saturday
                        <?php
                        if ($tasks_counter_curr !== $tasks_counter)
                        {
                            echo ' not-all-focus ';
                            $c_counter[$i]['not_finished']++;
                        }
                        else{
                            if ($tasks_counter > 0){
                                if ($together_counter == 0){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                                elseif ($together_counter_curr !== $together_counter){
                                    echo ' good-day ';
                                    $c_counter[$i]['good']++;
                                }
                                elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                            }
                        }
                        ?>"
                             data-date="<?php echo date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                            <h4>Saturday <?php echo date('d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                            <div class="week-day-inside-wrapper">
                                <div class="week-action-wrapper">
                                    <?php
                                    if ($rows_daily_focus_day){
                                        foreach ($rows_daily_focus_day as $key=> $row){
                                            $focus_date_created = $row->date_created;
                                            if ($focus_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }

                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    if ($day_actions){
                                        foreach ($day_actions as $key=> $row){
                                            $date_created = $row->date_created;
                                            if ($date_created == date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>
                        <?php
                        $tasks_counter = 0;
                        $tasks_counter_curr = 0;
                        $rows_daily_focus_day = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_focus' 
                            AND date_created='".date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");
                        if ($rows_daily_focus_day){
                            $f_have_focus[$i][7] = date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);
                            foreach ($rows_daily_focus_day as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $tasks_counter++;
                                    $s_stats[$i]['focus_all']++;
                                    if ($row->completed == 1){
                                        $tasks_counter_curr++;
                                        $s_stats[$i]['focus_completed']++;
                                    }
                                }
                            }
                        }
                        $together_counter = 0;
                        $together_counter_curr = 0;
                        $day_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='daily_action' 
                            AND date_created='".date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                            ORDER BY number ASC
                        ");

                        if ($day_actions){
                            foreach ($day_actions as $key=> $row){
                                $date_created = $row->date_created;
                                if ($date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                    $together_counter++;
                                    $s_stats[$i]['task_all']++;
                                    if ($row->completed == 1){
                                        $together_counter_curr++;
                                        $s_stats[$i]['task_completed']++;
                                    }
                                }
                            }
                        }
                        foreach ($rows_tasks1 as $key=> $row){
                            $task_date_created = $row->date_created;
                            if ($task_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                $together_counter++;
                                $s_stats[$i]['task_all']++;
                                if ($row->completed == 1){
                                    $together_counter_curr++;
                                    $s_stats[$i]['task_completed']++;
                                }
                            }
                        }
                        ?>
                        <div class="week-day week-day-sunday
                        <?php
                        if ($tasks_counter_curr !== $tasks_counter)
                        {
                            echo ' not-all-focus ';
                            $c_counter[$i]['not_finished']++;
                        }
                        else{
                            if ($tasks_counter > 0){
                                if ($together_counter == 0){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                                elseif ($together_counter_curr !== $together_counter){
                                    echo ' good-day ';
                                    $c_counter[$i]['good']++;
                                }
                                elseif (($together_counter_curr == $together_counter) && ($together_counter > 0)){
                                    echo ' perfect-day ';
                                    $c_counter[$i]['perfect']++;
                                }
                            }
                        }
                        ?>"
                             data-date="<?php echo date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?>">
                            <h4>Sunday <?php echo date('d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400  + $i*7*86400); ?></h4>
                            <div class="week-day-inside-wrapper">
                                <div class="week-action-wrapper">
                                    <?php
                                    if ($rows_daily_focus_day){
                                        foreach ($rows_daily_focus_day as $key=> $row){
                                            $focus_date_created = $row->date_created;
                                            if ($focus_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item past-item-focus <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }

                                    if ($rows_tasks1){
                                        foreach ($rows_tasks1 as $key=> $row){
                                            $task_date_created = $row->date_created;
                                            if ($task_date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                                unset($rows_tasks1[$key]);
                                            }
                                        }
                                    }
                                    if ($day_actions){
                                        foreach ($day_actions as $key=> $row){
                                            $date_created = $row->date_created;
                                            if ($date_created == date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)){
                                                ?>
                                                <div class="week-past-item <?php echo $row->completed ? ' completed ' : ''; ?>">
                                                    <span><?php echo $row->text; ?></span>
                                                    <button></button>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>

                        <?php
                    }

                    ?>
                </div>
                <?php
            }
            ?>
            </div>

            <style>
                .add-week-goal{
                    display: none;
                }

                .is-completed-1 .this-week-goal-wrapper.is-week-1:hover .add-week-goal,
                .is-completed-1 .this-week-goal-wrapper.is-week-1:focus .add-week-goal,
                .is-completed-2 .this-week-goal-wrapper.is-week-2:hover .add-week-goal,
                .is-completed-2 .this-week-goal-wrapper.is-week-2:focus .add-week-goal{
                    display: inline;
                }

                .week-goal-textarea-wrapper{
                    position: relative;
                }

                .week-goal-textarea-wrapper .remove-input,
                .week-goal-textarea-wrapper .edit-input{
                    top: 7px;
                }

                .week-goal-textarea-wrapper textarea:focus {
                    border: 1px solid #777;
                    height: 42px;
                }

                .week-goal-textarea-wrapper textarea[readonly] {
                     height: 24px !important;
                    line-height: 18px;
                     border: 1px solid transparent !important;
                     overflow: hidden;
                 }

                .week-goal-textarea-wrapper .edit-input,
                .week-goal-textarea-wrapper .remove-input{
                    display: none !important;
                }

                .week-goal-textarea-wrapper.is-filled.is-hover .edit-input,
                .week-goal-textarea-wrapper.is-filled.is-hover .remove-input{
                    display: block !important;
                }
            </style>
            <div class="is-hidden-counter counter-appointments"><?php echo $number_appointments; ?></div>
            <?php
            $number_week_goals = 0;
            $number_daily_focus = 0;
            ?>
            <div class="week-sidebar">
                <style>
                    .top-badge-focus{
                        position: absolute;
                        display: none;
                        right: -48px;
                        top: 0;
                        width: 44px;
                        height: 44px;
                        background-size: contain;
                        background-position: center center;
                        background-repeat: no-repeat;
                        margin: 0 auto 5px;
                        background-image: url(/wp-content/plugins/habit-planner/assets/img2/focus-weeek.png);
                    }
                    .top-badge-perfect{
                        position: absolute;
                        display: none;
                        right: -49px;
                        top: 0;
                        width: 46px;
                        height: 46px;
                        background-size: contain;
                        background-position: center center;
                        background-repeat: no-repeat;
                        margin: 0 auto 5px;background-image: url(/wp-content/plugins/habit-planner/assets/img2/perfect-week.png);
                    }
                    .top-badge-focus.show,
                    .top-badge-perfect.show{
                        display: block;
                    }
                </style>
                <div class="top-badge-focus"></div>
                <div class="top-badge-perfect"></div>
                <button class="plan-your-week is-week-current is-week-1">Plan Your Week</button>
                <button class="plan-your-week is-week-2">Plan Your Week</button>
                <div>
                    <?php
                    for ($i = -44; $i <=1 ; $i++){
                        ?>
                        <div class="this-week-goal-wrapper
                        <?php if ($i < 0) echo 'is-week-previous'; ?>
                        <?php if ($i == 0) echo 'is-week-current'; ?>
                        <?php if ($i == 0) echo 'is-week-1'; ?>
                        <?php if ($i == 1) echo 'is-week-2'; ?>"
                        >
                            <h4>This Weeks Goal</h4>
                            <div class="is-wrapper">
                                <?php
                                $rows_week_goals = $wpdb->get_results("
                                        SELECT * FROM ".$wpdb->prefix."habit_data 
                                        WHERE user_id=".get_current_user_id()." 
                                        AND type='week_goal' 
                                        AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                                        ORDER BY number ASC
                                    ");
                                if ($rows_week_goals){
                                    foreach ($rows_week_goals as $goal){
                                        if ($goal->number > $number_week_goals){
                                            $number_week_goals = $goal->number;
                                        }
                                        ?>
                                        <div class="week-goal-textarea-wrapper is-filled" data-number="<?php echo $goal->number ; ?>">
                                            <textarea type="text" readonly=""><?php echo $goal->text; ?></textarea>
                                            <a href="#" class="edit-input"></a>
                                            <a href="#" class="remove-input">x</a>
                                        </div>
                                        <?php
                                    }
                                }
                                ?>
                            </div>
                            <a href="#" class="add-week-goal"><span>+</span> Add goal</a>
                        </div>
                        <?php
                    }
                    ?>
                </div>
                <style>
                    .week-daily-focus-headlines p{
                        display: none;
                        line-height: 1;
                        margin: 3px 0 6px 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 10px;
                        font-weight: 400;
                        text-align: left;
                        color: rgb(0 0 0 / 60%);
                    }

                    .week-daily-focus-headlines.is-routines p{
                        display: block;
                    }
                </style>
                <div>
                    <?php
                    for ($i = -44; $i <=1 ; $i++){
                        ?>
                        <div class="week-daily-focus-wrapper
                        <?php if ($i < 0) echo 'is-week-previous'; ?>
                        <?php if ($i == 0) echo 'is-week-current'; ?>
                        <?php if ($i == 0) echo 'is-week-1'; ?>
                        <?php if ($i == 1) echo 'is-week-2'; ?>"
                        >
                            <div class="week-daily-focus-headlines <?php  if ($user_routines) echo 'is-routines';?>">
                                <h4><?php  if ($user_routines) {echo 'Routines';}else{echo 'Daily Focus';}?></h4>
                                <?php
                                $rows_daily_focus = $wpdb->get_results("
                                        SELECT * FROM ".$wpdb->prefix."habit_data 
                                        WHERE user_id=".get_current_user_id()." 
                                        AND type='daily_focus_week' 
                                        AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400)."'
                                        ORDER BY number ASC
                                    ");
                                ?>
                                <p>Night</p>
                                <div class="week-night-wrapper">
                                    <?php
                                    if ($rows_daily_focus){
                                        foreach ($rows_daily_focus as $daily_focus){
                                            if ($daily_focus->number > $number_daily_focus){
                                                $number_daily_focus = $daily_focus->number;
                                            }
                                            $daily_focus_time = $daily_focus->action_time;
                                            $time_type = '';
                                            if (strpos($daily_focus_time, 'am') !== false) {
                                                $time_type = 'am';
                                            }
                                            elseif(strpos($daily_focus_time, 'pm') !== false){
                                                $time_type = 'pm';
                                            }
                                            $daily_focus_time = str_replace(array('am','pm'),'',$daily_focus_time);
                                            $time_arr = explode(':',$daily_focus_time);
                                            if ($user_routines && $time_type == 'pm'){
                                                ?>
                                                <div class="week-daily-focus-input-wrapper" data-number="<?php echo $daily_focus->number ; ?>">
                                                    <input type="text" readonly="" value="<?php echo $daily_focus->text; ?>">
                                                    <span class="main-span">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                    </span>
                                                </div>
                                                <?php
                                            }
                                        }
                                    }
                                    ?>
                                </div>
                                <p>Morning</p>
                                <div class="week-morning-wrapper">
                                    <?php
                                    if ($rows_daily_focus){
                                        foreach ($rows_daily_focus as $daily_focus){
                                            if ($daily_focus->number > $number_daily_focus){
                                                $number_daily_focus = $daily_focus->number;
                                            }
                                            $daily_focus_time = $daily_focus->action_time;
                                            $time_type = '';
                                            if (strpos($daily_focus_time, 'am') !== false) {
                                                $time_type = 'am';
                                            }
                                            elseif(strpos($daily_focus_time, 'pm') !== false){
                                                $time_type = 'pm';
                                            }
                                            $daily_focus_time = str_replace(array('am','pm'),'',$daily_focus_time);
                                            $time_arr = explode(':',$daily_focus_time);
                                            if ($user_routines){
                                                if ($time_type == 'am'){
                                                    ?>
                                                    <div class="week-daily-focus-input-wrapper" data-number="<?php echo $daily_focus->number ; ?>">
                                                        <input type="text" readonly="" value="<?php echo $daily_focus->text; ?>">
                                                        <span class="main-span">
                                                        <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                        </span>
                                                    </div>
                                                    <?php
                                                }
                                            }
                                            else{
                                                ?>
                                                <div class="week-daily-focus-input-wrapper" data-number="<?php echo $daily_focus->number ; ?>">
                                                    <input type="text" readonly="" value="<?php echo $daily_focus->text; ?>">
                                                    <span class="main-span">
                                                        <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                                        </span>
                                                </div>
                                                <?php
                                            }

                                        }
                                    }
                                    ?>
                                </div>
                            </div>
                        </div>
                        <?php
                    }
                    ?>
                </div>
                <style>
                    .past-week-results-circle{
                        width: 120px;
                        height: 120px;
                        border-radius: 50%;
                        background: transparent;
                        position: relative;
                        margin: 0 auto 20px !important;
                        display: block;
                        text-align: center;
                    }

                    .past-week-plan-circle{
                        position: absolute;
                        background: radial-gradient(50% 50% at 50% 50%, #ECD664 34.9%, rgba(255, 229, 94, 0.99) 61.74%, #DF8114 100%) /* warning: gradient uses a rotation that is not supported by CSS and may not behave as expected */;
                        width: 120px;
                        height: 120px;
                        left: 50%;
                        top: 50%;
                        transform: translate(-50%,-50%);
                        border-radius: 50%;
                    }

                    .past-week-plan-circle:before{
                        content: '';
                        display: block !important;
                        clear: both;
                        position: absolute;
                        width: calc(100% - 4px);
                        height: calc(100% - 4px);
                        top: 2px;
                        left: 2px;
                        border-radius: 50%;
                        z-index: 2;
                        background-color: #e6e6f5;
                    }

                    .past-week-plan-circle:after{
                        content: '';
                        display: block !important;
                        clear: both;
                        position: absolute;
                        width: calc(100% + 2px);
                        height: calc(100% + 2px);
                        top: -1px;
                        left: -1px;
                        background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
                        border-radius: 50%;
                        z-index: 1;
                    }

                    .past-week-tog-circle{
                        position: absolute;
                        background: radial-gradient(67% 67% at 49.32% 49.32%, #ADD3FF 0%, rgba(94, 139, 255, 0.99) 65.73%, #1434DF 72.64%);
                        width: 110px;
                        height: 110px;
                        left: 50%;
                        top: 50%;
                        transform: translate(-50%,-50%);
                        border-radius: 50%;
                    }
                    .past-week-tog-circle:before{
                        content: '';
                        display: block !important;
                        clear: both;
                        position: absolute;
                        width: calc(100% - 12px);
                        height: calc(100% - 12px);
                        top: 6px;
                        left: 6px;
                        border-radius: 50%;
                        z-index: 2;
                        background-color: #e6e6f5;
                    }
                    .past-week-tog-circle:after{
                        content: '';
                        display: block !important;
                        clear: both;
                        position: absolute;
                        width: calc(100% + 0px);
                        height: calc(100% + 0px);
                        top: 0;
                        left: 0;
                        background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
                        border-radius: 50%;
                        z-index: 1;
                    }

                    .past-week-fcs-circle{
                        position: absolute;
                        background: radial-gradient(60% 60% at 50% 50%, rgba(72, 123, 255, 0.99) 14.58%, #531DEB 59.9%, #A21AE2 94.79%);
                        width: 90px;
                        height: 90px;
                        left: 50%;
                        top: 50%;
                        transform: translate(-50%,-50%);
                        border-radius: 50%;
                        display: block;
                    }

                    .past-week-fcs-circle:before{
                        content: '';
                        display: block !important;
                        clear: both;
                        position: absolute;
                        width: calc(100% - 16px);
                        height: calc(100% - 16px);
                        top: 8px;
                        left: 8px;
                        border-radius: 50%;
                        z-index: 2;
                        background-color: #e6e6f5;
                    }
                    .past-week-fcs-circle:after{
                        content: '';
                        display: block !important;
                        clear: both;
                        position: absolute;
                        width: calc(100% + 0px);
                        height: calc(100% + 0px);
                        top: 0;
                        left: 0;
                        background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
                        border-radius: 50%;
                        z-index: 1;
                    }
                    .past-week-results-circle span {
                        color: #2B5DFF;
                        line-height: 120px;
                        margin: 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 24px;
                        font-weight: 500;
                        text-align: center;
                        position: relative;
                        z-index: 3;
                    }
                    .past-week-circles-wrapper{
                        margin: 0 -15px 10px !important;
                    }
                    .past-week-circles-wrapper:after{
                        content: '';
                        display: block;
                        clear: both;
                    }
                    .past-week-small-circle{
                        width: 25%;
                        float: left;
                        text-align: center;
                    }
                    .past-week-small-circle p {
                        display: block;
                        line-height: 1;
                        margin: 0 0 6px 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 8.5px;
                        font-weight: 400;
                        color: #000;
                    }
                    .past-week-small-circle-1:before,
                    .past-week-small-circle-2:before,
                    .past-week-small-circle-3:before,
                    .past-week-small-circle-4:before{
                        content: '';
                        display: block;
                        clear: both;
                        position: absolute;
                        width: calc(100% - 8px);
                        height: calc(100% - 8px);
                        top: 4px;
                        left: 4px;
                        background-color: #f0f0ff;
                        border-radius: 50%;
                        z-index: 2;
                    }
                    .past-week-small-circle-1:after,
                    .past-week-small-circle-2:after,
                    .past-week-small-circle-3:after,
                    .past-week-small-circle-4:after{
                        content: '';
                        display: block;
                        clear: both;
                        position: absolute;
                        width: calc(100%);
                        height: calc(100%);
                        top: 0;
                        left: 0;
                        background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
                        border-radius: 50%;
                        z-index: 1;
                    }
                    .past-week-small-circle-1{
                        width: 48px;
                        height: 48px;
                        border-radius: 50%;
                        background: transparent;
                        margin: 0 auto 5px;
                        --ratio: 0;
                        position: relative;
                        box-shadow: 0 2.72665px 2.72665px rgb(0 0 0 / 4%);
                        background: radial-gradient(60% 60% at 50% 50%, rgba(72, 123, 255, 0.99) 14.58%, #531DEB 59.9%, #A21AE2 94.79%);
                    }
                    .past-week-small-circle-2{
                        width: 48px;
                        height: 48px;
                        border-radius: 50%;
                        background: transparent;
                        margin: 0 auto 5px;
                        --ratio: 0;
                        position: relative;
                        box-shadow: 0 2.72665px 2.72665px rgb(0 0 0 / 4%);
                        background: radial-gradient(60% 60% at 50% 50%, #ADD3FF 34.9%, rgba(94, 139, 255, 0.99) 61.74%, #4D69FF 100%);
                    }
                    .past-week-small-circle-3{
                        width: 48px;
                        height: 48px;
                        border-radius: 50%;
                        background: transparent;
                        margin: 0 auto 5px;
                        --ratio: 0;
                        position: relative;
                        box-shadow: 0 2.72665px 2.72665px rgb(0 0 0 / 4%);
                        background: radial-gradient(60% 60% at 50% 50%, #ECD664 34.9%, rgba(255, 229, 94, 0.99) 61.74%, #DFB214 100%) ;
                    }
                    .past-week-small-circle-4{
                        width: 48px;
                        height: 48px;
                        border-radius: 50%;
                        background: transparent;
                        margin: 0 auto 5px;
                        --ratio: 0;
                        position: relative;
                        box-shadow: 0 2.72665px 2.72665px rgb(0 0 0 / 4%);
                        background: radial-gradient(60% 60% at 50% 50%, #ECD664 34.9%, rgba(255, 229, 94, 0.99) 61.74%, #DF8114 100%);
                    }

                    .past-week-small-circle-1 span{
                        line-height: 48px;
                        margin: 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 12px;
                        font-weight: 500;
                        text-align: center;
                        position: relative;
                        z-index: 3;
                        color: #531DEB;
                    }
                    .past-week-small-circle-2 span{
                        line-height: 48px;
                        margin: 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 12px;
                        font-weight: 500;
                        text-align: center;
                        position: relative;
                        z-index: 3;
                        color: #2B5DFF;
                    }
                    .past-week-small-circle-3 span{
                        line-height: 48px;
                        margin: 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 12px;
                        font-weight: 500;
                        text-align: center;
                        position: relative;
                        z-index: 3;
                        color: #DFB214;
                    }
                    .past-week-small-circle-4 span{
                        line-height: 48px;
                        margin: 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 12px;
                        font-weight: 500;
                        text-align: center;
                        position: relative;
                        z-index: 3;
                        color: #FFA31A;
                    }
                </style>
                <style>
                    .add-hide-it{
                        display: none;
                    }
                </style>
                <div>
                    <?php
                    $perf_stats = array();
                    for ($i = -44; $i <=1 ; $i++){
                        ?>
                        <div class="past-week-results
                        <?php if ($i < 0) echo 'is-week-previous'; ?>
                        <?php if ($i == 0) echo 'is-week-current'; ?>
                        <?php if ($i == 0) echo 'is-week-1'; ?>
                        <?php if ($i == 1) echo 'is-week-2'; ?>"
                        >
                            <?php
                            if ($s_stats[$i]['focus_all'] == 0){
                                $s_stats[$i]['focus_all_helper'] = 1;
                            }
                            else{
                                $s_stats[$i]['focus_all_helper'] = $s_stats[$i]['focus_all'];
                            }
                            if ($s_stats[$i]['task_all'] == 0){
                                $s_stats[$i]['task_all_helper'] = 1;
                            }
                            else{
                                $s_stats[$i]['task_all_helper'] = $s_stats[$i]['task_all'];
                            }

                            if ($s_stats[$i]['focus_all'] > 0){
                                $tgr_count = 0;
                                $plan_count = 0;
                                for ($jj = 1; $jj <=7; $jj++){
                                    if ($f_have_focus[$i][$jj] !== ''){
                                        $tgr_count++;
                                        $day_focus_planned = $wpdb->get_results("
                                            SELECT * FROM ".$wpdb->prefix."habit_data 
                                            WHERE user_id=".get_current_user_id()." 
                                            AND type='day_planned' 
                                            AND date_created='".$f_have_focus[$i][$jj]."'
                                            ORDER BY number ASC
                                        ");
                                        if ($day_focus_planned){
                                            $plan_count++;
                                        }
                                    }
                                }
                                $percent_daily_plan = round($plan_count / $tgr_count * 100);
                            }
                            else{
                                $percent_daily_plan = 0;
                            }

                            $percent_weekly_plan = 0;
                            $past_week_planned = $wpdb->get_results("
                                        SELECT * FROM ".$wpdb->prefix."habit_data 
                                        WHERE user_id=".get_current_user_id()." 
                                        AND type='week_planned' 
                                        AND date_created='".date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400 + 7*86400)."'
                                        ORDER BY number ASC
                                    ");
                            if ($past_week_planned){
                                if ( (strtotime($past_week_planned[0]->text) - strtotime($past_week_planned[0]->date_created) ) <= -86400)
                                {
                                    $percent_weekly_plan = 100;
                                }
                            }
                            else{
                                $percent_weekly_plan = 0;
                            }

                            $perf_stats[$i]['day'] = $percent_daily_plan;
                            $perf_stats[$i]['week'] = $percent_weekly_plan;
                            ?>
                            <div class="past-week-results-headlines">
                                <h4>Results</h4>
                                <div class="past-week-results-circle">
                                    <div class="past-week-plan-circle" style="--ratio:<?php echo $percent_weekly_plan / 100; ?>;"></div>
                                    <div class="past-week-tog-circle" style="--ratio: <?php echo $s_stats[$i]['task_completed'] / $s_stats[$i]['task_all_helper']; ?>;"></div>
                                    <div class="past-week-fcs-circle" style="--ratio: <?php echo $s_stats[$i]['focus_completed'] / $s_stats[$i]['focus_all_helper']; ?>;"></div>
                                    <span class="numbers"><?php
                                        echo round( ($percent_daily_plan + $percent_weekly_plan +
                                                round($s_stats[$i]['task_completed'] / $s_stats[$i]['task_all_helper'] * 100) +
                                                round($s_stats[$i]['focus_completed'] / $s_stats[$i]['focus_all_helper'] * 100)
                                            ) / 4);
                                        ?></span>
                                    <span>%</span>
                                </div>
                                <div class="past-week-circles-wrapper">
                                    <div class="past-week-small-circle">
                                        <div class="past-week-small-circle-1" style="--ratio: <?php echo $s_stats[$i]['focus_completed'] / $s_stats[$i]['focus_all_helper']; ?>">
                                            <span class="current"><?php echo $s_stats[$i]['focus_completed']; ?></span><span>/</span><span
                                                    class="all"><?php echo $s_stats[$i]['focus_all']; ?></span>
                                        </div>
                                        <p><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></p>
                                    </div>
                                    <div class="past-week-small-circle">
                                        <div class="past-week-small-circle-2" style="--ratio: <?php echo $s_stats[$i]['task_completed'] / $s_stats[$i]['task_all_helper']; ?>">
                                            <span><?php echo round($s_stats[$i]['task_completed'] / $s_stats[$i]['task_all_helper'] * 100); ?></span><span>%</span>
                                        </div>
                                        <p>Weeks Tasks</p>
                                    </div>
                                    <div class="past-week-small-circle">
                                        <div class="past-week-small-circle-3" style="--ratio: <?php echo $percent_daily_plan / 100; ?>">
                                            <span><?php echo $percent_daily_plan; ?></span><span>%</span>
                                        </div>
                                        <p>Daily Planning</p>
                                    </div>
                                    <div class="past-week-small-circle">
                                        <div class="past-week-small-circle-4" style="--ratio: <?php echo $percent_weekly_plan / 100; ?>">
                                            <span><?php echo $percent_weekly_plan; ?></span><span>%</span>
                                        </div>
                                        <p>Weeks Planning</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <?php
                    }
                    ?>
                </div>
                <style>
                    .past-week-badges-wrapper:after{
                        content: '';
                        display: block;
                        clear: both;
                    }

                    .past-week-badges-wrapper{
                        margin: 0 -15px;
                    }

                    .past-week-badges-wrapper .badge{
                        width: 46px;
                        height: 46px;
                        background-size: contain;
                        background-position: center center;
                        background-repeat: no-repeat;
                        margin: 0 auto 5px;
                    }

                    .past-week-badge-1,
                    .past-week-badge-2,
                    .past-week-badge-3,
                    .past-week-badge-4{
                        width: 25%;
                        float: left;
                    }

                    .past-week-badge-1 .badge{
                        background-image: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
                    }
                    .past-week-badge-2 .badge{
                        background-image: url(/wp-content/plugins/habit-planner/assets/img2/perfect-day.png);
                    }
                    .past-week-badge-3 .badge{
                        background-image: url(/wp-content/plugins/habit-planner/assets/img2/focus-weeek.png);
                    }
                    .past-week-badge-4 .badge{
                        background-image: url(/wp-content/plugins/habit-planner/assets/img2/perfect-week.png);
                    }

                    .past-week-results,
                    .past-week-badges{
                        display: none;
                    }

                    .past-week-results.is-week-current,
                    .past-week-badges.is-week-current{
                        display: block;
                    }

                    .past-week-results.is-week-1,
                    .past-week-results.is-week-2{
                        display: none !important;
                    }

                    .past-week-badges.is-week-1,
                    .past-week-badges.is-week-2{
                        display: none !important;
                    }
                </style>
                <div>
                    <?php
                    for ($i = -44; $i <=1 ; $i++){
                        ?>
                        <div class="past-week-badges
                            <?php if ($i < 0) echo 'is-week-previous'; ?>
                            <?php if ($i == 0) echo 'is-week-current'; ?>
                            <?php if ($i == 0) echo 'is-week-1'; ?>
                            <?php if ($i == 1) echo 'is-week-2'; ?>"
                             data-date-1="<?php echo date('Y-m-d',strtotime('Monday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);?>"
                             data-date-2="<?php echo date('Y-m-d',strtotime('Tuesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);?>"
                             data-date-3="<?php echo date('Y-m-d',strtotime('Wednesday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);?>"
                             data-date-4="<?php echo date('Y-m-d',strtotime('Thursday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);?>"
                             data-date-5="<?php echo date('Y-m-d',strtotime('Friday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);?>"
                             data-date-6="<?php echo date('Y-m-d',strtotime('Saturday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);?>"
                             data-date-7="<?php echo date('Y-m-d',strtotime('Sunday this week ') + $imitate_day_week * 7*86400 + $i*7*86400);?>"
                            >
                            <div class="past-week-badges-headlines">
                                <h4>Badges</h4>
                            </div>
                            <div class="past-week-badges-wrapper">
                                <div class="past-week-badge-1 <?php echo $c_counter[$i]['good'] ? '' : ' no-items '; ?>">
                                    <div class="badge"></div>
                                    <h4><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h4>
                                    <p><?php echo $c_counter[$i]['good'] ? $c_counter[$i]['good'].'x' : '-'; ?></p>
                                </div>
                                <div class="past-week-badge-2 <?php echo $c_counter[$i]['perfect'] ? '' : ' no-items '; ?>">
                                    <div class="badge"></div>
                                    <h4>Perfect Day</h4>
                                    <p><?php echo $c_counter[$i]['perfect'] ? $c_counter[$i]['perfect'].'x' : '-'; ?></p>
                                </div>
                                <div class="past-week-badge-3
                                    <?php
                                    $is_perfect = 0 ;
                                    if ((($c_counter[$i]['perfect'] > 0) && ($c_counter[$i]['good'] == 0) && ($c_counter[$i]['not_finished'] == 0))){
                                        if (($perf_stats[$i]['day'] < 100) || ($perf_stats[$i]['week'] < 100)){
                                            echo ' have-perfect ';
                                        }
                                        else{
                                            echo ' no-items ';
                                        }
                                    }
                                    elseif ((($c_counter[$i]['good'] > 0) && ($c_counter[$i]['not_finished'] == 0))){
                                        echo ' have-perfect ';
                                    }
                                    else{
                                        echo ' no-items ';
                                    }?>
                                    ">
                                    <div class="badge"></div>
                                    <h4>Perfect Focus</h4>
                                    <p>-</p>
                                </div>
                                <div class="past-week-badge-4
                                    <?php
                                    if ((($c_counter[$i]['perfect'] > 0) && ($c_counter[$i]['good'] == 0) && ($c_counter[$i]['not_finished'] == 0))){
                                        if (($perf_stats[$i]['day'] == 100) && ($perf_stats[$i]['week'] == 100)){
                                            echo ' have-best ';
                                        }
                                        else{
                                            echo ' no-items ';
                                        }
                                    }
                                    else{
                                        echo ' no-items ';
                                    }?>
                                    ">
                                    <div class="badge"></div>
                                    <h4>Perfect Week</h4>
                                    <p>-</p>
                                </div>
                            </div>
                        </div>
                        <?php
                    }
                    ?>
                </div>
                <div class="is-1 week-notes-wrapper">
                    <h4>Notes</h4>
                    <?php
                    if ($rows_goals){
                        foreach ($rows_goals as $row){
                            ?>
                            <div class="week-notes-textarea-wrapper is-filled" data-number="<?php echo $row->number; ?>">
                                <textarea class="week-notes-textarea" readonly><?php echo $row->text; ?></textarea>
                                <a href="#" class="edit-input"></a>
                                <a href="#" class="remove-input">x</a>
                            </div>
                            <?php
                        }
                    }
                    else{
                        ?>
                        <div class="week-notes-textarea-wrapper">
                            <textarea class="week-notes-textarea"></textarea>
                            <a href="#" class="edit-input"></a>
                            <a href="#" class="remove-input">x</a>
                        </div>
                        <?php
                    }
                    ?>
                    <a href="#" class="add-week-note"><span>+</span> Add Note</a>
                </div>
            </div>
        </div>

        <div class="is-hidden-counter counter-week-goals"><?php echo $number_week_goals; ?></div>
        <style>
            .past-week-results{
                background: conic-gradient(
                        from -44.39deg at 34.97% 35.04%, rgba(208, 210, 255, 0.11) 0deg,
                        rgba(60, 103, 255, 0.15) 129.73deg,
                        rgba(208, 210, 255, 0.11) 360deg);
                box-shadow: 1px 1px 4px 1px rgba(10, 19, 255, 0.2);
                border-radius: 15px;
                padding: 10px 15px;
                text-align: center;
                margin: 0 0 25px 0 !important;
            }

            .past-week-badges{
                background: linear-gradient(305.94deg, rgba(78, 84, 255, 0.13) 11.58%, rgba(208, 210, 255, 0.11) 131.25%);
                box-shadow: 1px 1px 4px 1px rgba(10, 19, 255, 0.2);
                border-radius: 15px;
                padding: 10px 15px;
                text-align: center;
                margin: 0 0 25px 0 !important;
            }


            .past-week-results h4{
                margin: 0 0 10px 0 !important;
                line-height: 1;
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 13.5px;
                font-weight: 600;
                color: #000;
                display: block;
                position: relative;
                text-align: center;
            }

            .past-week-badges h4{
                margin: 0 0 10px 0 !important;
                line-height: 1;
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 9.5px;
                font-weight: 500;
                color: #000;
                display: block;
                position: relative;
                text-align: center;
            }

            .past-week-badges-headlines h4{
                margin: 0 0 10px 0 !important;

                line-height: 1;
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 13.5px;
                font-weight: 600;
                color: #000;
                display: block;
                position: relative;
                text-align: center;
            }

            .past-week-badges-wrapper p,
            .past-week-badges-wrapper p{
                margin: 0 0 10px 0;
                line-height: 1;
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 14px;
                font-weight: 500;
                color: #000;
                display: block;
                position: relative;
                text-align: center;
            }

            .past-week-badges-wrapper .no-items .badge{
                filter: brightness(0.2);
            }

            .add-daily-actions{
                color: rgba(0,0,0,0.3);
                position: relative;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                letter-spacing: 0;
                line-height: 1;
                font-size: 14px;
                transition: 0.4s all;
                padding-left: 17px;
                vertical-align: top;
            }

            .add-daily-actions:hover,
            .add-daily-actions:focus{
                color: rgba(0,0,0,1);
            }

            .add-daily-actions span{
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                display: block;
                position: absolute;
                color: #fff !important;
                left: 3px;
                top: 2px;
                background-image: url(/wp-content/plugins/habit-planner/assets/img2/add.png);
                background-size: contain;
                background-position: 50% 50%;
                background-repeat: no-repeat;
                opacity: 0.3;
                width: 11px;
                height: 11px;
                border-radius: 50%;
                line-height: 10px;
                letter-spacing: 0;
                text-align: center;
                font-size: 0px;
                transition: 0.4s all;
            }

            .add-daily-actions:hover span,
            .add-daily-actions:focus span{
                opacity: 1;
            }

            .day-daily-actions button{
                line-height: 1;
                margin: 0 0 10px 0;
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 16px;
                font-weight: 600;
                color: #000;
                display: block;
                border: none;
                background: transparent;
                cursor: default;
                transition: 0s all;
            }

            .day-daily-actions.have-items button{
                cursor: pointer;
            }

            .day-daily-actions.have-items .add-daily-actions{
                display: none;
            }

            .day-daily-actions.have-items button:hover,
            .day-daily-actions.have-items button:focus{
                color: #274AFF;
            }

            .end-day{
                border: none;
                margin: 7px 5px 0 5px !important;
                display: block;
                width: calc(100% - 10px);
                line-height: 1;
                padding: 6px 10px;
                transition: 0.4s all !important;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 14px;
                color: #fff;
                background: linear-gradient(187.02deg, rgba(173, 211, 255, 0.5) -174.74%, rgba(94, 139, 255, 0.495) -60.77%, rgba(39, 74, 255, 0.5) 123.01%);
                box-shadow: 1px 3.63636px 3.63636px 2px rgb(0 0 0 / 4%);
                border-radius: 7px;
            }

            .end-day.active{
                background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%);
                box-shadow: 1px 3.63636px 3.63636px 2px rgba(0, 0, 0, 0.04);
            }

            .end-day.hidden{
                display: none;
            }

            .end-day:hover,
            .end-day:focus{
                opacity: 0.7;
            }

            .day-progress-circle span{
                line-height: 48px;
                margin: 0;
                padding: 0;
                font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                font-size: 12px;
                font-weight: 500;
                text-align: center;
                position: relative;
                z-index: 3;
            }

            .daily-focus-circle span{
                color: #531DEB;
            }

            .today-tasks-circle span{
                color: #2B5DFF;
            }

            .daily-planning-circle span{
                color: #FFA31A;
            }
        </style>
        <?php
        $rows_day_planned = $wpdb->get_results("
            SELECT * FROM ".$wpdb->prefix."habit_data 
            WHERE user_id=".get_current_user_id()." 
            AND type='day_planned' 
            AND date_created='".date('Y-m-d',time() + $imitate_day * 86400)."'
            ORDER BY number ASC
        ");
        ?>
        <div class="is-habit-tab planner-day <?php if ($tab_day == 'day') echo ' show '; ?> <?php if ($rows_day_planned) {echo 'is-day-finished'; } ?>">
            <?php
            $date_F = date('d',time() + $imitate_day * 86400);
            if ($date_F == 31 || $date_F == 21 || $date_F == 1){
                $date_F_add = 'st';
            }
            elseif($date_F == 22 || $date_F == 2){
                $date_F_add = 'nd';
            }
            else{
                $date_F_add = 'th';
            }
            if (($date_F == '01') || ($date_F == '02') || ($date_F == '03') || ($date_F == '04') || ($date_F == '05') ||
                ($date_F == '06') || ($date_F == '07') || ($date_F == '08') || ($date_F == '09')){
                $date_F = str_replace('0','',$date_F);
            }


            $date_F_tomorrow = date('d',time() + $imitate_day * 86400 + 86400);
            if ($date_F_tomorrow == 31 || $date_F_tomorrow == 21 || $date_F_tomorrow == 1){
                $date_F_add_tomorrow = 'st';
            }
            elseif($date_F_tomorrow == 22 || $date_F_tomorrow == 2){
                $date_F_add_tomorrow = 'nd';
            }
            else{
                $date_F_add_tomorrow = 'th';
            }
            if (($date_F_tomorrow == '01') || ($date_F_tomorrow == '02') || ($date_F_tomorrow == '03') || ($date_F_tomorrow == '04') || ($date_F_tomorrow == '05') ||
                ($date_F_tomorrow == '06') || ($date_F_tomorrow == '07') || ($date_F_tomorrow == '08') || ($date_F_tomorrow == '09')){
                $date_F_tomorrow = str_replace('0','',$date_F_tomorrow);
            }
            ?>
            <h3><?php echo date('l',time()  + $imitate_day * 86400)?> -
                <?php echo date('F',time()  + $imitate_day * 86400)?> <?php echo $date_F.$date_F_add; ?><span>: Complete</span></h3>
            <h6>Come back tomorrow to start your day!</h6>
            <div class="day-wrapper" data-date="<?php echo date('Y-m-d',time()  + $imitate_day * 86400); ?>"
                 data-date-tomorrow="<?php echo date('Y-m-d',time()  + $imitate_day * 86400 + 86400); ?>">
                <?php
                $today_tasks_completed = 0;
                $today_tasks_all = 0;

                if (!$rows_day_planned){
                    $today_actions_added = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='today_actions_added' 
                            AND date_created='".date('Y-m-d',time() + $imitate_day * 86400)."'
                            ORDER BY number ASC
                        ");

                    if (!$today_actions_added){
                        $regular_actions = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='regular_action' 
                            ORDER BY number ASC
                        ");
                        if ($regular_actions){
                            $today_number = date('N',time()  + $imitate_day * 86400);
                            $today_add_number = 0;
                            foreach ($regular_actions as $reg_action){
                                $reg_action_text = $reg_action->text;
                                $reg_action_link = $reg_action->link;
                                $reg_action_repeat_type = $reg_action->day_repeat_type;
                                $reg_action_repeat_days = $reg_action->day_repeat_days;
                                $reg_action_repeat_days_arr = explode(',',$reg_action_repeat_days);
                                if (
                                    ($reg_action_repeat_type == 'day') ||
                                    (($reg_action_repeat_type == 'week') && ($reg_action_repeat_days_arr[$today_number - 1] == 1))
                                ){
                                    $today_add_number++;
                                    $wpdb->insert($wpdb->prefix."habit_data",
                                        array(
                                            'type'=>'daily_action',
                                            'text'=>$reg_action_text,
                                            'link'=>$reg_action_link,
                                            'number'=>$today_add_number,
                                            'completed'=>0,
                                            'day_repeat_type'=>$reg_action_repeat_type,
                                            'day_repeat_days'=>$reg_action_repeat_days,
                                            'action_time'=>'',
                                            'timestamp'=>time(),
                                            'date_created'=>date('Y-m-d',time() + $imitate_day * 86400),
                                            'user_id'=>get_current_user_id(),
                                        )
                                    );
                                }
                            }
                        }

                        $wpdb->insert($wpdb->prefix."habit_data",
                            array(
                                'type'=>'today_actions_added',
                                'text'=>'',
                                'link'=>'',
                                'number'=>'',
                                'completed'=>'',
                                'day_repeat_type'=>'',
                                'day_repeat_days'=>'',
                                'action_time'=>'',
                                'timestamp'=>time(),
                                'date_created'=>date('Y-m-d',time() + $imitate_day * 86400),
                                'user_id'=>get_current_user_id(),
                            )
                        );

                    }
                }

                $today_actions = $wpdb->get_results("
                    SELECT * FROM ".$wpdb->prefix."habit_data 
                    WHERE user_id=".get_current_user_id()." 
                    AND type='daily_action' 
                    AND date_created='".date('Y-m-d',time() + $imitate_day * 86400)."'
                    ORDER BY number ASC
                ");
                ?>
                <div class="day-daily-actions <?php echo $today_actions ? 'have-items' : ''; ?>">
                    <button>Daily Actions</button>
                    <?php
                    if ($today_actions){
                        foreach ($today_actions as $task){
                            $task_number = $task->number;
                            $task_completed = $task->completed;
                            $today_tasks_all++;
                            if ($task_completed){
                                $today_tasks_completed++;
                            }
                            $task_text = $task->text;
                            $task_link = $task->link;
                            $task_type = $task->day_repeat_type;
                            $task_days = $task->day_repeat_days;
                            $t_d_arr = explode(',',$task_days);
                            ?>
                            <div class="action-input-wrapper <?php echo $task_completed ? 'is-completed' : ''; ?>"
                                 data-counter="<?php echo $task_number; ?>" data-type="<?php echo $task_type;?>"
                                data-day1="<?php echo $t_d_arr[0]; ?>" data-day2="<?php echo $t_d_arr[1]; ?>" data-day3="<?php echo $t_d_arr[2]; ?>"
                                 data-day4="<?php echo $t_d_arr[3]; ?>" data-day5="<?php echo $t_d_arr[4]; ?>"
                                 data-day6="<?php echo $t_d_arr[5]; ?>" data-day7="<?php echo $t_d_arr[6]; ?>" >
                                <?php
                                if ($task_link !== 'https://'){
                                    ?>
                                    <a target="_blank" href="<?php echo $task_link; ?>"><?php echo $task_text; ?></a><button></button>
                                    <?php
                                }
                                else{
                                    ?>
                                    <span><?php echo $task_text; ?></span><button></button>
                                    <?php
                                }
                                ?>
                            </div>
                            <?php
                        }
                    }
                    ?>
                    <a href="#" class="add-daily-actions"><span>+</span> Add daily actions</a>
                </div>
                <?php

                $today_focus = $wpdb->get_results("
                        SELECT * FROM ".$wpdb->prefix."habit_data 
                        WHERE user_id=".get_current_user_id()." 
                        AND type='daily_focus' 
                        AND date_created='".date('Y-m-d',time() + $imitate_day * 86400)."'
                        ORDER BY number ASC
                    ");
                $today_focus_completed = 0;
                $today_focus_all = 0;
                ?>
                <style>
                    .day-daily-focus p {
                        display: none;
                        line-height: 1;
                        margin: 10px 0 15px 0;
                        padding: 0;
                        font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                        font-size: 12.5px;
                        font-weight: 400;
                        text-align: left;
                        color: rgb(0 0 0);
                    }

                    .day-daily-focus.is-routines p{
                        display: block;
                    }
                </style>
                <div class="day-daily-focus <?php  if ($user_routines) {echo 'is-routines';}?>" <?php if (!$today_focus) echo 'style="display:none;"';?>>
                    <h4><?php  if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';}?></h4>
                    <p>Night:</p>
                    <div class="day-night-wrapper">
                        <?php
                        if ($today_focus){
                            foreach ($today_focus as $focus){
                                $focus_number = $focus->number;
                                $focus_completed = $focus->completed;
                                $focus_text = $focus->text;

                                $focus_time = $focus->action_time;
                                $time_type = '';
                                if (strpos($focus_time, 'am') !== false) {
                                    $time_type = 'am';
                                }
                                elseif(strpos($focus_time, 'pm') !== false){
                                    $time_type = 'pm';
                                }
                                $focus_time = str_replace(array('am','pm'),'',$focus_time);
                                $time_arr = explode(':',$focus_time);
                                if ($user_routines && $time_type == 'pm'){
                                    $today_focus_all++;
                                    if ($focus_completed){
                                        $today_focus_completed++;
                                    }
                                    ?>
                                    <div class="is-focus-input-wrapper <?php echo $focus_completed ? 'is-completed' : ''; ?>" data-number="<?php echo $focus_number; ?>" data-checked="0">
                                        <span class="text-span"><?php echo $focus_text; ?></span>
                                        <span class="time-span">
                                            <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                        </span>
                                        <button></button>
                                    </div>
                                    <?php
                                }
                            }
                        }
                        ?>
                    </div>
                    <p>Morning:</p>
                    <div class="day-morning-wrapper">
                        <?php
                        if ($today_focus){
                            foreach ($today_focus as $focus){
                                $focus_number = $focus->number;
                                $focus_completed = $focus->completed;
                                $focus_text = $focus->text;

                                $focus_time = $focus->action_time;
                                $time_type = '';
                                if (strpos($focus_time, 'am') !== false) {
                                    $time_type = 'am';
                                }
                                elseif(strpos($focus_time, 'pm') !== false){
                                    $time_type = 'pm';
                                }
                                $focus_time = str_replace(array('am','pm'),'',$focus_time);
                                $time_arr = explode(':',$focus_time);
                                if ($user_routines) {
                                    if ($time_type == 'am') {
                                        $today_focus_all++;
                                        if ($focus_completed){
                                            $today_focus_completed++;
                                        }
                                        ?>
                                        <div class="is-focus-input-wrapper <?php echo $focus_completed ? 'is-completed' : ''; ?>" data-number="<?php echo $focus_number; ?>" data-checked="0">
                                            <span class="text-span"><?php echo $focus_text; ?></span>
                                            <span class="time-span">
                                            <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                            </span>
                                            <button></button>
                                        </div>
                                        <?php
                                    }
                                }
                                else{
                                    $today_focus_all++;
                                    if ($focus_completed){
                                        $today_focus_completed++;
                                    }
                                    ?>
                                    <div class="is-focus-input-wrapper <?php echo $focus_completed ? 'is-completed' : ''; ?>" data-number="<?php echo $focus_number; ?>" data-checked="0">
                                        <span class="text-span"><?php echo $focus_text; ?></span>
                                        <span class="time-span">
                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type; ?></span>
                                    </span>
                                        <button></button>
                                    </div>
                                    <?php
                                }
                            }
                        }
                        ?>
                    </div>
                </div>








                <div class="day-secondary-tasks">
                    <h4>Secondary Tasks</h4>
                    <?php
                    $today_tasks = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='task' 
                            AND date_created='".date('Y-m-d',time() + $imitate_day * 86400)."'
                            ORDER BY number ASC
                        ");

                    if ($today_tasks){
                        foreach ($today_tasks as $task){
                            $task_number = $task->number;
                            $task_completed = $task->completed;
                            $task_text = $task->text;

                            $today_tasks_all++;
                            if ($task_completed){
                                $today_tasks_completed++;
                            }
                            ?>
                            <div class="task-input-wrapper <?php echo $task_completed ? 'is-completed' : ''; ?>"
                                 data-number="<?php echo $task_number; ?>" data-checked="<?php echo $task_completed; ?>">
                                <span><?php echo $task_text; ?></span><button></button>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="day-notes-wrapper">
                    <h4>Notes</h4>
                    <?php
                    if ($rows_goals){
                        foreach ($rows_goals as $row){
                            ?>
                            <div class="day-notes-textarea-wrapper is-filled" data-number="<?php echo $row->number; ?>">
                                <textarea class="day-notes-textarea" readonly><?php echo $row->text; ?></textarea>
                                <a href="#" class="edit-input"></a>
                                <a href="#" class="remove-input">x</a>
                            </div>
                            <?php
                        }
                    }
                    else{
                        ?>
                        <div class="day-notes-textarea-wrapper">
                            <textarea class="day-notes-textarea"></textarea>
                            <a href="#" class="edit-input"></a>
                            <a href="#" class="remove-input">x</a>
                        </div>
                        <?php
                    }
                    ?>
                    <a href="#" class="add-day-note"><span>+</span> Add Note</a>
                </div>
            </div>
            <div class="day-sidebar">
                <?php
                $today_appointments = $wpdb->get_results("
                            SELECT * FROM ".$wpdb->prefix."habit_data 
                            WHERE user_id=".get_current_user_id()." 
                            AND type='appointment' 
                            AND date_created='".date('Y-m-d',time() + $imitate_day * 86400)."'
                            ORDER BY number ASC
                        ");
                ?>
                <div class="day-appointments <?php echo $today_appointments ? 'show' : '';?>">
                    <h4>Appointments</h4>
                    <?php
                        if ($today_appointments){
                            foreach ($today_appointments as $appointment){
                                $appointment_number = $appointment->number;
                                $appointment_time = $appointment->action_time;
                                $appointment_text = $appointment->text;
                                ?>
                                <div class="appointment-items-wrapper">
                                    <p class="appointment-item" data-number="<?php echo $appointment_number; ?>">
                                        <span class="icon"></span><?php echo $appointment_time; ?> <?php echo $appointment_text; ?>
                                    </p><br>
                                </div>
                                <?php
                            }
                        }
                    ?>
                    <div class="appointment-items-wrapper">

                    </div>
                </div>
                <div class="end-of-day-review <?php if ($rows_day_planned) {echo ' show '; echo ' is-badge-'.$rows_day_planned[0]->completed; } ?>">
                    <h4>End Of Day Review</h4>
                    <?php
                        $stats = $rows_day_planned[0]->text;
                        $stats_arr = explode(',',$stats);
                    ?>
                    <div class="end-day-circle-progress-wrapper">
                        <div class="end-day-plan-circle" style="--ratio:<?php echo $stats_arr[0]; ?>;"></div>
                        <div class="end-day-tog-circle" style="--ratio:<?php echo $stats_arr[1]; ?>;"></div>
                        <div class="end-day-fcs-circle" style="--ratio:<?php echo $stats_arr[2]; ?>;"></div>
                        <span class="numbers"><?php echo $stats_arr[3]; ?></span>
                        <span>%</span>
                    </div>
                    <h5 class="p-badge-0">Nice Work!</h5>
                    <p class="p-badge-1">You Earned 1 Badge:</p>
                    <p class="p-badge-2">You Earned 2 Badges:</p>
                    <div class="day-badges-wrapper day-badge-1">
                        <div class="day-badge">
                            <div class="badge-icon badge-icon-daily-focus"></div>
                            <h5><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h5>
                        </div>
                        <div class="day-badge">
                            <span>-</span>
                            <div class="badge-icon"></div>
                            <h5>Perfect Day</h5>
                        </div>
                    </div>
                    <div class="day-badges-wrapper day-badge-2">
                        <div class="day-badge">
                            <div class="badge-icon badge-icon-daily-focus"></div>
                            <h5><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h5>
                        </div>
                        <div class="day-badge">
                            <div class="badge-icon badge-icon-perfect-day"></div>
                            <h5>Perfect Day</h5>
                        </div>
                    </div>
                </div>
                <div class="day-progress">
                    <div class="progress-daily-focus">
                        <h4><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h4>
                        <div class="day-progress-circle daily-focus-circle" style="--ratio: <?php echo $today_focus_all ? $today_focus_completed / $today_focus_all : '0'; ?>">
                            <span class="numbers"><?php echo $today_focus_all ? round($today_focus_completed / $today_focus_all * 100 ) : '0'; ?></span><span>%</span>
                        </div>
                        <h5><span class="current"><?php echo $today_focus_completed; ?></span>/<span class="all"><?php echo $today_focus_all; ?></span> Complete</h5>
                    </div>
                    <div class="progress-today-tasks">
                        <h4>Todays Tasks</h4>
                        <div class="day-progress-circle today-tasks-circle" style="--ratio: <?php echo $today_tasks_all ? $today_tasks_completed / $today_tasks_all : '0'; ?>">
                            <span><?php echo $today_tasks_all ? round($today_tasks_completed / $today_tasks_all * 100 ) : '0'; ?></span><span>%</span>
                        </div>
                        <h5><span class="current"><?php echo $today_tasks_completed; ?></span>/<span class="all"><?php echo $today_tasks_all; ?></span> Complete</h5>
                    </div>
                    <div class="progress-daily-planning">
                        <h4>Daily Planning</h4>
                        <div class="day-progress-circle daily-planning-circle" style="--ratio: <?php echo $rows_day_planned ? '1' : '0'; ?>">
                            <span><?php echo $rows_day_planned ? '100' : '0'; ?></span><span>%</span>
                        </div>
                        <h5>Plan Tomorrow</h5>
                    </div>
                    <?php
                    $end_day_active = '';
                    if ($today_focus_all || $today_tasks_all){
                        if (($today_focus_all==$today_focus_completed) && ($today_tasks_all==$today_tasks_completed)){
                            $end_day_active = ' active ';
                        }
                    }
                    ?>
                    <button class="end-day <?php echo $end_day_active; ?> <?php if ($rows_day_planned) echo ' hidden '; ?>">End Day</button>
                </div>
            </div>
        </div>
    </div>






    <div class="popup-settings-wrapper is-habit-wrapper">
        <div class="popup-settings is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h2>Settings</h2>
            <p>
                <span>Timezone:</span>
                <select class="user_timezone">
                    <option value="Pacific/Midway" <?php if ($user_timezone == 'Pacific/Midway') echo 'selected'; ?>>(GMT -11:00) Samoa</option>
                    <option value="Pacific/Honolulu" <?php if ($user_timezone == 'Pacific/Honolulu') echo 'selected'; ?>>(GMT -10:00) Hawaii, Honolulu</option>
                    <option value="America/Anchorage" <?php if ($user_timezone == 'America/Anchorage') echo 'selected'; ?>>(GMT -8:00) Pacific Time (US &amp; Canada), Anchorage </option>
                    <option value="America/Los_Angeles" <?php if ($user_timezone == 'America/Los_Angeles') echo 'selected'; ?>>(GMT -7:00) Mountain Time (US &amp; Canada), Los Angeles</option>
                    <option value="America/Denver" <?php if ($user_timezone == 'America/Denver') echo 'selected'; ?>>(GMT -6:00) Central Time (US &amp; Canada), Belmopan, San Jose, Managua</option>
                    <option value="America/Bogota" <?php if ($user_timezone == 'America/Bogota') echo 'selected'; ?>>(GMT -5:00) Eastern Time (US &amp; Canada), Bogota-Colombia, Lima</option>
                    <option value="America/New_York" <?php if ($user_timezone == 'America/New_York') echo 'selected'; ?>>(GMT -4:00) Atlantic Time (Canada), Georgetown, Caracas, La Paz</option>
                    <option value="America/Sao_Paulo" <?php if ($user_timezone == 'America/Sao_Paulo') echo 'selected'; ?>>(GMT -3:00) Brazil, Buenos Aires</option>
                    <option value="Atlantic/South_Georgia" <?php if ($user_timezone == 'Atlantic/South_Georgia') echo 'selected'; ?>>(GMT -2:00) Grytviken</option>
                    <option value="Atlantic/Cape_Verde" <?php if ($user_timezone == 'Atlantic/Cape_Verde') echo 'selected'; ?>>(GMT -1:00)  Cape Verde Islands</option>
                    <option value="Atlantic/Azores" <?php if ($user_timezone == 'Atlantic/Azores') echo 'selected'; ?>>(GMT) Western Europe Time, Azores, Banjul, Reykjavik</option>
                    <option value="Europe/Dublin" <?php if ($user_timezone == 'Europe/Dublin') echo 'selected'; ?>>(GMT +1:00) Dublin, Rabat, Abuja, Lisbon</option>
                    <option value="Europe/Belgrade" <?php if ($user_timezone == 'Europe/Belgrade') echo 'selected'; ?>>(GMT +2:00) Belgrade, Kaliningrad, South Africa</option>
                    <option value="Europe/Minsk" <?php if ($user_timezone == 'Europe/Minsk') echo 'selected'; ?>>(GMT +3:00) Baghdad, Riyadh, Minsk, Kiev, Moscow, St. Petersburg</option>
                    <option value="Asia/Muscat" <?php if ($user_timezone == 'Asia/Muscat') echo 'selected'; ?>>(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi</option>
                    <option value="Asia/Tehran" <?php if ($user_timezone == 'Asia/Tehran') echo 'selected'; ?>>(GMT +4:30) Kabul, Tehran</option>
                    <option value="Asia/Yekaterinburg" <?php if ($user_timezone == 'Asia/Yekaterinburg') echo 'selected'; ?>>(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent</option>
                    <option value="Asia/Kolkata" <?php if ($user_timezone == 'Asia/Kolkata') echo 'selected'; ?>>(GMT +5:30) New Delhi, Kolkata</option>
                    <option value="Asia/Katmandu" <?php if ($user_timezone == 'Asia/Katmandu') echo 'selected'; ?>>(GMT +5:45) Kathmandu, Pokhara</option>
                    <option value="Asia/Dhaka" <?php if ($user_timezone == 'Asia/Dhaka') echo 'selected'; ?>>(GMT +6:00) Almaty, Dhaka</option>
                    <option value="Asia/Rangoon" <?php if ($user_timezone == 'Asia/Rangoon') echo 'selected'; ?>>(GMT +6:30) Yangon, Mandalay</option>
                    <option value="Asia/Krasnoyarsk" <?php if ($user_timezone == 'Asia/Krasnoyarsk') echo 'selected'; ?>>(GMT +7:00) Bangkok, Hanoi, Jakarta</option>
                    <option value="Asia/Brunei" <?php if ($user_timezone == 'Asia/Brunei') echo 'selected'; ?>>(GMT +8:00) Beijing, Perth, Singapore, Hong Kong</option>
                    <option value="Asia/Seoul" <?php if ($user_timezone == 'Asia/Seoul') echo 'selected'; ?>>(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk</option>
                    <option value="Australia/Darwin" <?php if ($user_timezone == 'Australia/Darwin') echo 'selected'; ?>>(GMT +9:30) Adelaide, Darwin</option>
                    <option value="Australia/Sydney" <?php if ($user_timezone == 'Australia/Sydney') echo 'selected'; ?>>(GMT +10:00) Eastern Australia, Sydney, Canberra</option>
                    <option value="Asia/Magadan" <?php if ($user_timezone == 'Asia/Magadan') echo 'selected'; ?>>(GMT +11:00) Gizo, Magadan, Solomon Islands, New Caledonia</option>
                    <option value="Pacific/Fiji" <?php if ($user_timezone == 'Pacific/Fiji') echo 'selected'; ?>>(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka</option>
                    <option value="Pacific/Tongatapu" <?php if ($user_timezone == 'Pacific/Tongatapu') echo 'selected'; ?>>(GMT +13:00) Apia, Nukualofa</option>
                </select>
            </p>
            <p>
                <span>Date Display:</span>
                <select class="user_date_display">
                    <option value="d/m/Y" <?php if ($user_date_display == 'd/m/Y') echo 'selected'; ?>>DD-MM-YY</option>
                    <option value="m/d/Y" <?php if ($user_date_display == 'm/d/Y') echo 'selected'; ?>>MM-DD-YY</option>
                </select>
            </p>
            <p>Daily Focus: <input type="checkbox" <?php if (!$user_routines) echo 'checked'; ?> id="settings-focus-mode"><label for="settings-focus-mode"></label></p>
            <p>Routines: <input type="checkbox"  <?php if ($user_routines) echo 'checked'; ?> id="settings-routines"><label for="settings-routines"></label></p>
            <button class="cancel-settings-popup">Cancel</button>
            <button class="save-settings-popup">Save</button>
        </div>
    </div>


    <style>

        .popup-notes-wrapper{
            background: rgba(252, 253, 254, 0.9);
            box-shadow: 1px 1px 4px rgb(0 0 0 / 10%);
            padding: 8px 11px;
            border-radius: 7px;
            margin: 0 0 20px 0;
            text-align: left;
        }

        .popup-notes-wrapper h4{
            display: block;
            position: relative;
            margin: 0;
            padding: 0;
            line-height: 1;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            cursor: pointer;
            transition: 0.4s all;
            text-align: left;
        }

        .popup-notes-wrapper h4:after{
            content: '>';
            transform: rotate(90deg) scaleY(1.5);
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 8px;
            position: absolute;
            transition: 0.4s all;
            right: -5px;
            top: 2px;
            line-height: 1;
        }

        .popup-notes-wrapper h4:hover,
        .popup-notes-wrapper h4:focus{
            color: #274AFF;
        }

        .popup-notes-wrapper h4:hover:after,
        .popup-notes-wrapper h4:focus:after{
            color: #274AFF;
        }

        .popup-this-week-goals h3,
        .popup-daily-focus-set h3,
        .popup-daily-focus-decide h3{
            text-align: left;
            font-weight: 500;
            margin: 0 0 8px 0 !important;
        }

        .popup-plan-week-wrapper h6{
            display: block;
            position: relative;
            margin: 0 0 8px 0 !important;
            font-weight: 400;
            padding: 0;
            line-height: 1;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: rgba(0, 0, 0, 0.49);
            font-size: 11px;
            transition: 0.4s all;
            text-align: left;
        }

        .popup-this-week-goals{
            background: #EBECFF;
            box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            padding: 10px 15px;
            margin: 0 0 20px 0;
            text-align: left;
        }

        .popup-daily-focus-set{
            background: #F5F2FE;
            box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            padding: 10px 15px;
            margin: 0 0 20px 0;
            text-align: left;
        }

        .popup-daily-focus-decide{
            background: #FEFEFF;
            box-shadow: 1px 0 3px rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            padding: 10px 15px;
            margin: 0 0 20px 0;
            text-align: left;
        }

        .focus-decide-wrapper:after{
            content: '';
            display: block;
            clear: both;
        }

        .focus-decide-wrapper button {
            text-align: left;
            font-size: 12px;
            background: #F5F6F8;
            border-radius: 5px;
            padding: 7px 10px;
            margin: 0 0 7px 0;
            color: #000;
            box-shadow: 1px 1px 1px 0.5px rgb(0 0 0 / 5%);
            position: relative;
        }

        .focus-decide-wrapper button:nth-of-type(6){
            float: left;
            width: calc(50% - 3px);
            margin-right: 6px;
        }

        .focus-decide-wrapper button:nth-of-type(7){
            float: left;
            width: calc(50% - 3px);
        }

        .focus-decide-wrapper button:after{
            content: '';
            display: block;
            position: absolute;
            width: 14px;
            height: 14px;
            background: #D9D9D9;
            border-radius: 50%;
            right: 4px;
            top: 6px;
        }

        .focus-decide-wrapper button.active:after{
            width: 14px;
            height: 18px;
            background-color: transparent;
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
            border-radius: 50%;
            right: 4px;
            top: 4px;
        }

        .focus-decide-wrapper button.active,
        .focus-decide-wrapper button:hover,
        .focus-decide-wrapper button:focus
        {
            background: #F5F2FE;
        }

        .popup-goals-textarea-wrapper textarea{
            width: 100%;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 20px;
            line-height: 18px;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
        }

        .popup-goals-textarea-wrapper textarea:focus {
             border: 1px solid #777;
             height: 38px;
         }


        .add-popup-goal,
        .add-week-goal,
        .add-popup-focus{
            color: rgba(0,0,0,0.3);
            position: relative;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            letter-spacing: 0;
            line-height: 1;
            font-size: 10px;
            transition: 0.4s all;
            padding-left: 17px;
            vertical-align: top;
        }

        .add-popup-goal:hover,
        .add-popup-goal:focus,
        .add-week-goal:hover,
        .add-week-goal:focus,
        .add-popup-focus:hover,
        .add-popup-focus:focus{
            color: #000;
        }

        .add-popup-goal span,
        .add-week-goal span,
        .add-popup-focus span{
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            display: block;
            position: absolute;
            color: #fff !important;
            left: 5px;
            top: 1px;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/add.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            opacity: 0.3;
            width: 9px;
            height: 9px;
            border-radius: 50%;
            line-height: 9px;
            letter-spacing: 1px;
            text-align: center;
            font-size: 0;
            transition: 0.4s all;
        }

        .add-popup-goal:hover span,
        .add-popup-goal:focus span,
        .add-week-goal:hover span,
        .add-week-goal:focus span,
        .add-popup-focus:hover span,
        .add-popup-focus:focus span
        {
            opacity: 1;
        }

        .popup-goals-textarea-wrapper textarea[readonly]{
            height: 20px !important;
            line-height: 18px;
            border: 1px solid transparent !important;
            overflow: hidden;
        }

        .popup-goals-textarea-wrapper{
            position: relative;
        }

        .add-focus-wrapper p{
            font-size: 12px;
            margin: 0 0 6px 0;
        }

        .add-focus-wrapper input{
            width: 100%;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 20px;
            line-height: 18px;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
            margin: 0 0 14px 0;
        }


        .add-focus-wrapper input::placeholder{
            color: #9f9f9f !important;
        }

        .add-focus-wrapper{
            display: none;
            margin-bottom: 12px;
        }

        .add-focus-wrapper.show{
            display: block;
        }

        .cancel-focus-popup{
            font-size: 14px !important;
            padding: 6px 10px !important;
            border-radius: 5px !important;
            display: inline-block !important;
            vertical-align: top;
            width: calc(40% - 2px) !important;
            background: linear-gradient(187.02deg, #FFFFFF -174.74%, rgba(248, 250, 255, 0.99) -60.77%, #FBFBFF 123.01%) !important;
            box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.05) !important;
            color: rgba(58, 96, 255, 0.9) !important;
        }

        .save-focus-popup{
            font-size: 14px !important;
            padding: 6px 10px !important;
            border-radius: 5px !important;
            display: inline-block !important;
            vertical-align: top;
            width: calc(60% - 2px) !important;
            background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%) !important;
            box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1) !important;
        }

        .time-wrapper select{
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 20px;
            line-height: 18px;
            padding: 0 10px 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #9f9f9f !important;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
            margin: 0 0 10px 0;
            width: 40px;
            display: inline-block;
            vertical-align: top;
        }


        .save-focus-popup:hover,
        .save-focus-popup:focus,
        .cancel-focus-popup:hover,
        .cancel-focus-popup:focus{
            opacity: 0.8;
        }

        .time-wrapper-hour{
            width: 60px !important;
            display: inline-block;
            vertical-align: top;
        }

        .time-wrapper-min{
            width: 60px !important;
            display: inline-block;
            vertical-align: top;
        }

        .popup-daily-focus-wrapper input{
            width: 100%;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 20px;
            line-height: 18px;
            padding: 0 5px;
            margin: 0 0 4px 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
        }

        .popup-daily-focus-wrapper{
            margin-bottom: 10px;
        }

        .focus-input-wrapper{
            position: relative;
        }

        .focus-input-wrapper .remove-input,
        .focus-input-wrapper .edit-input{
            top: 7px;
        }

        .time-input-wrapper{
            position: absolute;
            right: 40px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            line-height: 1;
            color: rgba(0,0,0,0.6);
            top: 6px;
        }

        .week-daily-focus-input-wrapper{
            position: relative;
        }

        .week-daily-focus-input-wrapper span.main-span{
            position: absolute;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            line-height: 1;
            top: 6px;
            right: 5px;
        }

        .focus-decide-items-wrapper{
            display: none;
        }

        .focus-decide-items-wrapper.is-week-current{
            display: block;
        }

        .plan-week-h2-wrapper h2{
            display: none !important;
        }

        .plan-week-h2-wrapper h2.is-week-current{
            display: block !important;
        }
    </style>
    <img style="display: none" src="/wp-content/plugins/habit-planner/assets/img2/focus.png" alt="pre-load-img">
    <img style="display: none" src="/wp-content/plugins/habit-planner/assets/img2/perfect-day.png" alt="pre-load-img3">
    <img style="display: none" src="/wp-content/plugins/habit-planner/assets/img2/completed.png" alt="pre-load-img2">
    <div class="popup-plan-week-wrapper is-habit-wrapper">
        <div class="popup-plan-week is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3>Plan Your Week</h3>
            <div class="plan-week-h2-wrapper">
                <?php
                for($i = -44; $i <=1; $i++){
                    ?>
                    <h2 class="<?php if ($i == 0) echo 'is-week-current'; ?>">
                        <?php echo date('F d',strtotime('Monday this week +'.$i.' week') + $imitate_day_week * 7*86400); ?> -
                        <?php echo date('F d',strtotime('Sunday this week +'.$i.' week') + $imitate_day_week * 7*86400); ?>
                    </h2>
                    <?php
                }
                ?>
            </div>
            <div class="popup-this-week-goals">
                <h3>This Weeks Goal</h3>
                <h6>What is this weeks biggest goal?</h6>
                <div class="popup-goals-textarea-wrapper">
                    <textarea class="popup-goals-textarea"></textarea>
                    <a href="#" class="edit-input"></a>
                    <a href="#" class="remove-input">x</a>
                </div>
                <a href="#" class="add-popup-goal"><span>+</span> Add goal</a>
            </div>
            <style>
                .popup-daily-focus-set p{
                    font-family: 'avenir-next-lt-pro-r', sans-serif !important;
                    line-height: 1.5;
                    font-size: 10.5px;
                    color: rgba(0,0,0,0.8);
                    font-weight: 400;
                    margin: 0 0 4px 0;
                    text-align: left;
                    display: none;
                }

                .popup-daily-focus-set.is-routine-mode p{
                    display: block;
                }

                .add-popup-focus{
                    display: inline-block;
                    margin-top: 4px;
                }

                .add-popup-focus span{
                    top: 0 !important;
                }

                .popup-night-wrapper  .add-popup-focus{
                    margin-bottom: 16px;
                }

                .popup-daily-focus-set .popup-night-wrapper + .add-popup-focus{
                    display: none !important;
                }

                .popup-daily-focus-set.is-routine-mode .popup-night-wrapper + .add-popup-focus{
                    display: inline-block !important;
                }
            </style>
            <div class="popup-daily-focus-set <?php if ($user_routines) {echo 'is-routine-mode';} ?>">
                <h3><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?>: Set</h3>
                <h6>Edit or confirm the time your <?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?> for this week:</h6>
                <?php
                $rows_daily_focus = $wpdb->get_results("
                    SELECT * FROM ".$wpdb->prefix."habit_data 
                    WHERE user_id=".get_current_user_id()." 
                    AND type='daily_focus_week' 
                    ORDER BY number ASC
                ");
                $number_last_focus = 0;
                if ($rows_daily_focus){
                    $number_last_focus = $rows_daily_focus[count($rows_daily_focus) - 1]->number;
                }

                $last_week_planned = $wpdb->get_results("
                    SELECT * FROM ".$wpdb->prefix."habit_data 
                    WHERE user_id=".get_current_user_id()." 
                    AND type='week_planned' 
                    ORDER BY timestamp ASC
                ");

                $last_days_planned = $last_week_planned[count($last_week_planned) - 1]->action_time;
                $last_focus_ids = $last_week_planned[count($last_week_planned) - 1]->link;

                $last_days_planned_arr = explode(',',$last_days_planned);
                $last_focus_ids_arr = explode(',',$last_focus_ids);
                ?>
                <p>Night:</p>
                <div class="popup-night-wrapper">
                    <div class="popup-daily-focus-wrapper">
                        <?php
                        if ($last_focus_ids_arr){
                            foreach ($last_focus_ids_arr as $last_focus_id){
                                $rows_daily_focus = $wpdb->get_results("
                                    SELECT * FROM ".$wpdb->prefix."habit_data 
                                    WHERE user_id=".get_current_user_id()." 
                                    AND id=".$last_focus_id."
                                    ORDER BY number ASC
                                ");
                                if ($rows_daily_focus){
                                    foreach ($rows_daily_focus as $row){
                                        $time = $row->action_time;
                                        $time_type = '';
                                        if (strpos($time, 'am') !== false) {
                                            $time_type = 'am';
                                        }
                                        elseif(strpos($time, 'pm') !== false){
                                            $time_type = 'pm';
                                        }
                                        $time = str_replace(array('am','pm'),'',$time);
                                        $time_arr = explode(':',$time);

                                        if ($user_routines && $time_type == 'pm'){
                                            $number_last_focus++;
                                            ?>
                                            <div class="focus-input-wrapper" data-number="<?php echo $number_last_focus; ?>">
                                                <input readonly="" type="text" value="<?php echo $row->text; ?>">
                                                <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type ?></span>
                                                </span>
                                                <a href="#" class="edit-input"></a>
                                                <a href="#" class="remove-input">x</a>
                                            </div>
                                            <?php
                                        }
                                    }
                                }
                            }
                        }
                        ?>
                    </div>
                </div>
                <a href="#" class="add-popup-focus"><span>+</span> Add <?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></a>
                <p>Morning:</p>
                <div class="popup-morning-wrapper">
                    <div class="popup-daily-focus-wrapper">
                        <?php
                        if ($last_focus_ids_arr){
                            foreach ($last_focus_ids_arr as $last_focus_id){
                                $rows_daily_focus = $wpdb->get_results("
                                    SELECT * FROM ".$wpdb->prefix."habit_data 
                                    WHERE user_id=".get_current_user_id()." 
                                    AND id=".$last_focus_id."
                                    ORDER BY number ASC
                                ");
                                if ($rows_daily_focus){
                                    foreach ($rows_daily_focus as $row){
                                        $time = $row->action_time;
                                        $time_type = '';
                                        if (strpos($time, 'am') !== false) {
                                            $time_type = 'am';
                                        }
                                        elseif(strpos($time, 'pm') !== false){
                                            $time_type = 'pm';
                                        }
                                        $time = str_replace(array('am','pm'),'',$time);
                                        $time_arr = explode(':',$time);
                                        if ($user_routines) {
                                            if ($time_type == 'am') {
                                                $today_focus_all++;
                                                $number_last_focus++;
                                                ?>
                                                <div class="focus-input-wrapper" data-number="<?php echo $number_last_focus; ?>">
                                                    <input readonly="" type="text" value="<?php echo $row->text; ?>">
                                                    <span class="time-input-wrapper">
                                                        <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type ?></span>
                                                    </span>
                                                    <a href="#" class="edit-input"></a>
                                                    <a href="#" class="remove-input">x</a>
                                                </div>
                                                <?php
                                            }
                                        }
                                        else{
                                            $number_last_focus++;
                                            ?>
                                            <div class="focus-input-wrapper" data-number="<?php echo $number_last_focus; ?>">
                                                <input readonly="" type="text" value="<?php echo $row->text; ?>">
                                                <span class="time-input-wrapper">
                                                    <span class="is-inner-hour"><?php echo $time_arr[0] ?></span>:<span class="is-inner-min"><?php echo $time_arr[1] ?></span><span class="is-inner-type"><?php echo $time_type ?></span>
                                                </span>
                                                <a href="#" class="edit-input"></a>
                                                <a href="#" class="remove-input">x</a>
                                            </div>
                                            <?php
                                        }
                                    }
                                }
                            }
                        }
                        ?>
                    </div>
                </div>
                <a href="#" class="add-popup-focus"><span>+</span> Add <?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></a>
            </div>
            <div class="popup-daily-focus-decide">
                <h3><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?>: Decide</h3>
                <h6>Edit or confirm the days you will complete your <?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?> this week:</h6>
                <div class="focus-decide-wrapper">
                    <?php

                    for($i = -44; $i <=1; $i++){
                        ?>
                        <div class="focus-decide-items-wrapper <?php if ($i == 0) echo 'is-week-current'; ?>">
                            <button
                                    <?php
                                    if ($i >=0){
                                        foreach ($last_days_planned_arr as $day_planned){
                                            if ($day_planned == 1){
                                                echo 'class="active"';
                                            }
                                        }
                                    }
                                    ?>
                                    data-date="<?php echo date('Y-m-d',strtotime('Monday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?>">
                                Monday <?php echo date('d',strtotime('Monday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?></button>
                            <button
                                    <?php
                                    if ($i >=0){
                                        foreach ($last_days_planned_arr as $day_planned){
                                            if ($day_planned == 2){
                                                echo 'class="active"';
                                            }
                                        }
                                    }
                                    ?>
                                    data-date="<?php echo date('Y-m-d',strtotime('Tuesday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?>">
                                Tuesday <?php echo date('d',strtotime('Tuesday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?></button>
                            <button
                                    <?php
                                    if ($i >=0){
                                        foreach ($last_days_planned_arr as $day_planned){
                                            if ($day_planned == 3){
                                                echo 'class="active"';
                                            }
                                        }
                                    }
                                    ?>
                                    data-date="<?php echo date('Y-m-d',strtotime('Wednesday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?>">
                                Wednesday <?php echo date('d',strtotime('Wednesday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?></button>
                            <button
                                    <?php
                                    if ($i >=0){
                                        foreach ($last_days_planned_arr as $day_planned){
                                            if ($day_planned == 4){
                                                echo 'class="active"';
                                            }
                                        }
                                    }
                                    ?>
                                    data-date="<?php echo date('Y-m-d',strtotime('Thursday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?>">
                                Thursday <?php echo date('d',strtotime('Thursday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?></button>
                            <button
                                    <?php
                                    if ($i >=0){
                                        foreach ($last_days_planned_arr as $day_planned){
                                            if ($day_planned == 5){
                                                echo 'class="active"';
                                            }
                                        }
                                    }
                                    ?>
                                    data-date="<?php echo date('Y-m-d',strtotime('Friday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?>">
                                Friday <?php echo date('d',strtotime('Friday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?></button>
                            <button
                                    <?php
                                    if ($i >=0){
                                        foreach ($last_days_planned_arr as $day_planned){
                                            if ($day_planned == 6){
                                                echo 'class="active"';
                                            }
                                        }
                                    }
                                    ?>
                                    data-date="<?php echo date('Y-m-d',strtotime('Saturday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?>">
                                Saturday <?php echo date('d',strtotime('Saturday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?></button>
                            <button
                                    <?php
                                    if ($i >=0){
                                        foreach ($last_days_planned_arr as $day_planned){
                                            if ($day_planned == 7){
                                                echo 'class="active"';
                                            }
                                        }
                                    }
                                    ?>
                                    data-date="<?php echo date('Y-m-d',strtotime('Sunday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?>">
                                Sunday <?php echo date('d',strtotime('Sunday this week +'.$i.' week')  + $imitate_day_week * 7*86400); ?></button>
                        </div>
                        <?php
                    }
                    ?>
                </div>
            </div>
            <div class="popup-notes-wrapper">
                <h4>Notes</h4>
                <?php
                if ($rows_goals){
                    foreach ($rows_goals as $row){
                        ?>
                        <div class="popup-notes-textarea-wrapper is-filled" data-number="<?php echo $row->number; ?>">
                            <textarea class="popup-notes-textarea" readonly><?php echo $row->text; ?></textarea>
                            <a href="#" class="edit-input"></a>
                            <a href="#" class="remove-input">x</a>
                        </div>
                        <?php
                    }
                }
                else{
                    ?>
                    <div class="popup-notes-textarea-wrapper">
                        <textarea class="popup-notes-textarea"></textarea>
                        <a href="#" class="edit-input"></a>
                        <a href="#" class="remove-input">x</a>
                    </div>
                    <?php
                }
                ?>
                <a href="#" class="add-popup-note"><span>+</span> Add Note</a>
            </div>
            <button class="cancel-week-popup">Cancel</button>
            <button class="confirm-week-popup">Confirm This Weeks Plan</button>
        </div>
    </div>

    <div class="is-hidden-counter counter-daily-focus"><?php echo $number_last_focus; ?></div>
    <style>
        .add-focus-wrapper h3 {
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 17px;
            color: #000;
            line-height: 1;
            display: block;
            text-align: left;
            font-weight: 500;
            margin: 0 0 8px 0 !important;
        }

        .add-focus-wrapper h6 {
            display: block;
            position: relative;
            margin: 0 0 8px 0 !important;
            font-weight: 400;
            padding: 0;
            line-height: 1;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: rgba(0, 0, 0, 0.49);
            font-size: 11px;
            transition: 0.4s all;
            text-align: left;
        }

        .time-wrapper{
            text-align: left;
            margin: 0 0 8px 0;
        }

        .add-focus-wrapper .is-habit-popup{
            padding: 15px;
            background: #F5F2FE;
            box-shadow: 1px 1px 2px rgb(0 0 0 / 15%);
            max-width: 310px;
            border-radius: 7px;
        }
    </style>


    <style>
        .add-appointment-wrapper h3,
        .add-task-wrapper h3{
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 17px;
            color: #000;
            line-height: 1;
            display: block;
            text-align: left;
            font-weight: 500;
            margin: 0 0 8px 0 !important;
        }

        .add-appointment-wrapper p,
        .add-task-wrapper p {
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            line-height: 1.5;
            color: #000;
            font-weight: 400;
            text-align: left;
            font-size: 12px;
            margin: 0 0 6px 0;
        }

        .appointment-time-wrapper{
            text-align: left;
            margin: 0 0 8px 0;
        }

        .add-appointment-wrapper .is-habit-popup,
        .add-task-wrapper .is-habit-popup{
            padding: 15px;
            background: #F5F2FE;
            box-shadow: 1px 1px 2px rgb(0 0 0 / 15%);
            max-width: 310px;
            border-radius: 7px;
        }

        .cancel-appointment-popup,
        .cancel-task-popup{
            font-size: 14px !important;
            padding: 6px 10px !important;
            border-radius: 5px !important;
            display: inline-block !important;
            vertical-align: top;
            width: calc(40% - 2px) !important;
            background: linear-gradient(187.02deg, #FFFFFF -174.74%, rgba(248, 250, 255, 0.99) -60.77%, #FBFBFF 123.01%) !important;
            box-shadow: 2px 2px 6px rgb(0 0 0 / 5%) !important;
            color: rgba(58, 96, 255, 0.9) !important;
        }

        .save-appointment-popup,
        .save-task-popup {
            font-size: 14px !important;
            padding: 6px 10px !important;
            border-radius: 5px !important;
            display: inline-block !important;
            vertical-align: top;
            width: calc(60% - 2px) !important;
            background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%) !important;
            box-shadow: 1px 1px 3px 1px rgb(0 0 0 / 10%) !important;
        }

        .save-appointment-popup:hover,
        .save-appointment-popup:focus,
        .cancel-appointment-popup:hover,
        .cancel-appointment-popup:focus {
            opacity: 0.8;
        }

        .add-appointment-wrapper input,
        .add-task-wrapper input {
            width: 100%;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 20px;
            line-height: 18px;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
            margin: 0 0 14px 0;
        }

        .appointment-time-wrapper select {
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 20px;
            line-height: 18px;
            padding: 0 10px 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #9f9f9f !important;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
            margin: 0 0 10px 0;
            width: 40px;
            display: inline-block;
            vertical-align: top;
        }

        .appointment-time-wrapper-hour,
        .appointment-time-wrapper-min{
            width: 60px !important;
        }

        .add-appointment-wrapper input::placeholder,
        .add-task-wrapper input::placeholder{
            color: #9f9f9f !important;
        }
    </style>


    <style>
        .add-daily-actions-wrapper .is-habit-popup{
            background: #F5F6F8;
            border-radius: 12px;
            padding: 15px 22px;
            max-width: 560px;
        }

        .add-daily-actions-wrapper .popup-content-wrapper{
            min-height: 160px;
            margin-bottom: 15px;
            text-align: left;
        }

        .add-daily-actions-wrapper p {
            display: block;
            position: relative;
            margin: 0 0 18px 0 !important;
            font-weight: 400;
            padding: 0;
            line-height: 1.3;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #3F3F3F;
            font-size: 13px;
            transition: 0.4s all;
            text-align: center;
        }

        .popup-add-daily-action{
            color: rgba(0,0,0,0.3);
            position: relative;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            letter-spacing: 0;
            line-height: 1;
            font-size: 14px;
            transition: 0.4s all;
            padding-left: 17px;
            vertical-align: top;
        }

        .popup-add-daily-action:hover,
        .popup-add-daily-action:focus{
            color: rgba(0,0,0,1);
        }

        .popup-add-daily-action span {
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            display: block;
            position: absolute;
            color: #fff !important;
            left: 3px;
            top: 2px;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/add.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            opacity: 0.3;
            width: 11px;
            height: 11px;
            border-radius: 50%;
            line-height: 10px;
            letter-spacing: 0;
            text-align: center;
            font-size: 12px;
            transition: 0.4s all;
        }

        .popup-add-daily-action:hover span,
        .popup-add-daily-action:focus span{
            opacity: 1;
        }

        .is-habit-wrapper button.cancel-daily-actions{
            display: inline-block;
            width: 190px;
            margin-right: 20px;
            background: linear-gradient(296.38deg, #E9E9E9 -94.67%, rgba(255, 255, 255, 0.99) 104.07%, #FFFFFF 104.09%);
            box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
            color: #202020;
        }

        .is-habit-wrapper button.save-daily-actions{
            display: inline-block;
            width: calc(100% - 190px - 24px);
            background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%);
            box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
            color: #fff;
        }

        .is-habit-wrapper button.cancel-daily-actions:hover,
        .is-habit-wrapper button.cancel-daily-actions:focus{
            opacity: 0.8;
        }

        .is-habit-wrapper button.save-daily-actions:hover,
        .is-habit-wrapper button.save-daily-actions:focus{
            opacity: 0.8;
        }

        .popup-content-item{
            position: relative;
            margin: 0 0 5px 0;
        }

        .popup-content-item input{
            width: 100%;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px;
            height: 30px;
            line-height: 18px;
            padding: 0 5px;
            margin: 0 0 4px 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
        }

        .popup-content-item .edit-input,
        .popup-content-item .remove-input{
            top: 10px;
        }
    </style>
    <div class="add-daily-actions-wrapper is-habit-wrapper">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h2>Daily Actions</h2>
            <p>Daily Actions are the actions you need to “get done” each day.<br>
                If the action is performaned on a website, include a link for faster access. </p>
            <div class="popup-content-wrapper">
                <a href="#" class="popup-add-daily-action"><span>+</span> Add Daily Action</a>
            </div>
            <button class="cancel-daily-actions">Cancel</button>
            <button class="save-daily-actions">Save Daily Actions</button>
        </div>
    </div>

    <style>
        .add-single-action-wrapper h2{

        }

        .add-single-action-wrapper h3,
        .add-single-action-wrapper p{
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 16px;
            color: #000;
            font-weight: 600;
            line-height: 1;
            margin: 0 0 10px 0;
            text-align: left;
            display: block;
        }

        .add-single-action-wrapper p{
            display: inline-block;
            vertical-align: top;
            width: 50%;
            margin: 0;
            height: 24px;
            line-height: 24px;
        }


        .add-single-action-wrapper select{
            display: inline-block;
            vertical-align: top;
            border: none;
            height: 24px;
            line-height: 20px;
            width: calc(50% - 4px);
        }

        .checkboxes-wrapper{
            display: none;
        }

        .checkboxes-wrapper.show{
            display: block;
        }

        .checkboxes-wrapper label{
            float: left;
            width: 25%;
            background: transparent;
            margin: 10px 0 0 0;
            text-align: left;
        }

        .checkboxes-wrapper label:before{
            display: none;
        }

        .checkboxes-wrapper input{
            margin-right: 10px;
        }

        .checkboxes-wrapper:after{
            content: '';
            display: block;
            clear: both;
        }

        .action-name,
        .action-link{
            width: 100%;
            box-shadow: 1px 1px 4px 1px rgb(0 0 0 / 5%);
            border-radius: 5px;
            height: 24px;
            line-height: 18px;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            transition: 0.4s all;
            border: 1px solid transparent;
            resize: none;
            margin: 0 0 14px 0;
        }

        .action-name::placeholder,
        .action-link::placeholder{
            color: #9f9f9f !important;
        }

        .action-name:hover,
        .action-link:hover,
        .action-name:focus,
        .action-link:focus{
            border: 1px solid #777;
        }

        .is-habit-wrapper button.cancel-single-action{
            background: linear-gradient(296.38deg, #FBFBFB -94.67%, rgba(255, 255, 255, 0.99) 104.07%, #FFFFFF 104.09%);
            box-shadow: 1px 1px 3px 1px rgb(0 0 0 / 10%);
            border-radius: 6px;
            display: inline-block;
            width: 90px;
            margin-right: 10px;
            height: 24px;
            padding: 0 10px;
            line-height: 24px;
            font-size: 15px;
            color: #000;
            margin-top: 20px;
        }

        .is-habit-wrapper button.save-single-action{
            background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%);
            box-shadow: 1px 1px 3px 1px rgb(0 0 0 / 10%);
            border-radius: 6px;
            height: 24px;
            padding: 0 10px;
            line-height: 24px;
            display: inline-block;
            width: calc(100% - 90px - 14px);
            font-size: 15px;
            margin-top: 20px;
        }


        .is-habit-wrapper button.cancel-single-action:hover,
        .is-habit-wrapper button.cancel-single-action:focus,
        .is-habit-wrapper button.save-single-action:hover,
        .is-habit-wrapper button.save-single-action:focus{
            opacity: 0.8;
        }

        .add-single-action-wrapper .is-habit-popup{
            background: #F5F6F8;
            padding: 15px 20px;
        }

        .action-input-wrapper,
        .task-input-wrapper,
        .is-focus-input-wrapper{
            padding-left: 20px;
            position: relative;
            margin-bottom: 10px;
        }

        .action-input-wrapper.is-completed span,
        .action-input-wrapper.is-completed a,
        .task-input-wrapper.is-completed span,
        .is-focus-input-wrapper.is-completed span{
            text-decoration: line-through;
        }

        .action-input-wrapper button,
        .task-input-wrapper button,
        .is-focus-input-wrapper button{
            cursor: pointer;
            position: absolute;
            right: 10px;
            top: 4px;
            width: 14px;
            height: 14px;
            border: none;
            outline: none;
            box-shadow: none;
            background: #D9D9D9;
            border-radius: 50%;
        }

        .action-input-wrapper.is-completed button,
        .task-input-wrapper.is-completed button,
        .is-focus-input-wrapper.is-completed button{
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/completed.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
        }

        .action-input-wrapper:after,
        .task-input-wrapper:after,
        .is-focus-input-wrapper:after{
            content: '';
            display: block;
            clear: both;
            width: 5px;
            height: 5px;
            position: absolute;
            left: 7px;
            top: 9px;
            border-radius: 50%;
            background: #D9D9D9;
        }
    </style>
    <div class="add-single-action-wrapper is-habit-wrapper" data-checked="0">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h2>Daily Action</h2>
            <h3>Action:</h3>
            <input type="text" class="action-name" placeholder="Name your daily action">
            <h3>Link (Optional):</h3>
            <input type="text" class="action-link" placeholder="Paste URL here">
            <p>Repeat Action Every:</p>
            <select class="select-action-type">
                <option value="day">Day</option>
                <option value="week">Week</option>
            </select>
            <div class="checkboxes-wrapper">
                <label><input type="checkbox" class="checkbox-1">Mon</label>
                <label><input type="checkbox" class="checkbox-2">Tue</label>
                <label><input type="checkbox" class="checkbox-3">Wed</label>
                <label><input type="checkbox" class="checkbox-4">Thu</label>
                <label><input type="checkbox" class="checkbox-5">Fri</label>
                <label><input type="checkbox" class="checkbox-6">Sat</label>
                <label><input type="checkbox" class="checkbox-7">Sun</label>
            </div>
            <button class="cancel-single-action">Cancel</button>
            <button class="save-single-action">Save Daily Action</button>
        </div>
    </div>

    <style>
        .end-day-confirm-wrapper h3,
        .plan-tomorrow-wrapper h3,
        .end-day-review-wrapper h3{
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 17px;
            color: #000;
            font-weight: 600;
            line-height: 1;
            margin: 0 0 12px 0;
            text-align: center;
            display: block;
        }

        .end-day-confirm-wrapper h2,
        .plan-tomorrow-wrapper h2,
        .end-day-review-wrapper h2{
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 23px;
            color: #000;
            font-weight: 600;
            line-height: 1;
            margin: 0 0 12px 0;
            text-align: center;
            display: block;
        }

        .end-day-confirm-wrapper h2{
            color: #C90505;
        }

        .end-day-confirm-wrapper p,
        .plan-tomorrow-wrapper p,
        .end-day-review-wrapper p{
            display: block;
            position: relative;
            margin: 0 0 18px 0 !important;
            font-weight: 400;
            padding: 0;
            line-height: 1.3;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #434242;
            font-size: 13px;
            transition: 0.4s all;
            text-align: center;
        }

        .end-day-confirm-wrapper p.bigger{
            font-size: 15px;
            text-align: left;
        }

        .end-day-confirm-wrapper .is-habit-popup,
        .plan-tomorrow-wrapper .is-habit-popup{
            background: #fff;
            box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            padding: 15px 22px;
            max-width: 630px;
        }

        .end-day-review-wrapper .is-habit-popup{
            background: #fff;
            box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            padding: 15px 22px;
            max-width: 560px;
        }


        .my-goals-wrapper .is-habit-popup{
            background: rgb(235,236,255);
            box-shadow: 1px 1px 4px 1px rgba(10, 19, 255, 0.15);
            border-radius: 12px;
            padding: 20px 15px;
        }

        .is-habit-wrapper button.go-back-finish{
            background: linear-gradient(296.38deg, #FBFBFB -94.67%, rgba(255, 255, 255, 0.99) 104.07%, #FFFFFF 104.09%);
            box-shadow: 1px 1px 3px 0.2px rgba(2, 49, 170, 0.25);
            border-radius: 5px;
            display: inline-block;
            width: 350px;
            margin-right: 20px;
            color: #000;
            font-weight: 600;
        }

        .is-habit-wrapper button.confirm-end-day{
            background: linear-gradient(187.02deg, rgba(173, 211, 255, 0.9) -174.74%, rgba(94, 139, 255, 0.891) -60.77%, rgba(39, 74, 255, 0.9) 123.01%);
            box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            display: inline-block;
            width: calc(100% - 350px - 24px);
            font-weight: 600;
        }

        .is-habit-wrapper button:hover,
        .is-habit-wrapper button:focus{
            opacity: 0.8;
        }

        .end-day-focus-wrapper{
            background: #F5F2FE;
            box-shadow: 0.71px 0.71px 1.45px rgba(0, 0, 0, 0.15);
            border-radius: 7px;
            padding: 8px 7px;
            margin: 0 0 15px 0;
            position: relative;
        }

        .end-day-action-wrapper,
        .end-day-task-wrapper
        {
            background: #F5F5F5;
            box-shadow: 0.71px 0.71px 1.45px rgba(0, 0, 0, 0.15);
            border-radius: 7px;
            padding: 8px 7px;
            margin: 0 0 25px 0;
        }

        .end-day-action-wrapper{
            margin: 0 0 15px 0;
        }

        .end-day-action-wrapper h4,
        .end-day-focus-wrapper h4,
        .end-day-task-wrapper h4{
            display: block;
            position: relative;
            margin: 0 0 18px 0 !important;
            font-weight: 400;
            padding: 0;
            line-height: 1.3;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000000;
            font-size: 16px;
            transition: 0.4s all;
            text-align: left;
        }

        .end-day-action-item,
        .end-day-focus-item,
        .end-day-task-item{
            margin: 0 0 10px 0;
        }

        .end-day-focus-wrapper:after {
            display: block;
            content: '';
            background: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 14px;
            height: 18px;
            right: 10px;
            top: 6px;
            position: absolute;
            opacity: 0.4;
        }

        .end-day-action-item p,
        .end-day-focus-item p,
        .end-day-task-item p{
            position: relative;
            line-height: 1;
            margin: 0;
            padding: 0 0 0 20px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 14px;
            font-weight: 600;
            color: #CE0000;
            display: block;
            text-align: left;
        }

        .end-day-focus-item .time{
            position: absolute;
            left: -12px;
            top: -10px;
            line-height: 1;
            font-size: 10px;
            margin: 0;
            padding: 0 0 0 20px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-weight: 400;
            display: block;
            text-align: left;
            color: rgb(0,0,0,0.3);
        }

        .end-day-action-item p:before,
        .end-day-focus-item p:before,
        .end-day-task-item p:before{
            content: '';
            display: block;
            clear: both;
            width: 5px;
            height: 5px;
            position: absolute;
            left: 7px;
            top: 5px;
            border-radius: 50%;
            background: #D9D9D9;
        }

        .end-day-action-item p:after,
        .end-day-focus-item p:after,
        .end-day-task-item p:after{
            position: absolute;
            content: '...Pending';
            display: block;
            right: 10px;
            top: 0;
            font-weight: 500;
            color: #808080;
        }

        .is-habit-wrapper button.view-my-goals{
            background: linear-gradient(296.38deg, #FBFBFB -94.67%, rgba(255, 255, 255, 0.99) 104.07%, #FFFFFF 104.09%);
            box-shadow: 1px 1px 3px 0.2px rgb(2 49 170 / 25%);
            border-radius: 5px;
            display: inline-block;
            width: calc(100% - 350px - 24px);
            margin-right: 20px;
            color: #000;
            font-weight: 600;
        }

        .is-habit-wrapper button.confirm-tomorrow-plan{
            background: linear-gradient(187.02deg, rgba(173, 211, 255, 0.9) -174.74%, rgba(94, 139, 255, 0.891) -60.77%, rgba(39, 74, 255, 0.9) 123.01%);
            box-shadow: 1px 1px 3px 1px rgb(0 0 0 / 10%);
            border-radius: 5px;
            display: inline-block;
            width: 350px;
            font-weight: 600;
        }

        .my-goals-wrapper h3 {
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 15.5px;
            color: #434242;
            font-weight: 600;
            line-height: 1;
            margin: 0 0 12px 0;
            text-align: center;
            display: block;
        }

        .my-goals-wrapper p {
            color: #4F4F4F;
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 13px;
            font-weight: 500;
            line-height: 1;
            margin: 0 0 9px 0;
            text-align: left;
            display: block;
        }

        .my-goals-month-wrapper{
            min-height: 12px;
            margin-bottom: 12px;
        }

        .my-goals-week-wrapper{
            min-height: 12px;
        }

        .my-goals-month-wrapper p,
        .my-goals-week-wrapper p{
            color: #000;
            font-size: 12px;
            font-weight: 500;
            line-height: 1;
            margin: 0 0 12px 0;
            padding-left: 20px;
        }
    </style>
    <div class="end-day-confirm-wrapper is-habit-wrapper" data-checked="0">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3>End Of Day: Confirmation</h3>
            <h2><?php echo date('l',time() + $imitate_day * 86400)?> -
                <?php echo date('F',time() + $imitate_day * 86400)?> <?php echo $date_F.$date_F_add; ?></h2>
            <p>You still have tasks remaining, are you sure you want to end the day?</p>
            <p class="bigger">Pending Tasks:</p>
            <div class="end-day-action-wrapper">
                <h4>Daily Actions</h4>
            </div>
            <div class="end-day-focus-wrapper">
                <h4><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h4>
            </div>
            <div class="end-day-task-wrapper">
                <h4>Secondary Tasks</h4>
            </div>
            <button class="go-back-finish">Go Back To Finish What I Started</button>
            <button class="confirm-end-day">Confirm End Of Day</button>
        </div>
    </div>


    <style>
        .plan-notes-wrapper {
            background: #FCFDFE;
            box-shadow: 1px 2px 3px rgb(0 0 0 / 9%);
            padding: 9px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: left;
        }

        .plan-notes-wrapper h4 {
            line-height: 1;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 16px;
            font-weight: 600;
            color: #000;
            display: block;
            margin: 0;
            position: relative;
            cursor: pointer;
            transition: 0.4s all;
            text-align: left;
        }

        .plan-notes-wrapper h4:before {
            content: '>';
            transform: rotate(90deg) scaleY(1.5);
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 8px;
            transition: 0.4s all;
            position: absolute;
            right: 10px;
            top: 4px;
            line-height: 1;
        }

        .plan-notes-wrapper h4:hover:before {
            color: #274AFF;
        }

        .plan-notes-wrapper.opened h4:before {
            transform: rotate(90deg) scaleX(-1) scaleY(1.5);
        }

        .plan-notes-wrapper h4:hover,
        .plan-notes-wrapper h4:focus {
            color: #274AFF;
        }

        .plan-notes-textarea-wrapper {
            display: none;
            margin-top: 6px;
            position: relative;
        }

        .plan-notes-wrapper.opened .plan-notes-textarea-wrapper{
            display: block;
        }

        .plan-notes-textarea-wrapper.is-filled {
            /*display: block !important;*/
        }

        .plan-notes-textarea{
            width: 100%;
            resize: none;
            padding: 0 5px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 11px;
            line-height: 18px;
            transition: 0.4s all;
            border: 1px solid transparent;
            border-radius: 3px;
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            color: #000;
        }

        .plan-notes-textarea[readonly]{
             height: 20px;
             line-height: 18px;
             border: 1px solid transparent !important;
        }

        .plan-notes-wrapper .edit-input,
        .plan-notes-wrapper .remove-input{
            display: none;
        }

        .plan-notes-wrapper .is-filled .edit-input,
        .plan-notes-wrapper .is-filled .remove-input{
            display: block !important;
        }

        .add-plan-note {
            color: rgba(0,0,0,0.3);
            position: relative;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            letter-spacing: 0;
            line-height: 1;
            font-size: 10px;
            transition: 0.4s all;
            padding-left: 17px;
            vertical-align: top;
            display: none;
        }

        .add-plan-note:hover,
        .add-plan-note:focus {
             color: #000;
         }

        .add-plan-note span{
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            display: block;
            position: absolute;
            color: #fff !important;
            left: 5px;
            top: 1px;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/add.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            opacity: 0.3;
            width: 9px;
            height: 9px;
            border-radius: 50%;
            line-height: 9px;
            letter-spacing: 1px;
            text-align: center;
            font-size: 0;
            transition: 0.4s all;
        }

        .add-plan-note:hover span,
        .add-plan-note:focus span{
            opacity: 1;
        }

        .plan-notes-wrapper.opened .add-plan-note {
            display: inline;
        }

        .plan-daily-focus h4,
        .plan-second-tasks h4,
        .plan-appointments h4{
            font-family: 'avenir-next-lt-pro-r', sans-serif;
            font-size: 17px;
            color: #000;
            font-weight: 500;
            line-height: 1;
            margin: 0 0 7px 0;
            text-align: left;
            display: block;
        }

        .plan-daily-focus p,
        .plan-second-tasks p,
        .plan-appointments p{
            color: rgba(0,0,0,0.49);
            text-align: left;
        }

        .plan-daily-focus{
            background: #F5F2FE;
            min-height: 145px;
            margin-bottom: 20px;
            position: relative;
            box-shadow: 1px 1px 2px rgb(0 0 0 / 15%);
            border-radius: 6px;
            padding: 15px;
            text-align: left;
        }

        .plan-daily-focus:after{
            display: block;
            content: '';
            background: url(/wp-content/plugins/habit-planner/assets/img2/focus.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            width: 16px;
            height: 20px;
            right: 6px;
            top: 6px;
            position: absolute;
            opacity: 0.4;
        }

        .plan-second-tasks{
            background: #F8F8F8;
            min-height: 145px;
            margin-bottom: 20px;
            position: relative;
            box-shadow: 1px 1px 2px rgb(0 0 0 / 15%);
            border-radius: 6px;
            padding: 15px;
            text-align: left;
        }

        .plan-appointments{
            background: #F8F8F8;
            min-height: 145px;
            margin-bottom: 20px;
            position: relative;
            box-shadow: 1px 1px 2px rgb(0 0 0 / 15%);
            border-radius: 6px;
            padding: 15px;
            text-align: left;
        }

        .plan-appointments:after{
            display: block;
            content: '';
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            right: 10px;
            top: 10px;
            position: absolute;
            width: 17px;
            height: 16px;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/appointment.png);
        }

        .plan-daily-focus-items,
        .plan-appointments-items,
        .plan-second-tasks-items{

        }

        .plan-daily-focus-i{
            background: #fff;
            box-shadow: 1px 2px 4px 2px rgba(0, 0, 0, 0.02);
            border-radius: 6px;
            height: 24px;
            margin: 0 0 7px 0 !important;
            padding: 0 10px;
            position: relative;
        }

        .plan-appointments-i{
            background: #fff;
            box-shadow: 1px 2px 4px 2px rgba(0, 0, 0, 0.02);
            border-radius: 6px;
            height: 24px;
            margin: 0 0 7px 0 !important;
            padding: 0 10px;
            position: relative;
        }

        .plan-second-tasks-i{
            background: #fff;
            box-shadow: 1px 2px 4px 2px rgba(0, 0, 0, 0.02);
            border-radius: 6px;
            height: 24px;
            margin: 0 0 7px 0 !important;
            padding: 0 10px;
            position: relative;
        }

        .plan-appointments-i .time,
        .plan-daily-focus-i .time{
            position: absolute;
            right: 30px;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 12px;
            line-height: 1;
            color: rgba(0,0,0,0.6);
            top: 6px;
        }

        .plan-daily-focus-i .time{
            right: 27px;
        }

        .add-plan-task,
        .add-plan-appointment{
            color: rgba(0,0,0,0.3);
            position: relative;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            letter-spacing: 0;
            line-height: 1;
            font-size: 14px;
            transition: 0.4s all;
            padding-left: 17px;
            vertical-align: top;
        }

        .add-plan-task span,
        .add-plan-appointment span{
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            display: block;
            position: absolute;
            color: #fff !important;
            left: 3px;
            top: 2px;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/add.png);
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            opacity: 0.3;
            width: 11px;
            height: 11px;
            border-radius: 50%;
            line-height: 10px;
            letter-spacing: 0;
            text-align: center;
            font-size: 0;
            transition: 0.4s all;
        }

        .add-plan-task:hover,
        .add-plan-task:focus,
        .add-plan-appointment:hover,
        .add-plan-appointment:focus{
            color: rgba(0,0,0,1);
        }

        .add-plan-task:hover span,
        .add-plan-task:focus span,
        .add-plan-appointment:hover span,
        .add-plan-appointment:focus span {
            opacity: 1;
        }

        .plan-daily-focus-i .remove-input,
        .plan-second-tasks-i .remove-input,
        .plan-appointments-i .remove-input{
            top: 7px;
        }

        .plan-daily-focus-i .edit-input{
            top: 7px;
            right: 7px;
        }
    </style>
    <div class="plan-tomorrow-wrapper is-habit-wrapper" data-checked="0">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3>Final Step: Plan Tomorrow</h3>
            <h2><?php echo date("l",time() + ($imitate_day + 1) * 86400); ?> -
                <?php echo date("F",time() + ($imitate_day + 1) * 86400); ?> <?php echo $date_F_tomorrow.$date_F_add_tomorrow; ?></h2>
            <p>A great tomorrow start today! Edit or confirm tomorrow’s plan:</p>
            <div class="plan-daily-focus">
                <h4><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h4>
                <p>Edit or confirm the time you will complete your <?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?>:</p>
                <div class="plan-daily-focus-items">

                </div>
            </div>
            <div class="plan-second-tasks">
                <h4>Secondary Tasks</h4>
                <p>Edit or confirm the secondary tasks you will complete:</p>
                <div class="plan-second-tasks-items">

                </div>
                <a href="#" class="add-plan-task"><span>+</span> Add task</a>
            </div>
            <div class="plan-appointments">
                <h4>Appointments</h4>
                <p>Edit or confirm your appointments:</p>
                <div class="plan-appointments-items">

                </div>
                <a href="#" class="add-plan-appointment"><span>+</span> Add appointment</a>
            </div>
            <div class="plan-notes-wrapper">
                <h4>Notes</h4>
                <?php
                if ($rows_goals){
                    foreach ($rows_goals as $row){
                        ?>
                        <div class="plan-notes-textarea-wrapper is-filled" data-number="<?php echo $row->number; ?>">
                            <textarea class="plan-notes-textarea" readonly><?php echo $row->text; ?></textarea>
                            <a href="#" class="edit-input"></a>
                            <a href="#" class="remove-input">x</a>
                        </div>
                        <?php
                    }
                }
                else{
                    ?>
                    <div class="plan-notes-textarea-wrapper">
                        <textarea class="plan-notes-textarea"></textarea>
                        <a href="#" class="edit-input"></a>
                        <a href="#" class="remove-input">x</a>
                    </div>
                    <?php
                }
                ?>
                <a href="#" class="add-plan-note"><span>+</span> Add Note</a>
            </div>
            <button class="view-my-goals">View My Goals</button>
            <button class="confirm-tomorrow-plan">Confirm Tomorrow’s Plan</button>
        </div>
    </div>


    <style>
        .is-habit-popup .day-badges-wrapper{
            padding: 5px;
            background: linear-gradient(305.94deg, rgba(78, 84, 255, 0.13) 11.58%, rgba(208, 210, 255, 0.11) 131.25%);
            box-shadow: 0.8px 0.8px 3.23px 0.8px rgb(10 19 255 / 20%);
            border-radius: 6px;
            max-width: 160px;
            margin: 0 auto 20px;
        }

        .today-progress-wrapper{
            padding: 5px;
            background: linear-gradient(305.94deg, rgba(253, 255, 141, 0.13) 11.58%, rgba(208, 210, 255, 0.11) 131.25%);
            box-shadow: 1px 1px 4px 1px rgba(10, 19, 255, 0.15);
            border-radius: 8px;
            display: block;
            width: 100%;
            margin: 0 auto 20px;
        }

        .so-far-wrapper{
            padding: 5px;
            background: linear-gradient(305.94deg, rgba(189, 122, 255, 0.13) 11.58%, rgba(208, 210, 255, 0.11) 131.25%);
            box-shadow: 1px 1px 4px 1px rgba(10, 19, 255, 0.15);
            border-radius: 8px;
            display: block;
            width: 100%;
            margin: 0 auto 20px;
        }

        .today-progress-wrapper h4{
            display: block;
            position: relative;
            margin: 0 0 5px 0 !important;
            font-weight: 600;
            padding: 0;
            line-height: 1;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 10px;
            transition: 0.4s all;
            text-align: center;
        }

        .today-progress-wrapper h5{
            display: block;
            position: relative;
            margin: 0 0 5px 0 !important;
            font-weight: 500;
            padding: 0;
            line-height: 1;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #000;
            font-size: 10px;
            transition: 0.4s all;
            text-align: center;
        }

        .so-far-wrapper:after{
            content: '';
            display: block;
            clear: both;
        }

        .so-far-item{
            float: left;
            width: calc(100% / 7);
            position: relative;
        }

        .h3-badge-0, .h3-badge-1, .h3-badge-2{
            display: none !important;
        }

        .is-badge-0 .h3-badge-0,
        .is-badge-1 .h3-badge-1,
        .is-badge-2 .h3-badge-2{
            display: block !important;
        }

        .end-day-best-congrats{
            display: none;
        }

        .is-badge-2 .end-day-best-congrats,
        .is-badge-1 .end-day-best-congrats{
            display: block;
            content: '';
            width: 100px;
            height: 125px;
            margin: 0 auto 12px;
            background-color: transparent;
            background-size: contain;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            background-image: url(/wp-content/plugins/habit-planner/assets/img2/day-end-badge.png);
        }

        .day-badges-wrapper  h5 {
            display: block;
            line-height: 1;
            margin: 0 0 6px 0;
            text-align: center;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 10.5px;
            font-weight: 600;
            color: #1D1A1A;
        }

        .is-habit-wrapper button.complete-end-day{
            background: linear-gradient(187.02deg, #ADD3FF -174.74%, rgba(94, 139, 255, 0.99) -60.77%, #274AFF 123.01%);
            box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            display: block;
            width: 100%;
            font-weight: 600;
        }

        .end-day-circle-progress-wrapper{
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: transparent;
            position: relative;
            margin: 0 auto 10px;
            display: none;
            text-align: center;
        }

        .end-day-circle-progress-wrapper *{

        }

        .end-day-circle-progress-wrapper span{
            color: #2B5DFF;
            line-height: 120px;
            margin: 0;
            padding: 0;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-size: 24px;
            font-weight: 500;
            text-align: center;
            position: relative;
            z-index: 3;
        }

        .day-sidebar .end-day-circle-progress-wrapper{
            transform: scale(0.67647);
            margin-top: -15px;
            margin-bottom: -8px;
        }

        .today-progress-wrapper .progress-daily-focus,
        .today-progress-wrapper .progress-today-actions,
        .today-progress-wrapper .progress-today-second-tasks,
        .today-progress-wrapper .progress-daily-planning{
            display: inline-block;
            vertical-align: top;
            width: calc(25% - 3px);
        }

        .today-actions-circle{
            background: radial-gradient(50% 50% at 50% 50%, #99C8FF 34.9%, rgba(60, 114, 255, 0.99) 61.74%, #1434DF 100%)
        }

        .today-second-tasks-circle{
            background: radial-gradient(60% 60% at 50% 50%, #ADD3FF 34.9%, rgba(94, 139, 255, 0.99) 61.74%, #4D69FF 100%);
        }

        .today-progress-wrapper .day-progress-circle:before{
            background-color: #fffffa;
        }

        .end-day-plan-circle{
            position: absolute;
            background: radial-gradient(50% 50% at 50% 50%, #ECD664 34.9%, rgba(255, 229, 94, 0.99) 61.74%, #DF8114 100%) /* warning: gradient uses a rotation that is not supported by CSS and may not behave as expected */;
            width: 120px;
            height: 120px;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            border-radius: 50%;
        }
        .end-day-plan-circle:before {
            content: '';
            display: block;
            clear: both;
            position: absolute;
            width: calc(100% - 4px);
            height: calc(100% - 4px);
            top: 2px;
            left: 2px;
            background-color: #fff;
            border-radius: 50%;
            z-index: 2;
        }

        .end-day-plan-circle:after {
             content: '';
             display: block;
             clear: both;
             position: absolute;
             width: calc(100% + 2px);
             height: calc(100% + 2px);
             top: -1px;
             left: -1px;
             background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
             border-radius: 50%;
             z-index: 1;
         }

        .day-sidebar .end-day-plan-circle:before {
            background-color: #e6e6f5;
        }

        .end-day-tog-circle{
            position: absolute;
            background: radial-gradient(67% 67% at 49.32% 49.32%, #ADD3FF 0%, rgba(94, 139, 255, 0.99) 65.73%, #1434DF 72.64%);
            width: 110px;
            height: 110px;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            border-radius: 50%;
        }
        .end-day-tog-circle:before {
            content: '';
            display: block;
            clear: both;
            position: absolute;
            width: calc(100% - 12px);
            height: calc(100% - 12px);
            top: 6px;
            left: 6px;
            background-color: #fff;
            border-radius: 50%;
            z-index: 2;
        }

        .end-day-tog-circle:after {
            content: '';
            display: block;
            clear: both;
            position: absolute;
            width: calc(100% + 0px);
            height: calc(100% + 0px);
            top: 0;
            left: 0;
            background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
            border-radius: 50%;
            z-index: 1;
        }

        .day-sidebar .end-day-tog-circle:before {
            background-color: #e6e6f5;
        }


        .end-day-fcs-circle{
            position: absolute;
            background: radial-gradient(60% 60% at 50% 50%, rgba(72, 123, 255, 0.99) 14.58%, #531DEB 59.9%, #A21AE2 94.79%);
            width: 90px;
            height: 90px;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            border-radius: 50%;
            display: block;
        }
        .end-day-fcs-circle:before {
            content: '';
            display: block;
            clear: both;
            position: absolute;
            width: calc(100% - 16px);
            height: calc(100% - 16px);
            top: 8px;
            left: 8px;
            background-color: #fff;
            border-radius: 50%;
            z-index: 2;
        }

        .end-day-fcs-circle:after {
            content: '';
            display: block;
            clear: both;
            position: absolute;
            width: calc(100% + 0px);
            height: calc(100% + 0px);
            top: 0;
            left: 0;
            background: conic-gradient(transparent calc(var(--ratio) * 360deg), #D9D9D9 calc(var(--ratio) * 360deg) 360deg);
            border-radius: 50%;
            z-index: 1;
        }

        .day-sidebar .end-day-fcs-circle:before {
            background-color: #e6e6f5;
        }

        .so-far-item .end-day-circle-progress-wrapper{
            transform: scale(0.4);
            margin-left: -25px;
            margin-top: -50px;
            margin-bottom: -30px;
            display: block !important;
            opacity: 0;
        }

        .so-far-item.is-current-day .end-day-circle-progress-wrapper{
            opacity: 1;
        }

        .so-far-item .is-line{
            display: block;
            position: relative;
            transform: none;
            font-size: 30px;
            margin: -8px 0 0 0 !important;
            padding: 0;
            line-height: 1;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            font-weight: 300;
            text-align: center;
            color: #000;
        }

        .so-far-item.is-current-day .is-line{
            display: none;
        }

        .so-far-item .end-day-plan-circle:before,
        .so-far-item .end-day-tog-circle:before,
        .so-far-item .end-day-fcs-circle:before {
            background-color: #f7eeff;
        }

        html body .is-week-previous .week-day:hover .add-week-task,
        html body .is-week-previous .week-day:focus .add-week-task,
        html body .is-week-previous .week-day:hover .add-week-appointment,
        html body .is-week-previous .week-day:focus .add-week-appointment{
            display: none !important;
        }

        .so-far-item.else-day .end-day-circle-progress-wrapper{
            opacity: 1 !important;
        }
    </style>
    <img style="display: none" alt="img-hidden" src="/wp-content/plugins/habit-planner/assets/img2/day-end-badge.png">
    <div class="end-day-review-wrapper is-habit-wrapper" data-checked="0">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3>End Of Day Review</h3>
            <h2><?php echo date('l',time()  + $imitate_day * 86400)?> -
                <?php echo date('F',time()  + $imitate_day * 86400)?> <?php echo $date_F.$date_F_add; ?></h2>
            <div class="end-day-best-congrats"></div>
            <h3 class="h3-badge-2 h3-badge-1">Congratulations!</h3>
            <div class="end-day-circle-progress-wrapper">
                <div class="end-day-plan-circle" style="--ratio:1;"></div>
                <div class="end-day-tog-circle" style="--ratio:0;"></div>
                <div class="end-day-fcs-circle" style="--ratio:0;"></div>
                <span class="numbers">0</span>
                <span>%</span>
            </div>
            <h3 class="h3-badge-0">Nice Work!</h3>
            <p class="p-badge-1">You Earned 1 Badge:</p>
            <div class="day-badges-wrapper day-badge-1">
                <div class="day-badge">
                    <div class="badge-icon badge-icon-daily-focus"></div>
                    <h5><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h5>
                </div>
                <div class="day-badge">
                    <span>-</span>
                    <div class="badge-icon"></div>
                    <h5>Perfect Day</h5>
                </div>
            </div>
            <p class="p-badge-2">You Earned 2 Badges:</p>
            <div class="day-badges-wrapper day-badge-2">
                <div class="day-badge">
                    <div class="badge-icon badge-icon-daily-focus"></div>
                    <h5><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h5>
                </div>
                <div class="day-badge">
                    <div class="badge-icon badge-icon-perfect-day"></div>
                    <h5>Perfect Day</h5>
                </div>
            </div>
            <p><strong>Today’s progress</strong></p>
            <div class="today-progress-wrapper">
                <div class="progress-daily-focus">
                    <h4><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h4>
                    <div class="day-progress-circle daily-focus-circle" style="--ratio: <?php echo $today_focus_all ? $today_focus_completed / $today_focus_all : '0'; ?>">
                        <span class="numbers"><?php echo $today_focus_all ? round($today_focus_completed / $today_focus_all * 100 ) : '0'; ?></span><span>%</span>
                    </div>
                    <h5><span class="current"><?php echo $today_focus_completed; ?></span>/<span class="all"><?php echo $today_focus_all; ?></span> Complete</h5>
                </div>
                <div class="progress-today-actions">
                    <h4>Daily Actions</h4>
                    <div class="day-progress-circle today-actions-circle">
                        <span>0</span><span>%</span>
                    </div>
                    <h5><span class="current">0</span>/<span class="all">0</span> Complete</h5>
                </div>
                <div class="progress-today-second-tasks">
                    <h4>Todays Tasks</h4>
                    <div class="day-progress-circle today-second-tasks-circle">
                        <span>0</span><span>%</span>
                    </div>
                    <h5><span class="current">0</span>/<span class="all">0</span> Complete</h5>
                </div>
                <div class="progress-daily-planning">
                    <h4>Daily Planning</h4>
                    <div class="day-progress-circle daily-planning-circle" style="--ratio:1;">
                        <span>100</span><span>%</span>
                    </div>
                    <h5>Plan Tomorrow</h5>
                </div>
            </div>
            <p><strong>Your week so far</strong></p>
            <?php
            $is_today_so_far = date('N',time()  + $imitate_day * 86400);

            $so_far_planned_1 = $wpdb->get_results("
                SELECT * FROM ".$wpdb->prefix."habit_data 
                WHERE user_id=".get_current_user_id()." 
                AND type='day_planned' 
                AND date_created='".date('Y-m-d',strtotime('Monday this week')  + $imitate_day_week * 7*86400)."'
                ORDER BY number ASC
            ");
            $so_far_planned_2 = $wpdb->get_results("
                SELECT * FROM ".$wpdb->prefix."habit_data 
                WHERE user_id=".get_current_user_id()." 
                AND type='day_planned' 
                AND date_created='".date('Y-m-d',strtotime('Tuesday this week')  + $imitate_day_week * 7*86400)."'
                ORDER BY number ASC
            ");
            $so_far_planned_3 = $wpdb->get_results("
                SELECT * FROM ".$wpdb->prefix."habit_data 
                WHERE user_id=".get_current_user_id()." 
                AND type='day_planned' 
                AND date_created='".date('Y-m-d',strtotime('Wednesday this week')  + $imitate_day_week * 7*86400)."'
                ORDER BY number ASC
            ");
            $so_far_planned_4 = $wpdb->get_results("
                SELECT * FROM ".$wpdb->prefix."habit_data 
                WHERE user_id=".get_current_user_id()." 
                AND type='day_planned' 
                AND date_created='".date('Y-m-d',strtotime('Thursday this week')  + $imitate_day_week * 7*86400)."'
                ORDER BY number ASC
            ");
            $so_far_planned_5 = $wpdb->get_results("
                SELECT * FROM ".$wpdb->prefix."habit_data 
                WHERE user_id=".get_current_user_id()." 
                AND type='day_planned' 
                AND date_created='".date('Y-m-d',strtotime('Friday this week')  + $imitate_day_week * 7*86400)."'
                ORDER BY number ASC
            ");
            $so_far_planned_6 = $wpdb->get_results("
                SELECT * FROM ".$wpdb->prefix."habit_data 
                WHERE user_id=".get_current_user_id()." 
                AND type='day_planned' 
                AND date_created='".date('Y-m-d',strtotime('Saturday this week')  + $imitate_day_week * 7*86400)."'
                ORDER BY number ASC
            ");
            $so_far_planned_7 = $wpdb->get_results("
                SELECT * FROM ".$wpdb->prefix."habit_data 
                WHERE user_id=".get_current_user_id()." 
                AND type='day_planned' 
                AND date_created='".date('Y-m-d',strtotime('Sunday this week')  + $imitate_day_week * 7*86400)."'
                ORDER BY number ASC
            ");
            ?>
            <div class="so-far-wrapper">
                <div class="so-far-item <?php echo ($is_today_so_far == 1) ? 'is-current-day' : 'else-day'; ?>">
                    <p>Monday</p>
                    <?php
                    if ($so_far_planned_1){
                        $so_far_planned_arr = explode(',',$so_far_planned_1[0]->text);
                        ?>
                        <div class="end-day-circle-progress-wrapper">
                            <div class="end-day-plan-circle" style="--ratio:<?php echo $so_far_planned_arr[0] ?>;"></div>
                            <div class="end-day-tog-circle" style="--ratio:<?php echo $so_far_planned_arr[1] ?>;"></div>
                            <div class="end-day-fcs-circle" style="--ratio:<?php echo $so_far_planned_arr[2] ?>;"></div>
                            <span class="numbers"><?php echo $so_far_planned_arr[3] ?></span>
                            <span>%</span>
                        </div>
                        <?php
                    }
                    else{
                        ?>
                        <p class="is-line">-</p>
                        <?php
                        if ($is_today_so_far == 1){
                            ?>
                            <div class="end-day-circle-progress-wrapper">
                                <div class="end-day-plan-circle" style="--ratio:1"></div>
                                <div class="end-day-tog-circle" style="--ratio:1"></div>
                                <div class="end-day-fcs-circle" style="--ratio:1"></div>
                                <span class="numbers">100</span>
                                <span>%</span>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="so-far-item <?php echo ($is_today_so_far == 2) ? 'is-current-day' : 'else-day'; ?>">
                    <p>Tuesday</p>
                    <?php
                    if ($so_far_planned_2){
                        $so_far_planned_arr = explode(',',$so_far_planned_2[0]->text);
                        ?>
                        <div class="end-day-circle-progress-wrapper">
                            <div class="end-day-plan-circle" style="--ratio:<?php echo $so_far_planned_arr[0] ?>;"></div>
                            <div class="end-day-tog-circle" style="--ratio:<?php echo $so_far_planned_arr[1] ?>;"></div>
                            <div class="end-day-fcs-circle" style="--ratio:<?php echo $so_far_planned_arr[2] ?>;"></div>
                            <span class="numbers"><?php echo $so_far_planned_arr[3] ?></span>
                            <span>%</span>
                        </div>
                        <?php
                    }
                    else{
                        ?>
                        <p class="is-line">-</p>
                        <?php
                        if ($is_today_so_far == 2){
                            ?>
                            <div class="end-day-circle-progress-wrapper">
                                <div class="end-day-plan-circle" style="--ratio:1"></div>
                                <div class="end-day-tog-circle" style="--ratio:1"></div>
                                <div class="end-day-fcs-circle" style="--ratio:1"></div>
                                <span class="numbers">100</span>
                                <span>%</span>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="so-far-item <?php echo ($is_today_so_far == 3) ? 'is-current-day' : 'else-day'; ?>">
                    <p>Wednesday</p>
                    <?php
                    if ($so_far_planned_3){
                        $so_far_planned_arr = explode(',',$so_far_planned_3[0]->text);
                        ?>
                        <div class="end-day-circle-progress-wrapper">
                            <div class="end-day-plan-circle" style="--ratio:<?php echo $so_far_planned_arr[0] ?>;"></div>
                            <div class="end-day-tog-circle" style="--ratio:<?php echo $so_far_planned_arr[1] ?>;"></div>
                            <div class="end-day-fcs-circle" style="--ratio:<?php echo $so_far_planned_arr[2] ?>;"></div>
                            <span class="numbers"><?php echo $so_far_planned_arr[3] ?></span>
                            <span>%</span>
                        </div>
                        <?php
                    }
                    else{
                        ?>
                        <p class="is-line">-</p>
                        <?php
                        if ($is_today_so_far == 3){
                            ?>
                            <div class="end-day-circle-progress-wrapper">
                                <div class="end-day-plan-circle" style="--ratio:1"></div>
                                <div class="end-day-tog-circle" style="--ratio:1"></div>
                                <div class="end-day-fcs-circle" style="--ratio:1"></div>
                                <span class="numbers">100</span>
                                <span>%</span>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="so-far-item <?php echo ($is_today_so_far == 4) ? 'is-current-day' : 'else-day'; ?>">
                    <p>Thursday</p>
                    <?php
                    if ($so_far_planned_4){
                        $so_far_planned_arr = explode(',',$so_far_planned_4[0]->text);
                        ?>
                        <div class="end-day-circle-progress-wrapper">
                            <div class="end-day-plan-circle" style="--ratio:<?php echo $so_far_planned_arr[0] ?>;"></div>
                            <div class="end-day-tog-circle" style="--ratio:<?php echo $so_far_planned_arr[1] ?>;"></div>
                            <div class="end-day-fcs-circle" style="--ratio:<?php echo $so_far_planned_arr[2] ?>;"></div>
                            <span class="numbers"><?php echo $so_far_planned_arr[3] ?></span>
                            <span>%</span>
                        </div>
                        <?php
                    }
                    else{
                        ?>
                        <p class="is-line">-</p>
                        <?php
                        if ($is_today_so_far == 4){
                            ?>
                            <div class="end-day-circle-progress-wrapper">
                                <div class="end-day-plan-circle" style="--ratio:1"></div>
                                <div class="end-day-tog-circle" style="--ratio:1"></div>
                                <div class="end-day-fcs-circle" style="--ratio:1"></div>
                                <span class="numbers">100</span>
                                <span>%</span>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="so-far-item <?php echo ($is_today_so_far == 5) ? 'is-current-day' : 'else-day'; ?>">
                    <p>Friday</p>
                    <?php
                    if ($so_far_planned_5){
                        $so_far_planned_arr = explode(',',$so_far_planned_5[0]->text);
                        ?>
                        <div class="end-day-circle-progress-wrapper">
                            <div class="end-day-plan-circle" style="--ratio:<?php echo $so_far_planned_arr[0] ?>;"></div>
                            <div class="end-day-tog-circle" style="--ratio:<?php echo $so_far_planned_arr[1] ?>;"></div>
                            <div class="end-day-fcs-circle" style="--ratio:<?php echo $so_far_planned_arr[2] ?>;"></div>
                            <span class="numbers"><?php echo $so_far_planned_arr[3] ?></span>
                            <span>%</span>
                        </div>
                        <?php
                    }
                    else{
                        ?>
                        <p class="is-line">-</p>
                        <?php
                        if ($is_today_so_far == 5){
                            ?>
                            <div class="end-day-circle-progress-wrapper">
                                <div class="end-day-plan-circle" style="--ratio:1"></div>
                                <div class="end-day-tog-circle" style="--ratio:1"></div>
                                <div class="end-day-fcs-circle" style="--ratio:1"></div>
                                <span class="numbers">100</span>
                                <span>%</span>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="so-far-item <?php echo ($is_today_so_far == 6) ? 'is-current-day' : 'else-day'; ?>">
                    <p>Saturday</p>
                    <?php
                    if ($so_far_planned_6){
                        $so_far_planned_arr = explode(',',$so_far_planned_6[0]->text);
                        ?>
                        <div class="end-day-circle-progress-wrapper">
                            <div class="end-day-plan-circle" style="--ratio:<?php echo $so_far_planned_arr[0] ?>;"></div>
                            <div class="end-day-tog-circle" style="--ratio:<?php echo $so_far_planned_arr[1] ?>;"></div>
                            <div class="end-day-fcs-circle" style="--ratio:<?php echo $so_far_planned_arr[2] ?>;"></div>
                            <span class="numbers"><?php echo $so_far_planned_arr[3] ?></span>
                            <span>%</span>
                        </div>
                        <?php
                    }
                    else{
                        ?>
                        <p class="is-line">-</p>
                        <?php
                        if ($is_today_so_far == 6){
                            ?>
                            <div class="end-day-circle-progress-wrapper">
                                <div class="end-day-plan-circle" style="--ratio:1"></div>
                                <div class="end-day-tog-circle" style="--ratio:1"></div>
                                <div class="end-day-fcs-circle" style="--ratio:1"></div>
                                <span class="numbers">100</span>
                                <span>%</span>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="so-far-item <?php echo ($is_today_so_far == 7) ? 'is-current-day' : 'else-day'; ?>">
                    <p>Sunday</p>
                    <?php
                    if ($so_far_planned_7){
                        $so_far_planned_arr = explode(',',$so_far_planned_7[0]->text);
                        ?>
                        <div class="end-day-circle-progress-wrapper">
                            <div class="end-day-plan-circle" style="--ratio:<?php echo $so_far_planned_arr[0] ?>;"></div>
                            <div class="end-day-tog-circle" style="--ratio:<?php echo $so_far_planned_arr[1] ?>;"></div>
                            <div class="end-day-fcs-circle" style="--ratio:<?php echo $so_far_planned_arr[2] ?>;"></div>
                            <span class="numbers"><?php echo $so_far_planned_arr[3] ?></span>
                            <span>%</span>
                        </div>
                        <?php
                    }
                    else{
                        ?>
                        <p class="is-line">-</p>
                        <?php
                        if ($is_today_so_far == 7){
                            ?>
                            <div class="end-day-circle-progress-wrapper">
                                <div class="end-day-plan-circle" style="--ratio:1"></div>
                                <div class="end-day-tog-circle" style="--ratio:1"></div>
                                <div class="end-day-fcs-circle" style="--ratio:1"></div>
                                <span class="numbers">100</span>
                                <span>%</span>
                            </div>
                            <?php
                        }
                    }
                    ?>
                </div>
            </div>
            <button class="complete-end-day">Complete End Of Day Reflection</button>
        </div>
    </div>

    <div class="my-goals-wrapper is-habit-wrapper" data-checked="0">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3>My Goals</h3>
            <p>Month:</p>
            <div class="my-goals-month-wrapper">

            </div>
            <p>Week:</p>
            <div class="my-goals-week-wrapper">

            </div>
        </div>
    </div>

    <div class="add-appointment-wrapper is-habit-wrapper" data-date="" data-is-plan="0">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3>Add Appointment</h3>
            <p>Name:</p>
            <input type="text" class="name-add-appointment" placeholder="Name">
            <p>Time of appointment:</p>
            <div class="appointment-time-wrapper">
                <select class="appointment-time-wrapper-hour">
                    <option value="" selected disabled>Hour</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                </select>
                <select class="appointment-time-wrapper-min">
                    <option value="" selected disabled>Min</option>
                    <option value="00">00</option>
                    <option value="05">05</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                    <option value="25">25</option>
                    <option value="30">30</option>
                    <option value="35">35</option>
                    <option value="40">40</option>
                    <option value="45">45</option>
                    <option value="50">50</option>
                    <option value="55">55</option>
                </select>
                <select class="appointment-time-wrapper-type">
                    <option value="am">am</option>
                    <option value="pm">pm</option>
                </select>
            </div>
            <button class="cancel-appointment-popup">Cancel</button>
            <button class="save-appointment-popup">Add Appointment</button>
        </div>
    </div>

    <div class="add-task-wrapper is-habit-wrapper" data-date="">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3>Add Task</h3>
            <p>Name:</p>
            <input type="text" class="name-add-task" placeholder="Name">
            <button class="cancel-task-popup">Cancel</button>
            <button class="save-task-popup">Add Task</button>
        </div>
    </div>

    <style>
        .select-time-routine{
            box-shadow: 1px 2px 4px 2px rgb(0 0 0 / 2%);
            border-radius: 3px !important;
            height: 20px !important;
            line-height: 18px !important;
            padding: 0 10px 0 5px !important;
            font-family: 'avenir-next-lt-pro-r', sans-serif !important;
            color: #9f9f9f !important;
            font-size: 12px !important;
            transition: 0.4s all;
            border: 1px solid transparent !important;
            resize: none;
            margin: 0 0 10px 0;
            width: 80px !important;
            display: inline-block;
            vertical-align: top;
            float: left;
        }

        .select-time-routine + *{
            clear: both;
        }
    </style>
    <div class="add-focus-wrapper is-habit-wrapper" data-is-plan="0">
        <div class="is-habit-popup">
            <a href="#" class="popup-close">X</a>
            <h3><?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></h3>
            <p>Name:</p>
            <input type="text" class="name-your-daily-focus" placeholder="Name your <?php if ($user_routines) {echo 'daily routine';}else{echo 'daily focus';} ?>">

            <?php
            if ($user_routines) {
                ?>
                <p>Select a time of routine:</p>
                <select class="select-time-routine">
                    <option selected disabled></option>
                    <option value="night">Night</option>
                    <option value="morning">Morning</option>
                </select>
                <?php
            }
            ?>

            <p>Select a time to complete your <?php if ($user_routines) {echo 'daily routine';}else{echo 'daily focus';} ?>:</p>
            <h6>You can always change this later</h6>
            <div class="time-wrapper">
                <select class="time-wrapper-hour">
                    <option value="" selected disabled>Hour</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                </select>
                <select class="time-wrapper-min">
                    <option value="" selected disabled>Min</option>
                    <option value="00">00</option>
                    <option value="05">05</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                    <option value="25">25</option>
                    <option value="30">30</option>
                    <option value="35">35</option>
                    <option value="40">40</option>
                    <option value="45">45</option>
                    <option value="50">50</option>
                    <option value="55">55</option>
                </select>
                <select class="time-wrapper-type">
                    <option value="am">am</option>
                    <option value="pm">pm</option>
                </select>
            </div>
            <button class="cancel-focus-popup">Cancel</button>
            <button class="save-focus-popup">Save <?php if ($user_routines) {echo 'Daily Routine';}else{echo 'Daily Focus';} ?></button>
        </div>
    </div>

    <script>
        (function ($) {

            <?php
            if ($user_routines){
                ?>
                $(".day-daily-focus").after($(".day-daily-actions"));
                <?php
            }
            ?>

            var ajaxurl = '<?php echo admin_url('admin-ajax.php'); ?>';

            var daily_counter = 0;
            var is_daily_edit = 0;


            var week_goal_number = parseInt($('.counter-week-goals').text());

            var appointment_counter = parseInt($('.counter-appointments').text());

            var task_current = parseInt($('.progress-today-tasks h5 .current').text());
            var task_all = parseInt($('.progress-today-tasks h5 .all').text());

            var focus_current = parseInt($('.progress-daily-focus h5 .current').text());
            var focus_all = parseInt($('.progress-daily-focus h5 .all').text());


            $('.is-week-previous .week-day.perfect-day').each(function(){
                $('.month-day[data-date="'+$(this).attr('data-date')+'"]').addClass('day-with-perfect');
            });

            $('.is-week-previous .week-day.good-day').each(function(){
                $('.month-day[data-date="'+$(this).attr('data-date')+'"]').addClass('day-with-focus');
            });

            $('.past-week-badges .have-perfect').each(function(){
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-1')+'"]').addClass('day-with-best').addClass('day-best-focus');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-2')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-3')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-4')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-5')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-6')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-7')+'"]').addClass('day-with-best');
            });

            $('.past-week-badges .have-best').each(function(){
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-1')+'"]').addClass('day-with-best').addClass('day-best-all');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-2')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-3')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-4')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-5')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-6')+'"]').addClass('day-with-best');
                $('.month-day[data-date="'+$(this).closest('.past-week-badges').attr('data-date-7')+'"]').addClass('day-with-best');
            });

            $(document).on('change','#settings-focus-mode',function(){
                if ($(this).is(':checked')){
                    $('#settings-routines').removeAttr('checked');
                    $('#settings-routines').prop('checked',false);
                }
                else{
                    $('#settings-routines').attr('checked','checked');
                    $('#settings-routines').prop('checked',true);
                }
            });

            $(document).on('change','#settings-routines',function(){
                if ($(this).is(':checked')){
                    $('#settings-focus-mode').removeAttr('checked');
                    $('#settings-focus-mode').prop('checked',false);
                }
                else{
                    $('#settings-focus-mode').attr('checked','checked');
                    $('#settings-focus-mode').prop('checked',true);
                }
            });


            $(document).on('click', '.habit-plugin-tabs a', function (e) {
                e.preventDefault();
                $('.habit-plugin-tabs a.active').removeClass('active');

                $(this).addClass('active');
                var link = $(this).attr('data-link');

                $('.is-habit-tab.show').removeClass('show');
                $('.is-habit-tab.' + link).first().addClass('show');
            });

            var user_settings_update = {
                action: 'user_settings_update',
                user_id: <?php echo get_current_user_id() ?>,
                user_timezone: '',
                user_date_display: '',
                user_routines: ''
            };

            var add_habit_month_goal = {
                action: 'add_habit_month_goal',
                user_id: <?php echo get_current_user_id() ?>,
                text: '',
                number: '',
                type: ''
            };

            var add_habit_week_goal = {
                action: 'add_habit_week_goal',
                user_id: <?php echo get_current_user_id() ?>,
                text: '',
                number: '',
                type: '',
                date_created: ''
            };

            var add_habit_note = {
                action: 'add_habit_note',
                user_id: <?php echo get_current_user_id() ?>,
                text: '',
                number: '',
                type: ''
            };

            var add_month_action = {
                action: 'add_month_action',
                user_id: <?php echo get_current_user_id() ?>,
                text: '',
                number: '',
                type: '',
                dates_arr: []
            };

            var add_week_task = {
                action: 'add_week_task',
                user_id: <?php echo get_current_user_id() ?>,
                text: '',
                number: '',
                type: '',
                date_created: ''
            };

            var add_week_appointment = {
                action: 'add_week_appointment',
                user_id: <?php echo get_current_user_id() ?>,
                text: '',
                action_time: '',
                number: '',
                type: '',
                date_created: ''
            };

            var add_daily_action = {
                action: 'add_daily_action',
                user_id: <?php echo get_current_user_id() ?>,
                type: '',
                actions_arr: [],
                date_created: ''
            };

            var plan_tomorrow_day = {
                action: 'plan_tomorrow_day',
                user_id: <?php echo get_current_user_id() ?>,
                date_today: '',
                date_tomorrow: '',
                day_badge: '',
                badge_stats: '',
                arr_focus: [],
                arr_tasks: [],
                arr_appointments: []
            };


            var plan_your_week = {
                action: 'plan_your_week',
                user_id: <?php echo get_current_user_id() ?>,
                week_start_date: '',
                week_today_date: '',
                goal_arr: [],
                focus_arr: [],
                dates_arr: []
            };


            var habit_check_uncheck_item = {
                action: 'habit_check_uncheck_item',
                user_id: <?php echo get_current_user_id() ?>,
                type: '',
                number: '',
                date_created: '',
                completed: ''
            };

            var remove_habit_item = {
                action: 'remove_habit_item',
                user_id: <?php echo get_current_user_id() ?>,
                type: '',
                number: '',
                date_created: ''
            };

            $(document).on('click','.edit-settings-button',function(){
                $('.popup-settings-wrapper').addClass('show');
            });

            $(document).on('click','.save-settings-popup',function(e){
                e.preventDefault();

                user_settings_update.user_timezone = $('.user_timezone').val();
                user_settings_update.user_date_display = $('.user_date_display').val();
                if ($('#settings-focus-mode').is(':checked')){
                    user_settings_update.user_routines = '';
                }
                else{
                    user_settings_update.user_routines = 'on';
                }
                if ($('#settings-routines').is(':checked')){
                    user_settings_update.user_routines = 'on';
                }
                else{
                    user_settings_update.user_routines = '';
                }

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, user_settings_update)
                    .done(function (msg) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        location.reload();
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });


            $(document).on('click','.cancel-settings-popup',function(){
                $('.popup-settings-wrapper').removeClass('show');
            });

            $(document).on('click','.is-habit-wrapper',function(e){
                e.preventDefault();
                $(this).removeClass('show');
            });

            $(document).on('click','.is-habit-popup',function(e){
                e.stopPropagation();
            });


            $(document).on('change','.add-focus-wrapper .time-wrapper-type',function(){
                if ($(this).val() == 'am'){
                    $('.select-time-routine').val('morning');
                }
                else{
                    $('.select-time-routine').val('night');
                }
            });

            $(document).on('change','.select-time-routine',function(){
                if ($(this).val() == 'morning'){
                    $('.add-focus-wrapper .time-wrapper-type').val('am');
                }
                else{
                    $('.add-focus-wrapper .time-wrapper-type').val('pm');
                }
            });



            $(document).on('click','.is-habit-wrapper:not(.add-focus-wrapper):not(.add-single-action-wrapper):not(.my-goals-wrapper) .popup-close',function(e){
                e.preventDefault();
                $('.is-habit-wrapper').removeClass('show');
            });

            $(document).on('click','.month-day:not(.is-previous-day):not(.is-empty-day)',function(){
                $(this).toggleClass('selected');

                if ($('.month-day.selected').length > 0){
                    $('.month-action-add').addClass('active');
                }
                else{
                    $('.month-action-add').removeClass('active');
                }
            });

            $(document).on('click','.notes-wrapper h4',function(){
                $(this).parent().toggleClass('opened');
            });

            $(document).on('click','.add-month-goal',function(e){
                e.preventDefault();
                if ($('.this-month-goals-textarea-wrapper:not(.is-filled)').length < 1){
                    $('' +
                        '<div class="this-month-goals-textarea-wrapper">' +
                        '<textarea class="this-month-goals-textarea"></textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>' +
                        '').insertBefore($(this));
                }
            });

            $(document).on('click','.add-month-note',function(e){
                e.preventDefault();
                if ($('.month-notes-textarea-wrapper:not(.is-filled)').length < 1){
                    $('' +
                        '<div class="month-notes-textarea-wrapper">' +
                        '<textarea class="month-notes-textarea"></textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>' +
                        '').insertBefore($(this));
                }
            });

            var notes_counter = parseInt($('.counter-notes').text());
            $(document).on('keypress',".month-notes-textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '') {
                        notes_counter++;

                        add_habit_note.text = $(this).val();
                        add_habit_note.number = notes_counter;
                        add_habit_note.type = 'note';

                        var eee = $(this);

                        $('.habit-preloader-wrapper').addClass("show");
                        jQuery.post(ajaxurl, add_habit_note)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');
                                eee.parent().attr('data-number',notes_counter);
                                $('<div class="week-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="week-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.week-notes-wrapper h4'));

                                $('<div class="day-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="day-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.day-notes-wrapper h4'));

                                $('<div class="popup-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="popup-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.popup-notes-wrapper h4'));

                                $('<div class="plan-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="plan-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.plan-notes-wrapper h4'));

                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })
                    }
                }
            });


            var month_goal_counter = parseInt($('.counter-month-goal').text());
            $(document).on('keypress',".this-month-goals-textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '')
                    {
                        month_goal_counter++;

                        var eee = $(this);

                        add_habit_month_goal.text = $(this).val();
                        add_habit_month_goal.number = month_goal_counter;
                        add_habit_month_goal.type = 'month_goal';

                        $('.habit-preloader-wrapper').addClass("show");
                        jQuery.post(ajaxurl, add_habit_month_goal)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');
                                eee.parent().attr('data-number',month_goal_counter);
                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })
                    }
                }
            });

            $(document).on('click','.month-notes-textarea-wrapper .remove-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        if ($('.month-notes-textarea-wrapper').length > 1){
                            eee.parent().remove();
                        }
                        else{
                            eee.parent().removeClass('is-filled');
                            eee.parent().find('.month-notes-textarea').val('');
                            eee.parent().find('.month-notes-textarea').removeAttr('readonly');
                            eee.parent().removeAttr('data-number');
                        }
                        var number = eee.parent().attr('data-number');
                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.month-notes-textarea-wrapper .edit-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                var number = eee.parent().attr('data-number');
                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().removeClass('is-filled');
                        eee.parent().find('.month-notes-textarea').removeAttr('readonly');
                        eee.parent().removeAttr('data-number');
                        eee.parent().find('.month-notes-textarea').focus();

                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });


            $(document).on('click','.this-month-goals-textarea-wrapper .remove-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'month_goal';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        if ($('.this-month-goals-textarea-wrapper').length > 1){
                            eee.parent().remove();
                        }
                        else{
                            eee.parent().removeClass('is-filled');
                            eee.parent().find('.this-month-goals-textarea').val('');
                            eee.parent().find('.this-month-goals-textarea').removeAttr('data-number');
                            eee.parent().find('.this-month-goals-textarea').removeAttr('readonly');
                        }
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.this-month-goals-textarea-wrapper .edit-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'month_goal';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().removeClass('is-filled');
                        eee.parent().find('.this-month-goals-textarea').removeAttr('data-number');
                        eee.parent().find('.this-month-goals-textarea').removeAttr('readonly');
                        eee.parent().find('.this-month-goals-textarea').focus();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            var additional_task_number = parseInt($('.counter-tasks').text());

            $(document).on('click','.month-action-add',function(){
                var action_text = $('.month-action-text').val();
                if (action_text){
                    var data_date = '';
                    additional_task_number++;
                    var day_date = $('.day-wrapper').attr('data-date');

                    var eee = $(this);

                    add_month_action.dates_arr = [];
                    $('.month-day.selected').each(function(){
                        data_date = $(this).attr('data-date');
                        add_month_action.dates_arr.push(data_date);
                    });
                    add_month_action.text = action_text;
                    add_month_action.type = 'task';
                    add_month_action.number = additional_task_number;
                    $('.habit-preloader-wrapper').addClass("show");

                    jQuery.post(ajaxurl, add_month_action)
                        .done(function (msg) {
                            $('.month-day.selected').each(function(){
                                $(this).append('<div class="month-day-inner" data-number="'+additional_task_number+'"><input readonly type="text" value="'+action_text+'">' +
                                    '<a href="#" class="remove-input">x</a></div>');

                                data_date = $(this).attr('data-date');
                                $('.week-day[data-date="'+data_date+'"] .week-action-wrapper').prepend(
                                    '<div class="week-action-inside is-filled" data-number="'+additional_task_number+'">' +
                                    '<textarea class="week-action-textarea" readonly>'+action_text+'</textarea>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                );

                                if (day_date == $(this).attr('data-date')){
                                    $('.day-secondary-tasks').append(
                                        '<div class="task-input-wrapper" data-number="'+additional_task_number+'" data-checked="0" >' +
                                        '<span>' + action_text + '</span>' +
                                        '<button></button>' +
                                        '</div>'
                                    );

                                    task_all = $('.task-input-wrapper').length + $('.action-input-wrapper').length;

                                    $('.progress-today-tasks h5 .all').text(task_all);

                                    task_current = $('.action-input-wrapper.is-completed').length + $('.task-input-wrapper.is-completed').length;
                                    var task_percent = Math.round(task_current / task_all * 100);
                                    $('.today-tasks-circle span').first().text(task_percent);

                                    $('.today-tasks-circle').css('--ratio',task_percent / 100);

                                    $('.add-daily-actions-wrapper').removeClass('show');

                                    if (
                                        ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                                        ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                                    ){
                                        $('.end-day').addClass('active');
                                    }
                                    else{
                                        $('.end-day').removeClass('active');
                                    }
                                }
                            });

                            $('.month-action-text').val('');
                            $('.month-day.selected').removeClass('selected');
                            $('.month-action-add.active').removeClass('active');

                            $('.habit-preloader-wrapper').removeClass("show");
                        })
                        .fail(function (xhr, textStatus, errorThrown) {
                            $('.habit-preloader-wrapper').removeClass("show");
                            alert('Connection error happen, please try again');
                        })
                }
            });

            $(document).on('click','.month-day .remove-input',function(e){
                e.preventDefault();
                e.stopPropagation();

                var data_date = $(this).parent().parent().attr('data-date');
                var data_number = $(this).parent().attr('data-number');

                remove_habit_item.type = 'task';
                remove_habit_item.number = data_number;
                remove_habit_item.date_created = data_date;

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        $('.week-day[data-date="'+data_date+'"] .week-action-inside[data-number="'+data_number+'"]').remove();

                        var day_date = $('.day-wrapper').attr('data-date');

                        if (data_date == day_date){
                            $('.day-secondary-tasks .task-input-wrapper[data-number="'+data_number+'"]').remove();

                            task_all = $('.task-input-wrapper').length + $('.action-input-wrapper').length;
                            $('.progress-today-tasks h5 .all').text(task_all);
                            task_current = $('.action-input-wrapper.is-completed').length + $('.task-input-wrapper.is-completed').length;
                            $('.progress-today-tasks h5 .current').text(task_current);

                            if (!task_all){
                                task_all = 1;
                            }
                            var task_percent = Math.round(task_current / task_all * 100);
                            $('.today-tasks-circle span').first().text(task_percent);
                            $('.today-tasks-circle').css('--ratio',task_percent / 100);

                            if (
                                ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                                ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                            ){
                                $('.end-day').addClass('active');
                            }
                            else{
                                $('.end-day').removeClass('active');
                            }
                        }
                        eee.parent().remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })


            });
















            $(document).on('click','.plan-your-week',function(e){
                e.preventDefault();
                $('.popup-plan-week-wrapper').addClass('show');
            });


            $(document).on('click','.week-notes-wrapper h4',function(){
                $(this).parent().toggleClass('opened');
            });


            $(document).on('click','.week-notes-textarea-wrapper .remove-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        if ($('.week-notes-textarea-wrapper').length > 1){
                            eee.parent().remove();
                        }
                        else{
                            eee.parent().removeClass('is-filled');
                            eee.parent().find('.month-notes-textarea').val('');
                            eee.parent().find('.month-notes-textarea').removeAttr('readonly');
                            eee.parent().removeAttr('data-number');
                        }
                        var number = eee.parent().attr('data-number');
                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.week-notes-textarea-wrapper .edit-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                var number = eee.parent().attr('data-number');
                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().removeClass('is-filled');
                        eee.parent().find('.week-notes-textarea').removeAttr('readonly');
                        eee.parent().removeAttr('data-number');
                        eee.parent().find('.week-notes-textarea').focus();

                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });


            $(document).on('keypress',".week-notes-textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '') {
                        notes_counter++;

                        add_habit_note.text = $(this).val();
                        add_habit_note.number = notes_counter;
                        add_habit_note.type = 'note';

                        var eee = $(this);

                        $('.habit-preloader-wrapper').addClass("show");
                        jQuery.post(ajaxurl, add_habit_note)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');
                                eee.parent().attr('data-number',notes_counter);

                                $('<div class="month-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="month-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.notes-wrapper h4'));

                                $('<div class="day-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="day-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.day-notes-wrapper h4'));

                                $('<div class="popup-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="popup-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.popup-notes-wrapper h4'));

                                $('<div class="plan-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="plan-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.plan-notes-wrapper h4'));

                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })
                    }
                }
            });

            $(document).on('click','.add-week-note',function(e){
                e.preventDefault();
                if ($('.week-notes-textarea-wrapper:not(.is-filled)').length < 1){
                    $('' +
                        '<div class="week-notes-textarea-wrapper">' +
                        '<textarea class="week-notes-textarea"></textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>' +
                        '').insertBefore($(this));
                }
            });



            $(document).on('click','.is-habit-tab.planner-day:not(.is-day-finished)  .day-notes-wrapper h4',function(){
                $(this).parent().toggleClass('opened');
            });


            $(document).on('click','.day-notes-textarea-wrapper .remove-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        if ($('.day-notes-textarea-wrapper').length > 1){
                            eee.parent().remove();
                        }
                        else{
                            eee.parent().removeClass('is-filled');
                            eee.parent().find('.month-notes-textarea').val('');
                            eee.parent().find('.month-notes-textarea').removeAttr('readonly');
                            eee.parent().removeAttr('data-number');
                        }
                        var number = eee.parent().attr('data-number');
                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.day-notes-textarea-wrapper .edit-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                var number = eee.parent().attr('data-number');
                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().removeClass('is-filled');
                        eee.parent().find('.day-notes-textarea').removeAttr('readonly');
                        eee.parent().removeAttr('data-number');
                        eee.parent().find('.day-notes-textarea').focus();

                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });


            $(document).on('keypress',".day-notes-textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '') {
                        notes_counter++;

                        add_habit_note.text = $(this).val();
                        add_habit_note.number = notes_counter;
                        add_habit_note.type = 'note';

                        var eee = $(this);

                        $('.habit-preloader-wrapper').addClass("show");
                        jQuery.post(ajaxurl, add_habit_note)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');
                                eee.parent().attr('data-number',notes_counter);

                                $('<div class="month-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="month-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.notes-wrapper h4'));

                                $('<div class="week-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="week-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.week-notes-wrapper h4'));

                                $('<div class="popup-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="popup-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.popup-notes-wrapper h4'));

                                $('<div class="plan-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="plan-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.plan-notes-wrapper h4'));

                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })
                    }
                }
            });

            $(document).on('click','.add-day-note',function(e){
                e.preventDefault();
                if ($('.day-notes-textarea-wrapper:not(.is-filled)').length < 1){
                    $('' +
                        '<div class="day-notes-textarea-wrapper">' +
                        '<textarea class="day-notes-textarea"></textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>' +
                        '').insertBefore($(this));
                }
            });










            $(document).on('click','.popup-notes-wrapper h4',function(){
                $(this).parent().toggleClass('opened');
            });


            $(document).on('click','.popup-notes-textarea-wrapper .remove-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        if ($('.popup-notes-textarea-wrapper').length > 1){
                            eee.parent().remove();
                        }
                        else{
                            eee.parent().removeClass('is-filled');
                            eee.parent().find('.month-notes-textarea').val('');
                            eee.parent().find('.month-notes-textarea').removeAttr('readonly');
                            eee.parent().removeAttr('data-number');
                        }
                        var number = eee.parent().attr('data-number');
                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.popup-notes-textarea-wrapper .edit-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);
                var number = eee.parent().attr('data-number');

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().removeClass('is-filled');
                        eee.parent().find('.popup-notes-textarea').removeAttr('readonly');
                        eee.parent().removeAttr('data-number');
                        eee.parent().find('.popup-notes-textarea').focus();

                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.plan-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('keypress',".popup-notes-textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '') {
                        notes_counter++;

                        add_habit_note.text = $(this).val();
                        add_habit_note.number = notes_counter;
                        add_habit_note.type = 'note';

                        var eee = $(this);

                        $('.habit-preloader-wrapper').addClass("show");
                        jQuery.post(ajaxurl, add_habit_note)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');
                                eee.parent().attr('data-number',notes_counter);

                                $('<div class="month-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="month-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.notes-wrapper h4'));

                                $('<div class="week-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="week-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.week-notes-wrapper h4'));

                                $('<div class="day-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="day-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.day-notes-wrapper h4'));

                                $('<div class="plan-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="plan-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.plan-notes-wrapper h4'));

                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })
                    }
                }
            });

            $(document).on('click','.add-popup-note',function(e){
                e.preventDefault();
                if ($('.popup-notes-textarea-wrapper:not(.is-filled)').length < 1){
                    $('' +
                        '<div class="popup-notes-textarea-wrapper">' +
                        '<textarea class="popup-notes-textarea"></textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>' +
                        '').insertBefore($(this));
                }
            });

            $(document).on('click','.cancel-week-popup',function(){
                $('.popup-plan-week-wrapper').removeClass('show');
            });

            $(document).on('click','.confirm-week-popup',function(){
                plan_your_week.week_start_date = $('.focus-decide-items-wrapper.is-week-current button').first().attr('data-date');
                plan_your_week.week_today_date = $('.day-wrapper').attr('data-date');
                plan_your_week.goal_arr = [];
                plan_your_week.focus_arr = [];
                plan_your_week.dates_arr = [];

                $('.focus-decide-wrapper .is-week-current button.active').each(function() {
                    var dates_item = {'date': $(this).attr('data-date')};
                    plan_your_week.dates_arr.push(dates_item);
                });
                $('.popup-goals-textarea-wrapper textarea[readonly]').each(function(){
                    var goal_item = {'number': $(this).parent().attr('data-number'), 'text': $(this).val()};
                    plan_your_week.goal_arr.push(goal_item);
                });
                $('.popup-daily-focus-wrapper input[readonly]').each(function(){
                    var focus_item = {
                        'time': $(this).parent().find('.is-inner-hour').text() +
                        ':' + $(this).parent().find('.is-inner-min').text() +
                        $(this).parent().find('.is-inner-type').text(),
                        'number': $(this).parent().attr('data-number'), 'text': $(this).val()
                    };
                    plan_your_week.focus_arr.push(focus_item);
                });

                var eee = $(this);
                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, plan_your_week)
                    .done(function (msg) {

                        if ($('.week-days.is-week-current').hasClass('is-week-1')){
                            $('.plan-your-week.is-week-1').addClass('hidden');
                            $('.is-habit-tab.planner-week').addClass('is-completed-1');
                        }
                        else{
                            $('.plan-your-week.is-week-2').addClass('hidden');
                            $('.is-habit-tab.planner-week').addClass('is-completed-2');
                        }

                        if ($('.week-days.is-week-current').hasClass('is-week-1')){
                            $('.popup-goals-textarea-wrapper textarea[readonly]').each(function(){
                                var number = $(this).parent().attr('data-number');
                                $('.this-week-goal-wrapper.is-week-1 .is-wrapper').append(
                                    '<div class="week-goal-textarea-wrapper is-filled" data-number="'+number+'">' +
                                    '<textarea type="text" readonly>'+$(this).val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                );
                            });
                        }
                        else{
                            $('.popup-goals-textarea-wrapper textarea[readonly]').each(function(){
                                var number = $(this).parent().attr('data-number');
                                $('.this-week-goal-wrapper.is-week-2 .is-wrapper').append(
                                    '<div class="week-goal-textarea-wrapper is-filled" data-number="'+number+'">' +
                                    '<textarea type="text" readonly>'+$(this).val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                );
                            });
                        }

                        if ($('.focus-decide-wrapper .is-week-current button.active').length  > 0){

                            if ($('.week-days.is-week-current').hasClass('is-week-1')){

                                $('.popup-daily-focus-wrapper input[readonly]').each(function(){
                                    var number = $(this).parent().attr('data-number');
                                    if ($('.is-week-current .week-daily-focus-headlines').hasClass('is-routines')){
                                        if ($(this).parent().find('.is-inner-type').text() == 'pm'){
                                            $('.week-daily-focus-wrapper.is-week-1 .week-night-wrapper').append(
                                                '<div class="week-daily-focus-input-wrapper"  data-number="'+number+'">' +
                                                '<input type="text" readonly value="'+$(this).val()+'">' +
                                                '<span class="main-span">'+
                                                $(this).parent().find('.time-input-wrapper').html() +
                                                '</span>' +
                                                '</div>'
                                            );
                                        }
                                    else{
                                            $('.week-daily-focus-wrapper.is-week-1 .week-morning-wrapper').append(
                                                '<div class="week-daily-focus-input-wrapper"  data-number="'+number+'">' +
                                                '<input type="text" readonly value="'+$(this).val()+'">' +
                                                '<span class="main-span">'+
                                                $(this).parent().find('.time-input-wrapper').html() +
                                                '</span>' +
                                                '</div>'
                                            );
                                        }
                                    }
                                    else{
                                        $('.week-daily-focus-wrapper.is-week-1 .week-morning-wrapper').append(
                                            '<div class="week-daily-focus-input-wrapper"  data-number="'+number+'">' +
                                            '<input type="text" readonly value="'+$(this).val()+'">' +
                                            '<span class="main-span">'+
                                            $(this).parent().find('.time-input-wrapper').html() +
                                            '</span>' +
                                            '</div>'
                                        );
                                    }
                                });
                            }
                            else{

                                $('.popup-daily-focus-wrapper input[readonly]').each(function(){
                                    var number = $(this).parent().attr('data-number');
                                    if ($('.is-week-current .week-daily-focus-headlines').hasClass('is-routines')){
                                        if ($(this).parent().find('.is-inner-type').text() == 'am'){
                                            $('.week-daily-focus-wrapper.is-week-2 .week-night-wrapper').append(
                                                '<div class="week-daily-focus-input-wrapper"  data-number="'+number+'">' +
                                                '<input type="text" readonly value="'+$(this).val()+'">' +
                                                '<span class="main-span">'+
                                                $(this).parent().find('.time-input-wrapper').html() +
                                                '</span>' +
                                                '</div>'
                                            );
                                        }
                                    else{
                                            $('.week-daily-focus-wrapper.is-week-2 .week-morning-wrapper').append(
                                                '<div class="week-daily-focus-input-wrapper"  data-number="'+number+'">' +
                                                '<input type="text" readonly value="'+$(this).val()+'">' +
                                                '<span class="main-span">'+
                                                $(this).parent().find('.time-input-wrapper').html() +
                                                '</span>' +
                                                '</div>'
                                            );
                                        }
                                    }
                                    else{
                                        $('.week-daily-focus-wrapper.is-week-2 .week-morning-wrapper').append(
                                            '<div class="week-daily-focus-input-wrapper"  data-number="'+number+'">' +
                                            '<input type="text" readonly value="'+$(this).val()+'">' +
                                            '<span class="main-span">'+
                                            $(this).parent().find('.time-input-wrapper').html() +
                                            '</span>' +
                                            '</div>'
                                        );
                                    }
                                });
                            }
                        }

                        if ($('.focus-input-wrapper').length > 0){
                            $('.focus-decide-wrapper .is-week-current button.active').each(function(){
                                var index = $(this).index();

                                if ($('.week-days.is-week-current').hasClass('is-week-1')) {
                                    $('.is-week-current.is-week-1 .week-day').eq(index).addClass('have-focus');
                                }
                                else{
                                    $('.is-week-current.is-week-2 .week-day').eq(index).addClass('have-focus');
                                }

                                var day_date = $('.day-wrapper').attr('data-date');
                                if (day_date == $(this).attr('data-date')) {
                                    $('.popup-daily-focus-wrapper input[readonly]').each(function(){

                                        if ($('.is-week-current .week-daily-focus-headlines').hasClass('is-routines')){
                                            if ($(this).parent().find('.is-inner-type').text() == 'am'){
                                                $('.day-daily-focus .day-morning-wrapper').append(
                                                    '<div class="is-focus-input-wrapper" data-checked="0" ' +
                                                    'data-number="'+$(this).parent().attr('data-number')+'" >' +
                                                    '<span class="text-span">' + $(this).val() + '</span>' +
                                                    '<span class="time-span">'+
                                                    $(this).parent().find('.time-input-wrapper').html() +
                                                    '</span>'+
                                                    '<button></button>' +
                                                    '</div>'
                                                );
                                            }
                                            else{
                                                $('.day-daily-focus .day-night-wrapper').append(
                                                    '<div class="is-focus-input-wrapper" data-checked="0" ' +
                                                    'data-number="'+$(this).parent().attr('data-number')+'" >' +
                                                    '<span class="text-span">' + $(this).val() + '</span>' +
                                                    '<span class="time-span">'+
                                                    $(this).parent().find('.time-input-wrapper').html() +
                                                    '</span>'+
                                                    '<button></button>' +
                                                    '</div>'
                                                );
                                            }
                                        }
                                        else{
                                            $('.day-daily-focus .day-morning-wrapper').append(
                                                '<div class="is-focus-input-wrapper" data-checked="0" ' +
                                                'data-number="'+$(this).parent().attr('data-number')+'" >' +
                                                '<span class="text-span">' + $(this).val() + '</span>' +
                                                '<span class="time-span">'+
                                                $(this).parent().find('.time-input-wrapper').html() +
                                                '</span>'+
                                                '<button></button>' +
                                                '</div>'
                                            );
                                        }
                                    });
                                }
                            });
                        }

                        $('.focus-decide-wrapper .is-week-current button.active').removeClass('active');

                        if ($('.week-days.is-week-current').hasClass('is-week-1')){
                            focus_all = $('.is-focus-input-wrapper').length;
                            $('.progress-daily-focus h5 .all').text(focus_all);
                        }

                        $('.popup-plan-week-wrapper').removeClass('show');

                        $('.habit-preloader-wrapper').removeClass("show");

                        if ($('.is-focus-input-wrapper').length > 0){
                            $('.day-daily-focus').show();
                        }
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.focus-decide-wrapper button',function(){
                if ($(this).parent().index() == 44){
                    if ($(this).hasClass('active')){
                        $('.focus-decide-items-wrapper').eq(45).find('button').eq($(this).index()).removeClass('active');
                    }
                    else{
                        $('.focus-decide-items-wrapper').eq(45).find('button').eq($(this).index()).addClass('active');
                    }

                }
                $(this).toggleClass('active');
            });




            $(document).on('click','.popup-goals-textarea-wrapper .remove-input',function(e){
                e.preventDefault();
                if ($('.popup-goals-textarea-wrapper').length > 1){
                    $(this).parent().remove();
                }
                else{
                    $(this).parent().removeClass('is-filled');
                    $(this).parent().find('.popup-goals-textarea').val('');
                    $(this).parent().find('.popup-goals-textarea').removeAttr('readonly');
                }
            });

            $(document).on('click','.popup-goals-textarea-wrapper .edit-input',function(e){
                e.preventDefault();
                $(this).parent().removeClass('is-filled');
                $(this).parent().find('.popup-goals-textarea').removeAttr('readonly');
                $(this).parent().find('.popup-goals-textarea').focus();
            });

            $(document).on('keypress',".popup-goals-textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '') {
                        week_goal_number++;
                        $(this).parent().attr('data-number',week_goal_number);
                        $(this).attr('readonly', 'readonly');
                        $(this).parent().addClass('is-filled');
                    }
                }
            });

            $(document).on('click','.add-popup-goal',function(e){
                e.preventDefault();

                    $(
                        '<div class="popup-goals-textarea-wrapper">' +
                        '<textarea class="popup-goals-textarea"></textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>'
                    ).insertBefore($(this));

            });

            $(document).on('click','.add-week-goal',function(e){
                e.preventDefault();

                if ($('.week-days.is-week-current').hasClass('is-week-1')){
                    $('.this-week-goal-wrapper.is-week-1 .is-wrapper').append(
                        '<div class="week-goal-textarea-wrapper">' +
                        '<textarea type="text">'+$(this).val()+'</textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>'
                    );
                }
                else{
                    $('.this-week-goal-wrapper.is-week-2 .is-wrapper').append(
                        '<div class="week-goal-textarea-wrapper">' +
                        '<textarea type="text">'+$(this).val()+'</textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>'
                    );
                }

                $('.week-goal-textarea-wrapper textarea').last().focus();
            });


            $(document).on('click','.week-goal-textarea-wrapper .remove-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'week_goal';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = $('.week-days.is-week-current .week-day.week-day-monday').attr('data-date');

                var eee = $(this);
                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            })

            $(document).on('click','.week-goal-textarea-wrapper .edit-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'week_goal';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = $('.week-days.is-week-current .week-day.week-day-monday').attr('data-date');;

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().removeClass('is-filled');
                        eee.parent().find('textarea').removeAttr('data-number');
                        eee.parent().find('textarea').removeAttr('readonly');
                        eee.parent().find('textarea').focus();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })

            });


            $(document).on('keypress',".week-goal-textarea-wrapper textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '') {

                        week_goal_number++;

                        var eee = $(this);

                        add_habit_week_goal.text = $(this).val();
                        add_habit_week_goal.number = week_goal_number;
                        add_habit_week_goal.date_created = $('.week-days.is-week-current .week-day.week-day-monday').attr('data-date');
                        add_habit_week_goal.type = 'week_goal';

                        $('.habit-preloader-wrapper').addClass("show");
                        jQuery.post(ajaxurl, add_habit_week_goal)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');
                                eee.parent().attr('data-number',week_goal_number);
                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })

                    }
                }
            });


            $(document).on('click','.add-popup-focus',function(e){
                e.preventDefault();
                $('.add-focus-wrapper').addClass('show');
                $('.add-focus-wrapper').attr('data-is-plan',0);
                $('.name-your-daily-focus').removeAttr('readonly');
            });

            $(document).on('click','.cancel-focus-popup',function(e){
                e.preventDefault();
                $('.add-focus-wrapper').removeClass('show');
            });

            var focus_number = parseInt($('.counter-daily-focus').text());

            $(document).on('click','.save-focus-popup',function(e){
                e.preventDefault();
                var name = $('.name-your-daily-focus').val();
                var hour = $('.time-wrapper-hour').val();
                if (!hour){
                    hour = '1';
                }
                var min = $('.time-wrapper-min').val();
                if (!min){
                    min = '00';
                }
                var type = $('.time-wrapper-type').val();
                if (name){
                    if ($('.add-focus-wrapper').attr('data-is-plan') == '1'){
                        var edit_number = $('.add-focus-wrapper').attr('focus-number');

                        $('.plan-daily-focus-i[data-number="'+edit_number+'"] .is-inner-hour').text(hour);
                        $('.plan-daily-focus-i[data-number="'+edit_number+'"] .is-inner-min').text(min);
                        $('.plan-daily-focus-i[data-number="'+edit_number+'"] .is-inner-type').text(type);
                    }
                    else{
                        focus_number++;
                        if ($('.is-week-current .week-daily-focus-headlines').hasClass('is-routines')){
                            if (type == 'pm'){
                                $('.popup-night-wrapper .popup-daily-focus-wrapper').append(
                                    '<div class="focus-input-wrapper" data-number="'+focus_number+'">' +
                                    '<input readonly type="text" value="'+name+'">' +
                                    '<span class="time-input-wrapper">' +
                                    '<span class="is-inner-hour">'+hour+'</span>:'+
                                    '<span class="is-inner-min">'+min+'</span>'+
                                    '<span class="is-inner-type">'+type+'</span>' +
                                    '</span>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                );
                            }
                            else{
                                $('.popup-morning-wrapper .popup-daily-focus-wrapper').append(
                                    '<div class="focus-input-wrapper" data-number="'+focus_number+'">' +
                                    '<input readonly type="text" value="'+name+'">' +
                                    '<span class="time-input-wrapper">' +
                                    '<span class="is-inner-hour">'+hour+'</span>:'+
                                    '<span class="is-inner-min">'+min+'</span>'+
                                    '<span class="is-inner-type">'+type+'</span>' +
                                    '</span>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                );
                            }
                        }
                        else{
                            $('.popup-morning-wrapper .popup-daily-focus-wrapper').append(
                                '<div class="focus-input-wrapper" data-number="'+focus_number+'">' +
                                '<input readonly type="text" value="'+name+'">' +
                                '<span class="time-input-wrapper">' +
                                '<span class="is-inner-hour">'+hour+'</span>:'+
                                '<span class="is-inner-min">'+min+'</span>'+
                                '<span class="is-inner-type">'+type+'</span>' +
                                '</span>' +
                                '<a href="#" class="edit-input"></a>' +
                                '<a href="#" class="remove-input">x</a>' +
                                '</div>'
                            );
                        }
                    }

                    $('.name-your-daily-focus').val('');
                    $('.time-wrapper-hour').val('');
                    $('.time-wrapper-min').val('');
                    $('.time-wrapper-type option[value="am"]').prop('selected', true);

                    $('.add-focus-wrapper').removeClass('show');
                }
            });

            $(document).on('click','.focus-input-wrapper .remove-input',function(e){
                e.preventDefault();
                $(this).parent().remove();
            });

            $(document).on('click','.focus-input-wrapper .edit-input',function(e){
                e.preventDefault();
                $('.add-focus-wrapper').addClass('show');
                $('.add-focus-wrapper').attr('data-is-plan',0);
                var text = $(this).parent().find('input').val();
                var hour = $(this).parent().find('.is-inner-hour').text();
                var min = $(this).parent().find('.is-inner-min').text();
                var type = $(this).parent().find('.is-inner-type').text();

                $('.name-your-daily-focus').val(text);
                $('.time-wrapper-hour').val(hour);
                $('.time-wrapper-min').val(min);
                if (type == 'am'){
                    $('.time-wrapper-type option[value="am"]').prop('selected', true);
                }
                else{
                    $('.time-wrapper-type option[value="pm"]').prop('selected', true);
                }
                $(this).parent().remove();
            });



            $(document).on('mouseenter focus','.month-day input',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseenter focus','.month-day .remove-input',function(){
                $(this).parent().addClass('is-hover');
            });


            $(document).on('mouseleave focusout','.month-day input',function(){
                $(this).parent().removeClass('is-hover');
            });


            $(document).on('click','.add-focus-wrapper .popup-close',function(e){
                e.stopPropagation();
                $('.add-focus-wrapper').removeClass('show');
            });


            $(document).on('click','.add-week-task',function(e){
                e.preventDefault();
            });

            var last_weeks_day_date = '';
            $(document).on('click','.add-week-appointment',function(e){
                e.preventDefault();
                $('.add-appointment-wrapper').addClass('show');
                $('.add-appointment-wrapper').attr('data-is-plan',0);
                last_weeks_day_date = $(this).closest('.week-day').attr('data-date');

                $('.add-appointment-wrapper').attr('data-date',$(this).closest('.week-day').attr('data-date'));
            });

            $(document).on('click','.save-appointment-popup',function(e){
                e.preventDefault();
                var name = $('.name-add-appointment').val();
                var hour = $('.appointment-time-wrapper-hour').val();
                if (!hour){
                    hour = '1';
                }
                var min = $('.appointment-time-wrapper-min').val();
                if (!min){
                    min = '00';
                }
                var type = $('.appointment-time-wrapper-type').val();

                if (name){

                    if ($('.add-appointment-wrapper').attr('data-is-plan') == '1'){
                        appointment_counter++;
                        $('.plan-appointments-items').append(
                            '<div class="plan-appointments-i" data-number="'+appointment_counter+'">' +
                            '<span class="text">'+name+'</span>'+
                            '<span class="time">' +
                            '<span class="is-inner-hour">'+hour+'</span>:'+
                            '<span class="is-inner-min">'+min+'</span>'+
                            '<span class="is-inner-type">'+type+'</span>' +
                            '</span>' +
                            '<a href="#" class="remove-input">x</a>'+
                            '</div>'
                        );

                        $('.name-add-appointment').val('');
                        $('.appointment-time-wrapper-hour').val('');
                        $('.appointment-time-wrapper-min').val('');
                        $('.appointment-time-wrapper-type option[value="am"]').prop('selected', true);

                        $('.add-appointment-wrapper').removeClass('show');
                    }
                    else{
                        appointment_counter++;

                        add_week_appointment.date_created = last_weeks_day_date;
                        add_week_appointment.text = name;
                        add_week_appointment.type = 'appointment';
                        add_week_appointment.number = appointment_counter;
                        add_week_appointment.action_time = hour+':'+min+type;

                        $('.habit-preloader-wrapper').addClass("show");

                        jQuery.post(ajaxurl, add_week_appointment)
                            .done(function (msg) {
                                $('.week-day[data-date="'+last_weeks_day_date+'"]').find('.week-appointment-wrapper').prepend(
                                    '<div class="week-appointment-inside" data-number="'+appointment_counter+'">' +
                                    '<input readonly type="text" value="'+name+'">' +
                                    '<span class="time-input-wrapper">' +
                                    '<span class="is-inner-hour">'+hour+'</span>:'+
                                    '<span class="is-inner-min">'+min+'</span>'+
                                    '<span class="is-inner-type">'+type+'</span>' +
                                    '</span>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                );

                                var day_date = $('.day-wrapper').attr('data-date');
                                if (day_date == $('.add-appointment-wrapper').attr('data-date')) {

                                    $('.day-appointments').addClass('show');

                                    $('.appointment-items-wrapper').append(
                                        '<p class="appointment-item" data-number="'+appointment_counter+'" >' +
                                        '<span class="icon"></span>' +
                                        hour +':'+ min +type+' '+name +
                                        '</p><br>'
                                    );
                                }

                                $('.name-add-appointment').val('');
                                $('.appointment-time-wrapper-hour').val('');
                                $('.appointment-time-wrapper-min').val('');
                                $('.appointment-time-wrapper-type option[value="am"]').prop('selected', true);

                                $('.add-appointment-wrapper').removeClass('show');

                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })
                    }
                }
            });

            $(document).on('click','.cancel-appointment-popup',function(e){
                e.preventDefault();
                $('.add-appointment-wrapper').removeClass('show');
            });

            $(document).on('click','.week-appointment-inside .remove-input',function(e){
                e.preventDefault();

                var data_number = $(this).parent().attr('data-number');
                var data_date = $(this).closest('.week-day').attr('data-date');

                remove_habit_item.type = 'appointment';
                remove_habit_item.number = data_number;
                remove_habit_item.date_created = data_date;

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        if (data_date == $('.day-wrapper').attr('data-date')){
                            $('.appointment-item[data-number="'+data_number+'"] + br').remove();
                            $('.appointment-item[data-number="'+data_number+'"]').remove();
                        }
                        eee.parent().remove();
                        if ($('.appointment-item').length == 0){
                            $('.day-appointments.show').removeClass('show');
                        }
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('mouseenter focus','.week-appointment-inside input',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseenter focus','.week-appointment-inside .remove-input',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseleave focusout','.week-appointment-inside input',function(){
                $(this).parent().removeClass('is-hover');
            });

            $(document).on('keypress',".week-day-inside-wrapper textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== '') {

                        var eee = $(this);
                        additional_task_number++;

                        add_week_task.date_created = $(this).closest('.week-day').attr('data-date');;
                        add_week_task.text = $(this).val();
                        add_week_task.type = 'task';
                        add_week_task.number = additional_task_number;
                        $('.habit-preloader-wrapper').addClass("show");

                        jQuery.post(ajaxurl, add_week_task)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');

                                eee.parent().attr('data-number', additional_task_number);

                                var data_date = eee.closest('.week-day').attr('data-date');
                                $('.month-day[data-date="' + data_date + '"]').append(
                                    '<div class="month-day-inner" data-number="' + additional_task_number + '">' +
                                    '<input readonly type="text" value="' +eee.val() + '">' +
                                    '<a href="#" class="remove-input">x</a></div>' +
                                    '');

                                var day_date = $('.day-wrapper').attr('data-date');
                                if (day_date == data_date) {
                                    $('.day-secondary-tasks').append(
                                        '<div class="task-input-wrapper" data-number="' + additional_task_number + '" data-checked="0" >' +
                                        '<span>' + eee.val() + '</span>' +
                                        '<button></button>' +
                                        '</div>'
                                    );

                                    task_all = $('.task-input-wrapper').length + $('.action-input-wrapper').length;

                                    $('.progress-today-tasks h5 .all').text(task_all);

                                    task_current = $('.action-input-wrapper.is-completed').length + $('.task-input-wrapper.is-completed').length;
                                    var task_percent = Math.round(task_current / task_all * 100);
                                    $('.today-tasks-circle span').first().text(task_percent);

                                    $('.today-tasks-circle').css('--ratio', task_percent / 100);

                                    $('.add-daily-actions-wrapper').removeClass('show');

                                    if (
                                        ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                                        ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                                    ) {
                                        $('.end-day').addClass('active');
                                    } else {
                                        $('.end-day').removeClass('active');
                                    }
                                }
                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })

                    }
                }
            });

            $(document).on('mouseenter focus','.week-day-inside-wrapper textarea',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseenter focus','.week-day-inside-wrapper .remove-input',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseleave focusout','.week-day-inside-wrapper textarea',function(){
                $(this).parent().removeClass('is-hover');
            });



            $(document).on('mouseenter focus','.this-month-goals-textarea-wrapper.is-filled textarea',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseenter focus','.this-month-goals-textarea-wrapper.is-filled .remove-input',function(){
                $(this).parent().addClass('is-hover');
            });
            $(document).on('mouseenter focus','.this-month-goals-textarea-wrapper.is-filled .edit-input',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseleave focusout','.this-month-goals-textarea-wrapper.is-filled textarea',function(){
                $(this).parent().removeClass('is-hover');
            });


            $(document).on('mouseenter focus','.week-goal-textarea-wrapper.is-filled textarea',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseenter focus','.week-goal-textarea-wrapper.is-filled .remove-input',function(){
                $(this).parent().addClass('is-hover');
            });
            $(document).on('mouseenter focus','.week-goal-textarea-wrapper.is-filled .edit-input',function(){
                $(this).parent().addClass('is-hover');
            });

            $(document).on('mouseleave focusout','.week-goal-textarea-wrapper.is-filled textarea',function(){
                $(this).parent().removeClass('is-hover');
            });



            $(document).on('click','.add-week-task',function(e){
                e.preventDefault();
                if ($(this).parent().find('.week-action-inside:not(.is-filled)').length < 1){
                    $(
                        '<div class="week-action-inside">' +
                        '<textarea class="week-action-textarea"></textarea>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>'
                        ).insertBefore($(this));
                }
            });

            $(document).on('click','.week-action-inside .remove-input',function(e){
                e.preventDefault();

                var data_date = $(this).closest('.week-day').attr('data-date');
                var data_number = $(this).parent().attr('data-number');

                remove_habit_item.type = 'task';
                remove_habit_item.number = data_number;
                remove_habit_item.date_created = data_date;

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {

                        $('.month-day[data-date="'+data_date+'"] .month-day-inner[data-number="'+data_number+'"]').remove();

                        var day_date = $('.day-wrapper').attr('data-date');

                        if (data_date == day_date){
                            $('.day-secondary-tasks .task-input-wrapper[data-number="'+data_number+'"]').remove();

                            task_all = $('.task-input-wrapper').length + $('.action-input-wrapper').length;
                            $('.progress-today-tasks h5 .all').text(task_all);
                            task_current = $('.action-input-wrapper.is-completed').length + $('.task-input-wrapper.is-completed').length;
                            $('.progress-today-tasks h5 .current').text(task_current);

                            if (!task_all){
                                task_all = 1;
                            }
                            var task_percent = Math.round(task_current / task_all * 100);
                            $('.today-tasks-circle span').first().text(task_percent);
                            $('.today-tasks-circle').css('--ratio',task_percent / 100);

                            if (
                                ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                                ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                            ){
                                $('.end-day').addClass('active');
                            }
                            else{
                                $('.end-day').removeClass('active');
                            }
                        }

                        eee.parent().remove();

                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });



            $(document).on('click','.is-habit-tab.planner-day:not(.is-day-finished) .day-daily-actions.have-items > button, ' +
                '.is-habit-tab.planner-day:not(.is-day-finished)  .add-daily-actions',function(e){
                e.preventDefault();

                $('.popup-content-wrapper .popup-content-item').remove();
                $($('.action-input-wrapper').get().reverse()).each(function(){
                    var is_completed = 0;
                    if ($(this).hasClass('is-completed')){
                        is_completed = 1;
                    }
                    var link = '';
                    var text = '';
                    if ($(this).find('a').length > 0){
                        link = $(this).find('a').attr('href');
                        text = $(this).find('a').text();
                    }
                    else{
                        text = $(this).find('span').text();
                    }
                    var number = $(this).attr('data-counter');

                    $('.popup-content-wrapper').prepend(
                        '<div class="popup-content-item" data-checked="'+is_completed+'" data-counter="'+number+'" ' +
                        'data-day1="'+$(this).attr('data-day1')+'" data-day2="'+$(this).attr('data-day2')+'" ' +
                        'data-day3="'+$(this).attr('data-day3')+'" data-day4="'+$(this).attr('data-day4')+'" ' +
                        'data-day5="'+$(this).attr('data-day5')+'" data-day6="'+$(this).attr('data-day6')+'" ' +
                        'data-day7="'+$(this).attr('data-day7')+'" ' +
                        'data-type="'+$(this).attr('data-type')+'" data-link="'+link+'">' +
                        '<input class="" type="text" readonly value="'+text+'">' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>'
                    );

                });

                $('.add-daily-actions-wrapper').addClass('show');
            });

            $(document).on('click','.popup-add-daily-action',function(e){
                e.preventDefault();
                is_daily_edit = 0;
                $('.add-single-action-wrapper').addClass('show');
                $('.add-single-action-wrapper').attr('data-checked',0);
            });

            $(document).on('click','.cancel-daily-actions',function(e){
                $('.add-daily-actions-wrapper').removeClass('show');
            });


            $(document).on('click','.save-daily-actions',function(e){
                add_daily_action.date_created = $('.day-wrapper').attr('data-date');
                add_daily_action.type = 'daily_action';
                add_daily_action.actions_arr = [];

                $('.popup-content-item').each(function (){
                    var completed = 0;
                    if ($(this).attr('data-checked') == '1'){
                        completed = 1;
                    }
                    var counter =  $(this).attr('data-counter');
                    var data_text = $(this).find('input').val();
                    var data_link = $(this).attr('data-link');
                    data_link = data_link.replace("https://", "");
                    data_link = data_link.replace("http://", "");
                    data_link = data_link.replace("https:/", "");
                    data_link = data_link.replace("http:/", "");
                    data_link = data_link.replace("https:", "");
                    data_link = data_link.replace("http:", "");
                    data_link = data_link.replace("https", "");
                    data_link = data_link.replace("http", "");
                    data_link = data_link.replace("://", "");
                    data_link = data_link.replace(":/", "");
                    data_link = data_link.replace(":", "");
                    data_link = 'https://'+data_link;
                    var data_type = $(this).attr('data-type');
                    var repeat_days = '';
                        repeat_days = repeat_days + $(this).attr('data-day1') + ',';
                        repeat_days = repeat_days + $(this).attr('data-day2') + ',';
                        repeat_days = repeat_days + $(this).attr('data-day3') + ',';
                        repeat_days = repeat_days + $(this).attr('data-day4') + ',';
                        repeat_days = repeat_days + $(this).attr('data-day5') + ',';
                        repeat_days = repeat_days + $(this).attr('data-day6') + ',';
                        repeat_days = repeat_days + $(this).attr('data-day7');
                    var action_item = {'number': counter, 'text': data_text,'link': data_link, 'completed': completed, 'type': data_type, 'repeat_days': repeat_days };
                    add_daily_action.actions_arr.push(action_item);
                });

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, add_daily_action)
                    .done(function (msg) {

                        if ($('.popup-content-item').length > 0){
                            $('.day-daily-actions').addClass('have-items');
                        }
                        else{
                            $('.day-daily-actions').removeClass('have-items');
                        }

                        $('.action-input-wrapper').remove();

                        $('.popup-content-item').each(function (){
                            var counter =  $(this).attr('data-counter');
                            var data_text = $(this).find('input').val();
                            var data_link = $(this).attr('data-link');
                            var add_text = '';
                            var is_checked = '';

                            if ($(this).attr('data-checked') == '1'){
                                is_checked = ' is-completed ';
                            }
                            if (data_link == ''){
                                add_text = '<span>'+data_text+'</span>';
                            }
                            else{
                                data_link = data_link.replace("https://", "");
                                data_link = data_link.replace("http://", "");
                                data_link = data_link.replace("https:/", "");
                                data_link = data_link.replace("http:/", "");
                                data_link = data_link.replace("https:", "");
                                data_link = data_link.replace("http:", "");
                                data_link = data_link.replace("https", "");
                                data_link = data_link.replace("http", "");
                                data_link = data_link.replace("://", "");
                                data_link = data_link.replace(":/", "");
                                data_link = data_link.replace(":", "");
                                data_link = 'https://'+data_link;
                                add_text = '<a target="_blank" href="'+data_link+'">'+data_text+'</a>';
                            }

                            var data_type = $(this).attr('data-type');
                            var data_day1 = $(this).attr('data-day1');
                            var data_day2 = $(this).attr('data-day2');
                            var data_day3 = $(this).attr('data-day3');
                            var data_day4 = $(this).attr('data-day4');
                            var data_day5 = $(this).attr('data-day5');
                            var data_day6 = $(this).attr('data-day6');
                            var data_day7 = $(this).attr('data-day7');
                            $(
                                '<div class="action-input-wrapper '+is_checked+'" data-counter="'+counter+'" ' +
                                'data-type="'+data_type+'" data-day1="'+data_day1+'" data-day2="'+data_day2+'" ' +
                                'data-day3="'+data_day3+'" data-day4="'+data_day4+'" data-day5="'+data_day5+'" ' +
                                'data-day6="'+data_day6+'" data-day7="'+data_day7+'">' +
                                add_text+
                                '<button></button>' +
                                '</div>'
                            ).insertBefore($('.add-daily-actions'));
                        });

                        task_all = $('.task-input-wrapper').length + $('.action-input-wrapper').length;

                        $('.progress-today-tasks h5 .all').text(task_all);

                        task_current = $('.action-input-wrapper.is-completed').length + $('.task-input-wrapper.is-completed').length;
                        $('.progress-today-tasks h5 .current').text(task_current);

                        if (!task_all){
                            task_all = 1;
                        }
                        var task_percent = Math.round(task_current / task_all * 100);
                        $('.today-tasks-circle span').first().text(task_percent);

                        $('.today-tasks-circle').css('--ratio',task_percent / 100);

                        $('.add-daily-actions-wrapper').removeClass('show');

                        if (
                            ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                            ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                        ){
                            $('.end-day').addClass('active');
                        }
                        else{
                            $('.end-day').removeClass('active');
                        }

                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });




            $(document).on('click','.is-habit-tab.planner-day:not(.is-day-finished) .action-input-wrapper button',function(e){

                habit_check_uncheck_item.type = 'daily_action';
                habit_check_uncheck_item.number = $(this).parent().attr('data-counter');
                habit_check_uncheck_item.date_created = $('.day-wrapper').attr('data-date');
                var eee = $(this);
                if (eee.parent().hasClass('is-completed')){
                    habit_check_uncheck_item.completed = 0;
                }
                else{
                    habit_check_uncheck_item.completed = 1;
                }

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, habit_check_uncheck_item)
                    .done(function (msg) {
                        eee.parent().toggleClass('is-completed');

                        var counter = $(this).parent().attr('data-counter');

                        if (eee.parent().hasClass('is-completed')){
                            $('.popup-content-item[data-counter="'+counter+'"]').attr('data-checked',1);
                        }
                        else{
                            $('.popup-content-item[data-counter="'+counter+'"]').attr('data-checked',0);
                        }

                        task_current = $('.action-input-wrapper.is-completed').length + $('.task-input-wrapper.is-completed').length;

                        $('.progress-today-tasks h5 .current').text(task_current);

                        var task_percent = Math.round(task_current / task_all * 100);

                        $('.today-tasks-circle span').first().text(task_percent);

                        $('.today-tasks-circle').css('--ratio',task_percent / 100);

                        if (
                            ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                            ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                        ){
                            $('.end-day').addClass('active');
                        }
                        else{
                            $('.end-day').removeClass('active');
                        }

                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.cancel-single-action',function(e){
                $('.add-single-action-wrapper').removeClass('show');
            });

            $(document).on('click','.add-single-action-wrapper .popup-close',function(e){
                e.preventDefault();
                $('.add-single-action-wrapper').removeClass('show');
            });

            $(document).on('change','.select-action-type',function(e){
                if ($(this).val() == 'day'){
                    $('.checkboxes-wrapper').removeClass('show');
                }
                else{
                    $('.checkboxes-wrapper').addClass('show');
                }
            });

            $(document).on('click','.save-single-action',function(e){

                var name = $('.action-name').val();
                var link = $('.action-link').val();
                var type = $('.select-action-type').val();

                var is_checked = $('.add-single-action-wrapper').attr('data-checked');

                var day1 = 0;
                var day2 = 0;
                var day3 = 0;
                var day4 = 0;
                var day5 = 0;
                var day6 = 0;
                var day7 = 0;
                if ($('.checkboxes-wrapper .checkbox-1').is(':checked')){
                    day1 = 1;
                }
                if ($('.checkboxes-wrapper .checkbox-2').is(':checked')){
                    day2 = 1;
                }
                if ($('.checkboxes-wrapper .checkbox-3').is(':checked')){
                    day3 = 1;
                }
                if ($('.checkboxes-wrapper .checkbox-4').is(':checked')){
                    day4 = 1;
                }
                if ($('.checkboxes-wrapper .checkbox-5').is(':checked')){
                    day5 = 1;
                }
                if ($('.checkboxes-wrapper .checkbox-6').is(':checked')){
                    day6 = 1;
                }
                if ($('.checkboxes-wrapper .checkbox-7').is(':checked')){
                    day7 = 1;
                }
                if (name){

                    if (is_daily_edit == 0){
                        daily_counter++;
                        var daily_couner_helper = daily_counter;
                    }
                    else{
                        var daily_couner_helper = is_daily_edit;
                    }


                    $('.popup-content-wrapper').prepend(
                        '<div class="popup-content-item" data-checked="'+is_checked+'" data-counter="'+daily_couner_helper+'" data-day1="'+day1+'"  data-day2="'+day2+'"  data-day3="'+day3+'"  data-day4="'+day4+'" ' +
                        ' data-day5="'+day5+'"   data-day6="'+day6+'"   data-day7="'+day7+'" data-type="'+type+'" data-link="'+link+'">' +
                        '<input class="" type="text" readonly value="'+name+'">' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>'
                    );

                    $('.action-name').val('');
                    $('.action-link').val('');
                    $('.select-action-type').val('');
                    $('.select-action-type option[value="day"]').prop('selected', true);
                    $('.checkboxes-wrapper .checkbox-1').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-1').removeAttr('checked');
                    $('.checkboxes-wrapper .checkbox-2').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-2').removeAttr('checked');
                    $('.checkboxes-wrapper .checkbox-3').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-3').removeAttr('checked');
                    $('.checkboxes-wrapper .checkbox-4').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-4').removeAttr('checked');
                    $('.checkboxes-wrapper .checkbox-5').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-5').removeAttr('checked');
                    $('.checkboxes-wrapper .checkbox-6').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-6').removeAttr('checked');
                    $('.checkboxes-wrapper .checkbox-7').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-7').removeAttr('checked');
                    $('.checkboxes-wrapper').removeClass('show');

                    $('.add-single-action-wrapper').removeClass('show');
                }
            });

            $(document).on('click','.popup-content-item .edit-input',function(e){
                e.preventDefault();

                $('.add-single-action-wrapper').addClass('show');

                is_daily_edit = $(this).parent().attr('data-counter');

                var text = $(this).parent().find('input').val();
                var link = $(this).parent().attr('data-link');
                var type = $(this).parent().attr('data-type');
                var day1 = $(this).parent().attr('data-day1');
                var day2 = $(this).parent().attr('data-day2');
                var day3 = $(this).parent().attr('data-day3');
                var day4 = $(this).parent().attr('data-day4');
                var day5 = $(this).parent().attr('data-day5');
                var day6 = $(this).parent().attr('data-day6');
                var day7 = $(this).parent().attr('data-day7');

                $('.action-name').val(text);
                $('.action-link').val(link);

                $('.add-single-action-wrapper').attr('data-checked',$(this).parent().attr('data-checked'));

                $('.select-action-type option[value="'+type+'"]').prop('selected', true);
                if (type == 'day'){
                    $('.checkboxes-wrapper').removeClass('show');
                }
                else{
                    $('.checkboxes-wrapper').addClass('show');
                }

                if (day1 == '1'){
                    $('.checkboxes-wrapper .checkbox-1').prop('checked',true);
                    $('.checkboxes-wrapper .checkbox-1').attr('checked','checked');
                }
                else{
                    $('.checkboxes-wrapper .checkbox-1').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-1').removeAttr('checked');
                }
                if (day2 == '1'){
                    $('.checkboxes-wrapper .checkbox-2').prop('checked',true);
                    $('.checkboxes-wrapper .checkbox-2').attr('checked','checked');
                }
                else{
                    $('.checkboxes-wrapper .checkbox-2').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-2').removeAttr('checked');
                }
                if (day3 == '1'){
                    $('.checkboxes-wrapper .checkbox-3').prop('checked',true);
                    $('.checkboxes-wrapper .checkbox-3').attr('checked','checked');
                }
                else{
                    $('.checkboxes-wrapper .checkbox-3').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-3').removeAttr('checked');
                }
                if (day4 == '1'){
                    $('.checkboxes-wrapper .checkbox-4').prop('checked',true);
                    $('.checkboxes-wrapper .checkbox-4').attr('checked','checked');
                }
                else{
                    $('.checkboxes-wrapper .checkbox-4').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-4').removeAttr('checked');
                }
                if (day5 == '1'){
                    $('.checkboxes-wrapper .checkbox-5').prop('checked',true);
                    $('.checkboxes-wrapper .checkbox-5').attr('checked','checked');
                }
                else{
                    $('.checkboxes-wrapper .checkbox-5').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-5').removeAttr('checked');
                }
                if (day6 == '1'){
                    $('.checkboxes-wrapper .checkbox-6').prop('checked',true);
                    $('.checkboxes-wrapper .checkbox-6').attr('checked','checked');
                }
                else{
                    $('.checkboxes-wrapper .checkbox-6').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-6').removeAttr('checked');
                }
                if (day7 == '1'){
                    $('.checkboxes-wrapper .checkbox-7').prop('checked',true);
                    $('.checkboxes-wrapper .checkbox-7').attr('checked','checked');
                }
                else{
                    $('.checkboxes-wrapper .checkbox-7').prop('checked',false);
                    $('.checkboxes-wrapper .checkbox-7').removeAttr('checked');
                }

                $(this).parent().remove();
            });

            $(document).on('click','.popup-content-item .remove-input',function(e){
                e.preventDefault();
                $(this).parent().remove();
            });


            $(document).on('click','.is-habit-tab.planner-day:not(.is-day-finished)  .task-input-wrapper button',function(e){

                habit_check_uncheck_item.type = 'task';
                habit_check_uncheck_item.number = $(this).parent().attr('data-number');
                habit_check_uncheck_item.date_created = $('.day-wrapper').attr('data-date');
                var eee = $(this);
                if (eee.parent().hasClass('is-completed')){
                    habit_check_uncheck_item.completed = 0;
                }
                else{
                    habit_check_uncheck_item.completed = 1;
                }

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, habit_check_uncheck_item)
                    .done(function (msg) {
                        eee.parent().toggleClass('is-completed');

                        task_current = $('.action-input-wrapper.is-completed').length + $('.task-input-wrapper.is-completed').length;

                        $('.progress-today-tasks h5 .current').text(task_current);

                        var task_percent = Math.round(task_current / task_all * 100);

                        $('.today-tasks-circle span').first().text(task_percent);

                        $('.today-tasks-circle').css('--ratio',task_percent / 100);

                        if (
                            ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                            ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                        ){
                            $('.end-day').addClass('active');
                        }
                        else{
                            $('.end-day').removeClass('active');
                        }

                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.is-habit-tab.planner-day:not(.is-day-finished)  .is-focus-input-wrapper button',function(e){

                habit_check_uncheck_item.type = 'daily_focus';
                habit_check_uncheck_item.number = $(this).parent().attr('data-number');
                habit_check_uncheck_item.date_created = $('.day-wrapper').attr('data-date');
                var eee = $(this);
                if (eee.parent().hasClass('is-completed')){
                    habit_check_uncheck_item.completed = 0;
                }
                else{
                    habit_check_uncheck_item.completed = 1;
                }

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, habit_check_uncheck_item)
                    .done(function (msg) {
                        eee.parent().toggleClass('is-completed');

                        focus_current = $('.is-focus-input-wrapper.is-completed').length;
                        focus_all = $('.is-focus-input-wrapper').length;

                        $('.progress-daily-focus h5 .current').text(focus_current);
                        var focus_percent = Math.round(focus_current / focus_all * 100);

                        $('.daily-focus-circle span.numbers').text(focus_percent);
                        $('.daily-focus-circle').css('--ratio',focus_percent / 100);

                        if (
                            ($('.progress-daily-focus .current').first().text() == $('.progress-daily-focus .all').first().text()) &&
                            ($('.progress-today-tasks .current').text() == $('.progress-today-tasks .all').text())
                        ){
                            $('.end-day').addClass('active');
                        }
                        else{
                            $('.end-day').removeClass('active');
                        }

                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            var imitate_day_update = {
                action: 'imitate_day_update',
                day: 0
            };

            $(document).on('change','.imitate-day',function(){
                imitate_day_update.day = $(this).val();

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, imitate_day_update)
                    .done(function (msg) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        location.reload();
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.imitate-reset',function(){
                imitate_day_update.day = 0;

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, imitate_day_update)
                    .done(function (msg) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        location.reload();
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.confirm-end-day',function(){
                $('.plan-daily-focus-items').html('');
                $('.plan-second-tasks-items').html('');
                $('.plan-appointments-items').html('');

                if ($('.is-tomorrow').hasClass('have-focus')){
                    if ($('.is-tomorrow').closest('.week-days').hasClass('is-week-1')){
                        $('.is-week-1 .week-daily-focus-input-wrapper').each(function(){
                            var text = $(this).find('input').val();
                            var time = $(this).find('.main-span').html();
                            var number = $(this).attr('data-number');
                            $('.plan-daily-focus-items').append(
                                '<div class="plan-daily-focus-i" data-number="'+number+'">' +
                                '<span class="text">'+text+'</span>'+
                                '<span class="time">'+time+'</span>' +
                                '<a href="#" class="edit-input"></a>' +
                                '</div>'
                            );
                        });
                    }
                    else if ($('.is-tomorrow').closest('.week-days').hasClass('is-week-2')){
                        $('.is-week-2 .week-daily-focus-input-wrapper').each(function(){
                            var text = $(this).find('input').val();
                            var time = $(this).find('.main-span').html();
                            var number = $(this).attr('data-number');
                            $('.plan-daily-focus-items').append(
                                '<div class="plan-daily-focus-i" data-number="'+number+'">' +
                                '<span class="text">'+text+'</span>'+
                                '<span class="time">'+time+'</span>' +
                                '<a href="#" class="edit-input"></a>' +
                                '</div>'
                            );
                        });
                    }
                }
                else{
                    $('.plan-daily-focus').hide();
                }

                $('.is-tomorrow .week-action-inside.is-filled').each(function(){
                    var text = $(this).find('textarea').val();
                    var number = $(this).attr('data-number');
                    $('.plan-second-tasks-items').append(
                        '<div class="plan-second-tasks-i" data-number="'+number+'">' +
                        '<span class="text">'+text+'</span>' +
                        '<a href="#" class="remove-input">x</a>'+
                        '</div>'
                    );
                });

                $('.is-tomorrow .week-appointment-inside').each(function(){
                    var text = $(this).find('input').val();
                    var time = $(this).find('.time-input-wrapper').html();
                    var number = $(this).attr('data-number');
                    $('.plan-appointments-items').append(
                        '<div class="plan-appointments-i" data-number="'+number+'">' +
                        '<span class="text">'+text+'</span>'+
                        '<span class="time">'+time+'</span>' +
                        '<a href="#" class="remove-input">x</a>'+
                        '</div>'
                    );
                });

                $('.end-day-confirm-wrapper').removeClass('show');
                $('.plan-tomorrow-wrapper').addClass('show');

            });

            $(document).on('click','.end-day',function(){
                if ($(this).hasClass('active')){
                    $('.plan-daily-focus-items').html('');
                    $('.plan-second-tasks-items').html('');
                    $('.plan-appointments-items').html('');

                    if ($('.is-tomorrow').hasClass('have-focus')){
                        if ($('.is-tomorrow').closest('.week-days').hasClass('is-week-1')){
                            $('.is-week-1 .week-daily-focus-input-wrapper').each(function(){
                                var text = $(this).find('input').val();
                                var time = $(this).find('.main-span').html();
                                var number = $(this).attr('data-number');
                                $('.plan-daily-focus-items').append(
                                    '<div class="plan-daily-focus-i" data-number="'+number+'">' +
                                    '<span class="text">'+text+'</span>'+
                                    '<span class="time">'+time+'</span>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '</div>'
                                );
                            });
                        }
                        else if ($('.is-tomorrow').closest('.week-days').hasClass('is-week-2')){
                            $('.is-week-2 .week-daily-focus-input-wrapper').each(function(){
                                var text = $(this).find('input').val();
                                var time = $(this).find('.main-span').html();
                                var number = $(this).attr('data-number');
                                $('.plan-daily-focus-items').append(
                                    '<div class="plan-daily-focus-i" data-number="'+number+'">' +
                                    '<span class="text">'+text+'</span>'+
                                    '<span class="time">'+time+'</span>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '</div>'
                                );
                            });
                        }
                    }
                    else{
                        $('.plan-daily-focus').hide();
                    }


                    $('.is-tomorrow .week-action-inside.is-filled').each(function(){
                        var text = $(this).find('textarea').val();
                        var number = $(this).attr('data-number');
                        $('.plan-second-tasks-items').append(
                            '<div class="plan-second-tasks-i" data-number="'+number+'">' +
                            '<span class="text">'+text+'</span>' +
                            '<a href="#" class="remove-input">x</a>'+
                            '</div>'
                        );
                    });

                    $('.is-tomorrow .week-appointment-inside').each(function(){
                        var text = $(this).find('input').val();
                        var time = $(this).find('.time-input-wrapper').html();
                        var number = $(this).attr('data-number');
                        $('.plan-appointments-items').append(
                            '<div class="plan-appointments-i" data-number="'+number+'">' +
                            '<span class="text">'+text+'</span>'+
                            '<span class="time">'+time+'</span>' +
                            '<a href="#" class="remove-input">x</a>'+
                            '</div>'
                        );
                    });


                    $('.plan-tomorrow-wrapper').addClass('show');
                }
                else{
                    $('.end-day-action-wrapper .end-day-action-item').remove();
                    $('.action-input-wrapper:not(.is-completed)').each(function(){
                        var text = '';
                        if ($(this).find('a').length == 0){
                            text = $(this).find('span').text();
                        }
                        else{
                            text = $(this).find('a').text();
                        }
                        $('.end-day-action-wrapper').append(
                            '<div class="end-day-action-item"><p>'+text+'</p></div>'
                        );
                    });

                    if ($('.end-day-action-wrapper .end-day-action-item').length > 0 ){
                        $('.end-day-action-wrapper').show();
                    }
                    else{
                        $('.end-day-action-wrapper').hide();
                    }

                    $('.end-day-focus-wrapper .end-day-focus-item').remove();
                    $('.is-focus-input-wrapper:not(.is-completed)').each(function(){
                        var text = $(this).find('.text-span').text();
                        var time = $(this).find('.time-span').html();
                        $('.end-day-focus-wrapper').append(
                            '<div class="end-day-focus-item"><p><span class="time">'+time+'</span>'+text+'</p></div>'
                        );
                    });

                    if ($('.end-day-focus-wrapper .end-day-focus-item').length > 0 ){
                        $('.end-day-focus-wrapper').show();
                    }
                    else{
                        $('.end-day-focus-wrapper').hide();
                    }


                    $('.end-day-task-wrapper .end-day-task-item').remove();
                    $('.task-input-wrapper:not(.is-completed)').each(function(){
                        var text = $(this).find('span').text();
                        $('.end-day-task-wrapper').append(
                            '<div class="end-day-task-item"><p>'+text+'</p></div>'
                        );
                    });

                    if ($('.end-day-task-wrapper .end-day-task-item').length > 0 ){
                        $('.end-day-task-wrapper').show();
                    }
                    else{
                        $('.end-day-task-wrapper').hide();
                    }


                    $('.end-day-confirm-wrapper').addClass('show');
                }
            });

            $(document).on('click','.view-my-goals',function(){
                $('.my-goals-wrapper').addClass('show');

                $('.my-goals-month-wrapper').html('');
                $('.my-goals-week-wrapper').html('');

                $('.this-month-goals-textarea[readonly]').each(function(){
                    $('.my-goals-month-wrapper').append(
                        '<p>'+$(this).val()+'</p>'
                    );
                });

                $('.this-week-goal-wrapper textarea[readonly]').each(function(){
                    $('.my-goals-week-wrapper').append(
                        '<p>'+$(this).val()+'</p>'
                    );
                });

            });

            $(document).on('click','.confirm-tomorrow-plan',function(){

                plan_tomorrow_day.date_today = $('.day-wrapper').attr('data-date');
                plan_tomorrow_day.date_tomorrow = $('.day-wrapper').attr('data-date-tomorrow');

                plan_tomorrow_day.arr_focus = [];
                plan_tomorrow_day.arr_tasks = [];
                plan_tomorrow_day.arr_appointments = [];

                $('.plan-daily-focus-i').each(function() {
                    var arr_item = {
                        'number': $(this).attr('data-number'),
                        'text': $(this).find('.text').text(),
                        'time': $(this).find('.is-inner-hour').text() +
                            ':' + $(this).find('.is-inner-min').text() +
                            $(this).find('.is-inner-type').text()
                    };
                    plan_tomorrow_day.arr_focus.push(arr_item);
                });
                $('.plan-second-tasks-i').each(function() {
                    var arr_item = {'number': $(this).attr('data-number'),'text': $(this).find('.text').text()};
                    plan_tomorrow_day.arr_tasks.push(arr_item);
                });
                $('.plan-appointments-i').each(function() {
                    var arr_item = {
                        'number': $(this).attr('data-number'),
                        'text': $(this).find('.text').text(),
                        'time': $(this).find('.is-inner-hour').text() +
                            ':' + $(this).find('.is-inner-min').text() +
                            $(this).find('.is-inner-type').text()
                    };
                    plan_tomorrow_day.arr_appointments.push(arr_item);
                });

                plan_tomorrow_day.day_badge = 0;

                var daily_focus_circle = $('.daily-focus-circle span').first().text();

                var divide_count = 1;

                var actions_all = $('.action-input-wrapper').length;
                var actions_current = $('.action-input-wrapper.is-completed').length;

                var actions_percent = 0;
                if (actions_all !== 0){
                    actions_percent = Math.round(actions_current / actions_all * 100);
                    divide_count++;
                }

                var tasks_current = $('.task-input-wrapper.is-completed').length;
                var tasks_all = $('.task-input-wrapper').length;
                var tasks_percent = 0;
                if (tasks_all !== 0){
                    tasks_percent = Math.round(tasks_current / tasks_all * 100);
                    divide_count++;
                }

                if ($('.day-daily-focus .is-focus-input-wrapper').length > 0){
                    divide_count++;
                }

                var percent_together = Math.round((100 + tasks_percent + actions_percent + parseInt(daily_focus_circle)) / divide_count );

                if ( ((percent_together == 100) && ($('.day-daily-focus .is-focus-input-wrapper').length > 0)  )){
                    plan_tomorrow_day.day_badge = 2;
                }
                else if (daily_focus_circle == '100'){
                    plan_tomorrow_day.day_badge = 1;
                }

                var ratio_fcs = parseInt($('.day-progress-circle span.numbers').first().text()) / 100;
                var ratio_together = $('.today-tasks-circle').css('--ratio');
                plan_tomorrow_day.badge_stats = '1,'+ ratio_together+','+ratio_fcs+','+percent_together;

                var eee = $(this);
                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, plan_tomorrow_day)
                    .done(function (msg) {

                        $('.plan-tomorrow-wrapper').removeClass('show');
                        $('.end-day-review-wrapper').addClass('show');
                        $('.end-day').addClass('hidden');

                        $('.end-of-day-review').addClass('show');
                        $('.is-habit-tab.planner-day').addClass('is-day-finished');

                        $('.daily-planning-circle span').first().text('100');
                        $('.daily-planning-circle').css('--ratio',1);

                        var actions_all = $('.action-input-wrapper').length;
                        var tasks_all = $('.task-input-wrapper').length;

                        var actions_current = $('.action-input-wrapper.is-completed').length;
                        var tasks_current = $('.task-input-wrapper.is-completed').length;


                        var divide_count = 1;

                        var actions_percent = 0;
                        if (actions_all !== 0){
                            actions_percent = Math.round(actions_current / actions_all * 100);
                            divide_count++;
                        }
                        var tasks_percent = 0;
                        if (tasks_all !== 0){
                            tasks_percent = Math.round(tasks_current / tasks_all * 100);
                            divide_count++;
                        }

                        if ($('.day-daily-focus .is-focus-input-wrapper').length > 0){
                            divide_count++;
                        }

                        var daily_focus_circle = $('.daily-focus-circle span').first().text();
                        var percent_together = Math.round((100 + tasks_percent + actions_percent + parseInt(daily_focus_circle)) / divide_count );


                        $('.is-habit-popup > .end-day-circle-progress-wrapper span.numbers').text(percent_together);
                        $('.end-of-day-review .end-day-circle-progress-wrapper span.numbers').text(percent_together);
                        $('.is-current-day .end-day-circle-progress-wrapper span.numbers').text(percent_together);
                        var ratio_fcs = parseInt($('.day-progress-circle span.numbers').first().text()) / 100;

                        $('.is-habit-popup > .end-day-circle-progress-wrapper .end-day-tog-circle').css('--ratio',$('.today-tasks-circle').css('--ratio'));
                        $('.is-habit-popup > .end-day-circle-progress-wrapper .end-day-fcs-circle').css('--ratio',ratio_fcs );
                        $('.end-of-day-review .end-day-circle-progress-wrapper .end-day-tog-circle').css('--ratio',$('.today-tasks-circle').css('--ratio'));
                        $('.end-of-day-review .end-day-circle-progress-wrapper .end-day-fcs-circle').css('--ratio',ratio_fcs );
                        $('.is-current-day .end-day-circle-progress-wrapper .end-day-tog-circle').css('--ratio',$('.today-tasks-circle').css('--ratio'));
                        $('.is-current-day .end-day-circle-progress-wrapper .end-day-fcs-circle').css('--ratio',ratio_fcs );


                        $('.progress-today-actions h5 .current').text(actions_current);
                        $('.progress-today-actions h5 .all').text(actions_all);
                        $('.today-actions-circle span').first().text(actions_percent);
                        $('.today-actions-circle').css('--ratio',actions_percent / 100);

                        $('.progress-today-second-tasks h5 .current').text(tasks_current);
                        $('.progress-today-second-tasks h5 .all').text(tasks_all);
                        $('.today-second-tasks-circle span').first().text(tasks_percent);
                        $('.today-second-tasks-circle').css('--ratio',tasks_percent / 100);

                        if ( ((percent_together == 100) && ($('.day-daily-focus .is-focus-input-wrapper').length > 0)  )){
                            $('.end-of-day-review').addClass('is-badge-2');
                            $('.end-day-review-wrapper').addClass('is-badge-2');
                        }
                        else if (daily_focus_circle == '100'){
                            $('.end-of-day-review').addClass('is-badge-1');
                            $('.end-day-review-wrapper').addClass('is-badge-1');
                        }
                        else{
                            $('.end-of-day-review').addClass('is-badge-0');
                            $('.end-day-review-wrapper').addClass('is-badge-0');
                        }

                        var date_tomorrow = $('.day-wrapper').attr('data-date-tomorrow');

                        $('.week-action-inside').remove();

                        $('.month-day-inner').remove();
                        $('.plan-second-tasks-i').each(function(){
                            var text = $(this).find('.text').text();
                            additional_task_number++;
                            $('.week-day[data-date="'+date_tomorrow+'"] .week-action-wrapper').prepend(
                                '<div class="week-action-inside is-filled" data-number="'+additional_task_number+'">' +
                                '<textarea class="week-action-textarea" readonly>'+text+'</textarea>' +
                                '<a href="#" class="remove-input">x</a>' +
                                '</div>'
                            );

                            $('.month-day[data-date="'+date_tomorrow+'"]').append(
                                '<div class="month-day-inner" data-number="'+additional_task_number+'">' +
                                '<input readonly type="text" value="'+text+'">' +
                                '<a href="#" class="remove-input">x</a></div>' +
                                '');
                        });

                        $('.week-appointment-inside').remove();
                        $('.plan-appointments-i').each(function(){
                            var text = $(this).find('.text').text();
                            var time = $(this).find('.time').html();

                            appointment_counter++;

                            $('.week-day[data-date="'+date_tomorrow+'"]').find('.week-appointment-wrapper').prepend(
                                '<div class="week-appointment-inside" data-number="'+appointment_counter+'">' +
                                '<input readonly type="text" value="'+text+'">' +
                                '<span class="time-input-wrapper">' +
                                time +
                                '</span>' +
                                '<a href="#" class="remove-input">x</a>' +
                                '</div>'
                            );
                        });

                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })


                    if (!($('.day-daily-focus .is-focus-input-wrapper').length > 0)){
                        $('.end-day-review-wrapper .day-progress-circle.daily-focus-circle .numbers').hide();
                        $('.end-day-review-wrapper .day-progress-circle.daily-focus-circle span').eq(1).text('-');
                    }
                    if (tasks_all == 0){
                        $('.end-day-review-wrapper .day-progress-circle.today-second-tasks-circle span').eq(0).hide();
                        $('.end-day-review-wrapper .day-progress-circle.today-second-tasks-circle span').eq(1).text('-');
                    }
                    if (actions_all == 0){
                        $('.end-day-review-wrapper .day-progress-circle.today-actions-circle span').eq(0).hide();
                        $('.end-day-review-wrapper .day-progress-circle.today-actions-circle span').eq(1).text('-');
                    }
            });

            $(document).on('click','.my-goals-wrapper .popup-close',function(e){
                e.stopPropagation();
                $('.my-goals-wrapper').removeClass('show');
            });

            $(document).on('click','.go-back-finish',function(){
                $('.end-day-confirm-wrapper').removeClass('show');
            });

            $(document).on('click','.complete-end-day',function(){
                $('.end-day-review-wrapper').removeClass('show');
            });



            $(document).on('click','.plan-notes-wrapper h4',function(){
                $(this).parent().toggleClass('opened');
            });

            $(document).on('keypress',".plan-notes-textarea",function (e) {
                var code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13) {
                    e.preventDefault();
                    if ($(this).val() !== ''){
                        notes_counter++;

                        add_habit_note.text = $(this).val();
                        add_habit_note.number = notes_counter;
                        add_habit_note.type = 'note';

                        var eee = $(this);

                        $('.habit-preloader-wrapper').addClass("show");
                        jQuery.post(ajaxurl, add_habit_note)
                            .done(function (msg) {
                                eee.attr('readonly', 'readonly');
                                eee.parent().addClass('is-filled');
                                eee.parent().attr('data-number',notes_counter);

                                $('<div class="month-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="month-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.notes-wrapper h4'));

                                $('<div class="week-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="week-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.week-notes-wrapper h4'));

                                $('<div class="day-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="day-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.day-notes-wrapper h4'));

                                $('<div class="popup-notes-textarea-wrapper is-filled" data-number="'+notes_counter+'">' +
                                    '<textarea class="popup-notes-textarea" readonly>'+eee.val()+'</textarea>' +
                                    '<a href="#" class="edit-input"></a>' +
                                    '<a href="#" class="remove-input">x</a>' +
                                    '</div>'
                                ).insertAfter($('.popup-notes-wrapper h4'));

                                $('.habit-preloader-wrapper').removeClass("show");
                            })
                            .fail(function (xhr, textStatus, errorThrown) {
                                $('.habit-preloader-wrapper').removeClass("show");
                                alert('Connection error happen, please try again');
                            })
                    }
                }
            });

            $(document).on('click','.plan-notes-textarea-wrapper .remove-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        if ($('.plan-notes-textarea-wrapper').length > 1){
                            eee.parent().remove();
                        }
                        else{
                            eee.parent().removeClass('is-filled');
                            eee.parent().find('.month-notes-textarea').val('');
                            eee.parent().find('.month-notes-textarea').removeAttr('readonly');
                            eee.parent().removeAttr('data-number');
                        }
                        var number = eee.parent().attr('data-number');
                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.plan-notes-textarea-wrapper .edit-input',function(e){
                e.preventDefault();

                remove_habit_item.type = 'note';
                remove_habit_item.number = $(this).parent().attr('data-number');
                remove_habit_item.date_created = '';

                var eee = $(this);

                var number = eee.parent().attr('data-number');
                $('.habit-preloader-wrapper').addClass("show");
                jQuery.post(ajaxurl, remove_habit_item)
                    .done(function (msg) {
                        eee.parent().removeClass('is-filled');
                        eee.parent().find('.plan-notes-textarea').removeAttr('readonly');
                        eee.parent().removeAttr('data-number');
                        eee.parent().find('.plan-notes-textarea').focus();

                        $('.month-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.week-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.day-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.popup-notes-textarea-wrapper.is-filled[data-number="'+number+'"]').remove();
                        $('.habit-preloader-wrapper').removeClass("show");
                    })
                    .fail(function (xhr, textStatus, errorThrown) {
                        $('.habit-preloader-wrapper').removeClass("show");
                        alert('Connection error happen, please try again');
                    })
            });

            $(document).on('click','.add-plan-note',function(e){
                e.preventDefault();
                if ($('.plan-notes-textarea-wrapper:not(.is-filled)').length < 1){
                    $('' +
                        '<div class="plan-notes-textarea-wrapper">' +
                        '<textarea class="plan-notes-textarea"></textarea>' +
                        '<a href="#" class="edit-input"></a>' +
                        '<a href="#" class="remove-input">x</a>' +
                        '</div>' +
                        '').insertBefore($(this));
                }
            });

            $(document).on('click','.add-plan-task',function(e){
                e.preventDefault();
                $('.add-task-wrapper').addClass('show');
            });


            $(document).on('click','.add-plan-appointment',function(e){
                e.preventDefault();
                $('.add-appointment-wrapper').addClass('show');
                $('.add-appointment-wrapper').attr('data-is-plan',1);
            });

            $(document).on('click',
                '.plan-second-tasks-i .remove-input, ' +
                '.plan-appointments-i .remove-input',
                function(e){
                e.preventDefault();
                $(this).parent().remove();
            });

            $(document).on('click','.plan-daily-focus-i .edit-input',function(e){
                e.preventDefault();
                $('.add-focus-wrapper').addClass('show');
                $('.add-focus-wrapper').attr('data-is-plan',1);
                $('.add-focus-wrapper').attr('focus-number',$(this).parent().attr('data-number'));
                $('.name-your-daily-focus').attr('readonly','readonly');
                $('.name-your-daily-focus').val($(this).parent().find('.text').text());
                $('.time-wrapper-hour').val($(this).parent().find('.is-inner-hour').text());
                $('.time-wrapper-min').val($(this).parent().find('.is-inner-min').text());
                $('.time-wrapper-type').val($(this).parent().find('.is-inner-type').text());

            });

            $(document).on('click','.cancel-task-popup',function(e){
                e.preventDefault();
                $('.add-task-wrapper').removeClass('show');
            });

            $(document).on('click','.save-task-popup',function(e){
                e.preventDefault();
                var text = $('.name-add-task').val();
                additional_task_number++;
                $('.plan-second-tasks-items').append(
                   '<div class="plan-second-tasks-i" data-number="'+additional_task_number+'">' +
                   '<span class="text">'+text+'</span>' +
                   '<a href="#" class="remove-input">x</a>'+
                   '</div>'
                );
                $('.name-add-task').val('');
                $('.add-task-wrapper').removeClass('show');
            });


            $(document).on('click','.is-week-click-left',function(e){
                e.preventDefault();
                var curr_index = $('.week-days.is-week-current').index();
                $('.week-days.is-week-current').removeClass('is-week-current');
                $('.week-days').eq(curr_index - 1).addClass('is-week-current');

                var curr_index_p = $('.focus-decide-items-wrapper.is-week-current').index();
                $('.focus-decide-items-wrapper.is-week-current').removeClass('is-week-current');
                $('.focus-decide-items-wrapper').eq(curr_index_p - 1).addClass('is-week-current');

                $('.plan-week-h2-wrapper h2.is-week-current').removeClass('is-week-current');
                $('.plan-week-h2-wrapper h2').eq(curr_index - 1).addClass('is-week-current');

                $('.is-habit-tab.planner-week h3.is-week-current').removeClass('is-week-current');
                $('.is-habit-tab.planner-week h3').eq(curr_index - 1).addClass('is-week-current');

                $('.this-week-goal-wrapper.is-week-current').removeClass('is-week-current');
                $('.this-week-goal-wrapper').eq(curr_index - 1).addClass('is-week-current');

                $('.week-daily-focus-wrapper.is-week-current').removeClass('is-week-current');
                $('.week-daily-focus-wrapper').eq(curr_index - 1).addClass('is-week-current');

                $('.past-week-results.is-week-current').removeClass('is-week-current');
                $('.past-week-results').eq(curr_index - 1).addClass('is-week-current');

                $('.past-week-badges.is-week-current').removeClass('is-week-current');
                $('.past-week-badges').eq(curr_index - 1).addClass('is-week-current');

                if ($('.week-days.is-week-current').hasClass('is-week-1')){
                    $('.plan-your-week').removeClass('previous');
                    $('.plan-your-week.is-week-1').addClass('is-week-current');
                    $('.plan-your-week.is-week-2').removeClass('is-week-current');
                    $('.week-notes-wrapper').removeClass('is-prev');
                    $('.week-notes-wrapper').addClass('is-1');
                    $('.week-notes-wrapper').removeClass('is-2');
                }
                else if($('.week-days.is-week-current').hasClass('is-week-2')){
                    $('.plan-your-week').removeClass('previous');
                    $('.plan-your-week.is-week-1').removeClass('is-week-current');
                    $('.plan-your-week.is-week-2').addClass('is-week-current');
                    $('.week-notes-wrapper').removeClass('is-prev');
                    $('.week-notes-wrapper').removeClass('is-1');
                    $('.week-notes-wrapper').addClass('is-2');
                }
                else{
                    $('.plan-your-week').addClass('previous');
                    $('.plan-your-week.is-week-1').addClass('is-week-current');
                    $('.plan-your-week.is-week-2').removeClass('is-week-current');
                    $('.week-notes-wrapper').addClass('is-prev');
                    $('.week-notes-wrapper').removeClass('is-1');
                    $('.week-notes-wrapper').removeClass('is-2');
                }

                if ($('.past-week-badges.is-week-current').find('.have-best').length > 0 ){
                    $('.top-badge-perfect').addClass('show');
                    $('.top-badge-focus').removeClass('show');
                }
                else if ($('.past-week-badges.is-week-current').find('.have-perfect').length > 0) {
                    $('.top-badge-focus').addClass('show');
                    $('.top-badge-perfect').removeClass('show');
                }
                else{
                    $('.top-badge-focus').removeClass('show');
                    $('.top-badge-perfect').removeClass('show');
                }
            });

            $(document).on('click','.is-week-click-right',function(e){
                e.preventDefault();
                var curr_index = $('.week-days.is-week-current').index();
                $('.week-days.is-week-current').removeClass('is-week-current');
                $('.week-days').eq(curr_index + 1).addClass('is-week-current');

                var curr_index_p = $('.focus-decide-items-wrapper.is-week-current').index();
                $('.focus-decide-items-wrapper.is-week-current').removeClass('is-week-current');
                $('.focus-decide-items-wrapper').eq(curr_index_p + 1).addClass('is-week-current');

                $('.plan-week-h2-wrapper h2.is-week-current').removeClass('is-week-current');
                $('.plan-week-h2-wrapper h2').eq(curr_index + 1).addClass('is-week-current');

                $('.is-habit-tab.planner-week h3.is-week-current').removeClass('is-week-current');
                $('.is-habit-tab.planner-week h3').eq(curr_index + 1).addClass('is-week-current');

                $('.this-week-goal-wrapper.is-week-current').removeClass('is-week-current');
                $('.this-week-goal-wrapper').eq(curr_index + 1).addClass('is-week-current');

                $('.week-daily-focus-wrapper.is-week-current').removeClass('is-week-current');
                $('.week-daily-focus-wrapper').eq(curr_index + 1).addClass('is-week-current');

                $('.past-week-results.is-week-current').removeClass('is-week-current');
                $('.past-week-results').eq(curr_index + 1).addClass('is-week-current');

                $('.past-week-badges.is-week-current').removeClass('is-week-current');
                $('.past-week-badges').eq(curr_index + 1).addClass('is-week-current');

                if ($('.week-days.is-week-current').hasClass('is-week-1')){
                    $('.plan-your-week').removeClass('previous');
                    $('.plan-your-week.is-week-1').addClass('is-week-current');
                    $('.plan-your-week.is-week-2').removeClass('is-week-current');
                    $('.week-notes-wrapper').removeClass('is-prev');
                    $('.week-notes-wrapper').addClass('is-1');
                    $('.week-notes-wrapper').removeClass('is-2');
                }
                else if($('.week-days.is-week-current').hasClass('is-week-2')){
                    $('.plan-your-week').removeClass('previous');
                    $('.plan-your-week.is-week-1').removeClass('is-week-current');
                    $('.plan-your-week.is-week-2').addClass('is-week-current');
                    $('.week-notes-wrapper').removeClass('is-prev');
                    $('.week-notes-wrapper').removeClass('is-1');
                    $('.week-notes-wrapper').addClass('is-2');
                }
                else{
                    $('.plan-your-week').addClass('previous');
                    $('.plan-your-week.is-week-1').addClass('is-week-current');
                    $('.plan-your-week.is-week-2').removeClass('is-week-current');
                    $('.week-notes-wrapper').addClass('is-prev');
                    $('.week-notes-wrapper').removeClass('is-1');
                    $('.week-notes-wrapper').removeClass('is-2');
                }

                if ($('.past-week-badges.is-week-current').find('.have-best').length > 0 ){
                    $('.top-badge-perfect').addClass('show');
                    $('.top-badge-focus').removeClass('show');
                }
                else if ($('.past-week-badges.is-week-current').find('.have-perfect').length > 0) {
                    $('.top-badge-focus').addClass('show');
                    $('.top-badge-perfect').removeClass('show');
                }
                else{
                    $('.top-badge-focus').removeClass('show');
                    $('.top-badge-perfect').removeClass('show');
                }
            });


            $(document).on('click','.is-calendar-click-left',function(e){
                e.preventDefault();
                var curr_index = $('.month-days.is-month-current').index();
                $('.month-days.is-month-current').removeClass('is-month-current');
                $('.month-days').eq(curr_index - 1).addClass('is-month-current');

                $('.calendar-h2-wrapper h2.is-h2-current').removeClass('is-h2-current');
                $('.calendar-h2-wrapper h2').eq(curr_index - 1).addClass('is-h2-current');

            });

            $(document).on('click','.is-calendar-click-right',function(e){
                e.preventDefault();
                var curr_index = $('.month-days.is-month-current').index();
                $('.month-days.is-month-current').removeClass('is-month-current');
                $('.month-days').eq(curr_index + 1).addClass('is-month-current');

                $('.calendar-h2-wrapper h2.is-h2-current').removeClass('is-h2-current');
                $('.calendar-h2-wrapper h2').eq(curr_index + 1).addClass('is-h2-current');
            });


            $(document).on('change','.time-wrapper-hour',function(){
                if ($('.time-wrapper-min').val() == null){
                    $('.time-wrapper-min').val('00');
                }
            });

            $(document).on('change','.appointment-time-wrapper-hour',function(){
                if ($('.appointment-time-wrapper-min').val() == null){
                    $('.appointment-time-wrapper-min').val('00');
                }
            });


            $(document).on('blur',".month-notes-textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".this-month-goals-textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".week-notes-textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".day-notes-textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".popup-notes-textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".popup-goals-textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".week-goal-textarea-wrapper textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".week-day-inside-wrapper textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });
            $(document).on('blur',".plan-notes-textarea:not([readonly])",function () {
                $(this).trigger(
                    jQuery.Event('keypress', { keyCode: 13 })
                );
            });








            $(document).on('click','.end-day-review-wrapper, .end-day-review-wrapper .popup-close',function(){
                var pageURL = $(location).attr("href");
                pageURL = pageURL.replace('#?','?');
                pageURL = pageURL.split('?')[0];
                location.href = pageURL + "?tab=day";
            });

            $(document).on('click','.end-day-review-wrapper',function(e){
                e.stopPropagation();
            });


        })(jQuery);
    </script>
    <?php

    $code = ob_get_clean();

    if (!is_user_logged_in()){
        $code = '';
    }

    return $code;
}
